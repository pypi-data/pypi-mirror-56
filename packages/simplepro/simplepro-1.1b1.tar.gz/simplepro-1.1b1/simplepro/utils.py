import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6MQpmcm9tIGRqYW5nbyAuY29yZSAuc2VyaWFsaXplcnMgLmpzb24gaW1wb3J0IERqYW5nb0pTT05FbmNvZGVyICNsaW5lOjMKZnJvbSBkamFuZ28gLmRiIC5tb2RlbHMgaW1wb3J0IEZvcmVpZ25LZXkgI2xpbmU6NApmcm9tIGRqYW5nbyAuaHR0cCBpbXBvcnQgSHR0cFJlc3BvbnNlICNsaW5lOjUKZnJvbSBkamFuZ28gLnV0aWxzIC5lbmNvZGluZyBpbXBvcnQgZm9yY2VfdGV4dCAjbGluZTo2CmZyb20gZGphbmdvIC51dGlscyAuZnVuY3Rpb25hbCBpbXBvcnQgUHJvbWlzZSAjbGluZTo3CmltcG9ydCBkYXRldGltZSAjbGluZTo5CmNsYXNzIExhenlFbmNvZGVyIChEamFuZ29KU09ORW5jb2RlciApOiNsaW5lOjEyCiAgICAiIiNsaW5lOjE1CiAgICBkZWYgZGVmYXVsdCAoc2VsZiAsb2JqICk6I2xpbmU6MTcKICAgICAgICBpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRldGltZSApOiNsaW5lOjE4CiAgICAgICAgICAgIHJldHVybiBvYmogLnN0cmZ0aW1lICgiJVktJW0tJWQgJUg6JU06JVMiKSNsaW5lOjE5CiAgICAgICAgZWxpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRlICk6I2xpbmU6MjAKICAgICAgICAgICAgcmV0dXJuIG9iaiAuc3RyZnRpbWUgKCIlWS0lbS0lZCIpI2xpbmU6MjEKICAgICAgICBlbGlmIGlzaW5zdGFuY2UgKG9iaiAsUHJvbWlzZSApOiNsaW5lOjIyCiAgICAgICAgICAgIHJldHVybiBmb3JjZV90ZXh0IChvYmogKSNsaW5lOjIzCiAgICAgICAgcmV0dXJuIHN0ciAob2JqICkjbGluZToyNApkZWYgZ2V0X21vZGVsX2ZpZWxkcyAobW9kZWwgLE8wMDBPT09PTzAwTzBPT08wID1Ob25lICk6I2xpbmU6MjgKICAgICIiI2xpbmU6MzQKICAgIE8wT08wME9PMDAwME8wTzAwID1bXSNsaW5lOjM1CiAgICBPT08wT09PT08wT09PMDAwMCA9bW9kZWwgLl9tZXRhIC5maWVsZHMgI2xpbmU6MzYKICAgIGZvciBPMDBPT08wMDAwMDBPME9PMCBpbiBPT08wT09PT08wT09PMDAwMCA6I2xpbmU6MzcKICAgICAgICBPTzBPME9PT08wMDAwTzBPTyA9TzAwT09PMDAwMDAwTzBPTzAgLm5hbWUgI2xpbmU6MzgKICAgICAgICBpZiBoYXNhdHRyIChPMDBPT08wMDAwMDBPME9PMCAsJ3ZlcmJvc2VfbmFtZScpOiNsaW5lOjM5CiAgICAgICAgICAgIE9PME8wT09PTzAwMDBPME9PID1nZXRhdHRyIChPMDBPT08wMDAwMDBPME9PMCAsJ3ZlcmJvc2VfbmFtZScpI2xpbmU6NDAKICAgICAgICBpZiBpc2luc3RhbmNlIChPTzBPME9PT08wMDAwTzBPTyAsUHJvbWlzZSApOiNsaW5lOjQyCiAgICAgICAgICAgIE9PME8wT09PTzAwMDBPME9PID1zdHIgKE9PME8wT09PTzAwMDBPME9PICkjbGluZTo0MwogICAgICAgIGlmIE8wMDBPT09PTzAwTzBPT08wIDojbGluZTo0NQogICAgICAgICAgICBPME9PMDBPTzAwMDBPME8wMCAuYXBwZW5kICgoJ3t9X197fScuZm9ybWF0IChPMDAwT09PT08wME8wT09PMCAsTzAwT09PMDAwMDAwTzBPTzAgLm5hbWUgKSxPTzBPME9PT08wMDAwTzBPTyApKSNsaW5lOjQ2CiAgICAgICAgZWxzZSA6I2xpbmU6NDcKICAgICAgICAgICAgTzBPTzAwT08wMDAwTzBPMDAgLmFwcGVuZCAoKE8wME9PTzAwMDAwME8wT08wIC5uYW1lICxPTzBPME9PT08wMDAwTzBPTyApKSNsaW5lOjQ4CiAgICByZXR1cm4gTzBPTzAwT08wMDAwTzBPMDAgI2xpbmU6NTAKZGVmIGZpbmRfZmllbGQgKGZpZWxkcyAsbmFtZSApOiNsaW5lOjUzCiAgICBmb3IgTzBPT09PME8wME8wT08wTzAgaW4gZmllbGRzIDojbGluZTo1NAogICAgICAgIGlmIG5hbWUgPT1PME9PT08wTzAwTzBPTzBPMCBbMCBdOiNsaW5lOjU1CiAgICAgICAgICAgIHJldHVybiBPME9PT08wTzAwTzBPTzBPMCBbMSBdI2xpbmU6NTYKICAgIHJldHVybiBGYWxzZSAjbGluZTo1NwpNT0RFTF9DQUNIRSA9e30jbGluZTo2MQpkZWYgZ2V0X21vZGVsX2luZm8gKG1vZGVsX2FkbWluICxyZXF1ZXN0ICk6I2xpbmU6NjQKICAgIE9PTzAwTzBPTzAwTzBPTzBPID1zdHIgKG1vZGVsX2FkbWluICkjbGluZTo2OAogICAgaWYgT09PMDBPME9PMDBPME9PME8gaW4gTU9ERUxfQ0FDSEUgOiNsaW5lOjY5CiAgICAgICAgT09PME8wTzAwTzAwT09PTzAgPU1PREVMX0NBQ0hFIC5nZXQgKE9PTzAwTzBPTzAwTzBPTzBPICkjbGluZTo3MAogICAgICAgIHJldHVybiBPT08wTzBPMDBPMDBPT09PMCAuZ2V0ICgndmFsdWVzX2ZpZWxkcycpLE9PTzBPME8wME8wME9PT08wIC5nZXQgKCdmdW5fZmllbGRzJyksT09PME8wTzAwTzAwT09PTzAgLmdldCAoJ2hlYWRlcnMnKSxPT08wTzBPMDBPMDBPT09PMCAuZ2V0ICgnZm9ybWF0dGVyJyksT09PME8wTzAwTzAwT09PTzAgLmdldCAoJ2Nob2ljZXMnKSNsaW5lOjcyCiAgICBPTzAwMDAwTzAwME9PT08wMCA9Z2V0X21vZGVsX2ZpZWxkcyAobW9kZWxfYWRtaW4gLm1vZGVsICkjbGluZTo3MwogICAgTzAwT08wME8wTzAwTzBPT08gPW1vZGVsX2FkbWluIC5nZXRfbGlzdF9kaXNwbGF5IChyZXF1ZXN0ICkjbGluZTo3NQogICAgTzBPME9PT08wME9PMDAwMDAgPVtdI2xpbmU6NzYKICAgIE9PME9PT08wT08wT09PMDBPID1bXSNsaW5lOjc3CiAgICBPME8wT08wMDBPT08wMDBPMCA9W10jbGluZTo3OAogICAgTzAwTzAwTzBPME8wME8wT08gPXt9I2xpbmU6ODEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZmllbGRzX29wdGlvbnMnKTojbGluZTo4MgogICAgICAgIE8wME8wME8wTzBPMDBPME9PID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsJ2ZpZWxkc19vcHRpb25zJykjbGluZTo4MwogICAgZm9yIE9PMDAwTzBPME9PTzBPME8wIGluIE8wME9PMDBPME8wME8wT09PIDojbGluZTo4NQogICAgICAgIE9PT08wTzAwTzAwMDBPTzAwID1maW5kX2ZpZWxkIChPTzAwMDAwTzAwME9PT08wMCAsT08wMDBPME8wT09PME8wTzAgKSNsaW5lOjg2CiAgICAgICAgaWYgT09PTzBPMDBPMDAwME9PMDAgOiNsaW5lOjg3CiAgICAgICAgICAgIE9PME9PT08wT08wT09PMDBPIC5hcHBlbmQgKE9PMDAwTzBPME9PTzBPME8wICkjbGluZTo4OAogICAgICAgICAgICBPTzBPT08wMDAwMDBPTzAwTyA9eyduYW1lJzpPTzAwME8wTzBPT08wTzBPMCAsJ2xhYmVsJzpPT09PME8wME8wMDAwT08wMCB9I2xpbmU6OTIKICAgICAgICAgICAgaWYgT08wMDBPME8wT09PME8wTzAgaW4gTzAwTzAwTzBPME8wME8wT08gOiNsaW5lOjkzCiAgICAgICAgICAgICAgICBPTzBPT08wMDAwMDBPTzAwTyA9ZGljdCAoT08wT09PMDAwMDAwT08wME8gLCoqTzAwTzAwTzBPME8wME8wT08gLmdldCAoT08wMDBPME8wT09PME8wTzAgKSkjbGluZTo5NAogICAgICAgICAgICBpZiAnc29ydGFibGUnbm90IGluIE9PME9PTzAwMDAwME9PMDBPIDojbGluZTo5NgogICAgICAgICAgICAgICAgT08wT09PMDAwMDAwT08wME8gWydzb3J0YWJsZSddPSdjdXN0b20nI2xpbmU6OTgKICAgICAgICAgICAgTzBPME9PMDAwT09PMDAwTzAgLmFwcGVuZCAoT08wT09PMDAwMDAwT08wME8gKSNsaW5lOjk5CiAgICAgICAgZWxzZSA6I2xpbmU6MTAwCiAgICAgICAgICAgIE8wTzBPT09PMDBPTzAwMDAwIC5hcHBlbmQgKE9PMDAwTzBPME9PTzBPME8wICkjbGluZToxMDEKICAgICAgICAgICAgT09PTzBPMDBPMDAwME9PMDAgPU9PMDAwTzBPME9PTzBPME8wICNsaW5lOjEwMgogICAgICAgICAgICBpZiBoYXNhdHRyIChtb2RlbF9hZG1pbiAsT08wMDBPME8wT09PME8wTzAgKTojbGluZToxMDMKICAgICAgICAgICAgICAgIE9PTzBPMDBPT09PTzAwT08wID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsT08wMDBPME8wT09PME8wTzAgKS5fX2RpY3RfXyAjbGluZToxMDQKICAgICAgICAgICAgZWxzZSA6I2xpbmU6MTA1CiAgICAgICAgICAgICAgICBPT08wTzAwT09PT08wME9PMCA9Z2V0YXR0ciAobW9kZWxfYWRtaW4gLm1vZGVsICxPTzAwME8wTzBPT08wTzBPMCApLl9fZGljdF9fICNsaW5lOjEwNgogICAgICAgICAgICBpZiAnc2hvcnRfZGVzY3JpcHRpb24naW4gT09PME8wME9PT09PMDBPTzAgOiNsaW5lOjEwNwogICAgICAgICAgICAgICAgT09PTzBPMDBPMDAwME9PMDAgPU9PTzBPMDBPT09PTzAwT08wIC5nZXQgKCdzaG9ydF9kZXNjcmlwdGlvbicpI2xpbmU6MTA4CiAgICAgICAgICAgIGVsaWYgT09PTzBPMDBPMDAwME9PMDAgPT0nX19zdHJfXyc6I2xpbmU6MTA5CiAgICAgICAgICAgICAgICBPT09PME8wME8wMDAwT08wMCA9bW9kZWxfYWRtaW4gLm1vZGVsIC5fbWV0YSAudmVyYm9zZV9uYW1lX3BsdXJhbCAjbGluZToxMTAKICAgICAgICAgICAgT08wT09PMDAwMDAwT08wME8gPXsnbmFtZSc6T08wMDBPME8wT09PME8wTzAgLCdsYWJlbCc6T09PTzBPMDBPMDAwME9PMDAgfSNsaW5lOjExNAogICAgICAgICAgICBpZiBPTzAwME8wTzBPT08wTzBPMCBpbiBPMDBPMDBPME8wTzAwTzBPTyA6I2xpbmU6MTE1CiAgICAgICAgICAgICAgICBPTzBPT08wMDAwMDBPTzAwTyA9ZGljdCAoT08wT09PMDAwMDAwT08wME8gLCoqTzAwTzAwTzBPME8wME8wT08gLmdldCAoT08wMDBPME8wT09PME8wTzAgKSkjbGluZToxMTYKICAgICAgICAgICAgT08wT09PMDAwMDAwT08wME8gWydzb3J0YWJsZSddPUZhbHNlICNsaW5lOjExOAogICAgICAgICAgICBPME8wT08wMDBPT08wMDBPMCAuYXBwZW5kIChPTzBPT08wMDAwMDBPTzAwTyApI2xpbmU6MTE5CiAgICBPMDAwT09PTzBPMDBPME9PMCA9Tm9uZSAjbGluZToxMjEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJyk6I2xpbmU6MTIyCiAgICAgICAgTzAwME9PT08wTzAwTzBPTzAgPWdldGF0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJykjbGluZToxMjMKICAgIE8wTzBPMDBPMDAwMDAwMDAwID1tb2RlbF9hZG1pbiAubW9kZWwgI2xpbmU6MTI2CiAgICBPTzBPME8wTzAwTzAwT08wTyA9e30jbGluZToxMjcKICAgIGZvciBPME9PME8wT09PME9PME9PMCBpbiBkaXIgKE8wTzBPMDBPMDAwMDAwMDAwICk6I2xpbmU6MTI4CiAgICAgICAgaWYgTzBPTzBPME9PTzBPTzBPTzAgLmVuZHN3aXRoICgnY2hvaWNlcycpOiNsaW5lOjEyOQogICAgICAgICAgICBPME9PME8wME9PTzAwME9PTyA9e30jbGluZToxMzAKICAgICAgICAgICAgT09PTzBPT09PME9PT09PT08gPWdldGF0dHIgKE8wTzBPMDBPMDAwMDAwMDAwICxPME9PME8wT09PME9PME9PMCApI2xpbmU6MTMxCiAgICAgICAgICAgIGZvciBPTzAwME8wTzBPT08wTzBPMCBpbiBPT09PME9PT08wT09PT09PTyA6I2xpbmU6MTMyCiAgICAgICAgICAgICAgICBPME9PME8wME9PTzAwME9PTyBbT08wMDBPME8wT09PME8wTzAgWzAgXV09T08wMDBPME8wT09PME8wTzAgWzEgXSNsaW5lOjEzMwogICAgICAgICAgICBPTzBPME8wTzAwTzAwT08wTyBbTzBPTzBPME9PTzBPTzBPTzAgXT1PME9PME8wME9PTzAwME9PTyAjbGluZToxMzQKICAgIGZvciBPME9PME8wT09PME9PME9PMCBpbiBPME8wTzAwTzAwMDAwMDAwMCAuX21ldGEgLmZpZWxkcyA6I2xpbmU6MTM1CiAgICAgICAgTzBPTzBPMDBPT08wMDBPT08gPXt9I2xpbmU6MTM2CiAgICAgICAgaWYgaGFzYXR0ciAoTzBPTzBPME9PTzBPTzBPTzAgLCdjaG9pY2VzJyk6I2xpbmU6MTM3CiAgICAgICAgICAgIGlmIGxlbiAoTzBPTzBPME9PTzBPTzBPTzAgLmNob2ljZXMgKT4wIDojbGluZToxMzgKICAgICAgICAgICAgICAgIGZvciBPTzAwME8wTzBPT08wTzBPMCBpbiBPME9PME8wT09PME9PME9PMCAuY2hvaWNlcyA6I2xpbmU6MTM5CiAgICAgICAgICAgICAgICAgICAgTzBPTzBPMDBPT08wMDBPT08gW09PMDAwTzBPME9PTzBPME8wIFswIF1dPU9PMDAwTzBPME9PTzBPME8wIFsxIF0jbGluZToxNDAKICAgICAgICAgICAgICAgIE9PME8wTzBPMDBPMDBPTzBPIFtPME9PME8wT09PME9PME9PMCAubmFtZSBdPU8wT08wTzAwT09PMDAwT09PICNsaW5lOjE0MQogICAgTU9ERUxfQ0FDSEUgW09PTzAwTzBPTzAwTzBPTzBPIF09eyd2YWx1ZXNfZmllbGRzJzpPTzBPT09PME9PME9PTzAwTyAsJ2Z1bl9maWVsZHMnOk8wTzBPT09PMDBPTzAwMDAwICwnaGVhZGVycyc6TzBPME9PMDAwT09PMDAwTzAgLCdmb3JtYXR0ZXInOk8wMDBPT09PME8wME8wT08wICwnY2hvaWNlcyc6T08wTzBPME8wME8wME9PME8gLH0jbGluZToxNDgKICAgIHJldHVybiBPTzBPT09PME9PME9PTzAwTyAsTzBPME9PT08wME9PMDAwMDAgLE8wTzBPTzAwME9PTzAwME8wICxPMDAwT09PTzBPMDBPME9PMCAsT08wTzBPME8wME8wME9PME8gI2xpbmU6MTQ5CmRlZiBnZXRfY3VzdG9tX2J1dHRvbiAocmVxdWVzdCAsYWRtaW4gKTojbGluZToxNTIKICAgIE8wTzBPTzAwME9PME8wT09PID17fSNsaW5lOjE1MwogICAgTzAwT08wTzBPT08wME8wMDAgPWFkbWluIC5nZXRfYWN0aW9ucyAocmVxdWVzdCApI2xpbmU6MTU0CiAgICBPMDAwT09PME8wTzBPMDBPMCA9YWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAjbGluZToxNTkKICAgIGlmIE8wME9PME8wT09PMDBPMDAwIDojbGluZToxNjAKICAgICAgICBPMDBPTzAwMDBPT09PT09PTyA9MCAjbGluZToxNjEKICAgICAgICBmb3IgTzBPMDAwTzAwMDBPMDBPME8gaW4gTzAwT08wTzBPT08wME8wMDAgOiNsaW5lOjE2MgogICAgICAgICAgICBPTzBPMDAwMDBPMDAwME8wMCA9e30jbGluZToxNjMKICAgICAgICAgICAgTzAwMDAwME9PMDAwT08wMDAgPU8wME9PME8wT09PMDBPMDAwIC5nZXQgKE8wTzAwME8wMDAwTzAwTzBPIClbMCBdI2xpbmU6MTY0CiAgICAgICAgICAgIGZvciBPT08wT09PMDAwMDBPME8wTyAsT08wMDAwTzBPMDBPTzBPTzAgaW4gTzAwMDAwME9PMDAwT08wMDAgLl9fZGljdF9fIC5pdGVtcyAoKTojbGluZToxNjUKICAgICAgICAgICAgICAgIGlmIE9PTzBPT08wMDAwME8wTzBPICE9J19fbGVuX18nYW5kIE9PTzBPT08wMDAwME8wTzBPICE9J19fd3JhcHBlZF9fJzojbGluZToxNjYKICAgICAgICAgICAgICAgICAgICBPTzBPMDAwMDBPMDAwME8wMCBbT09PME9PTzAwMDAwTzBPME8gXT1PTzAwMDBPME8wME9PME9PMCAjbGluZToxNjcKICAgICAgICAgICAgT08wTzAwMDAwTzAwMDBPMDAgWydlaWQnXT1PMDBPTzAwMDBPT09PT09PTyAjbGluZToxNjgKICAgICAgICAgICAgTzAwT08wMDAwT09PT09PT08gKz0xICNsaW5lOjE2OQogICAgICAgICAgICBpZiBPME8wMDBPMDAwME8wME8wTyA9PSdleHBvcnRfYWRtaW5fYWN0aW9uJzojbGluZToxNzAKICAgICAgICAgICAgICAgIE9PME8wMDAwME8wMDAwTzAwIFsnbGFiZWwnXT0n6YCJ5Lit5a+85Ye6JyNsaW5lOjE3MQogICAgICAgICAgICAgICAgT08wTzAwMDAwTzAwMDBPMDAgWydpc0V4cG9ydCddPVRydWUgI2xpbmU6MTcyCiAgICAgICAgICAgICAgICBPTzBPMDAwMDBPMDAwME8wMCBbJ2ljb24nXT0nZWwtaWNvbi1maW5pc2hlZCcjbGluZToxNzMKICAgICAgICAgICAgICAgIE9PME8wTzAwME9PME8wME9PID1bXSNsaW5lOjE3NAogICAgICAgICAgICAgICAgZm9yIE8wT08wMDAwT08wT09PME8wIGluIGVudW1lcmF0ZSAoYWRtaW4gLmdldF9leHBvcnRfZm9ybWF0cyAoKSk6I2xpbmU6MTc1CiAgICAgICAgICAgICAgICAgICAgT08wTzBPMDAwT08wTzAwT08gLmFwcGVuZCAoeyd2YWx1ZSc6TzBPTzAwMDBPTzBPT08wTzAgWzAgXSwnbGFiZWwnOk8wT08wMDAwT08wT09PME8wIFsxIF0oKS5nZXRfdGl0bGUgKCl9KSNsaW5lOjE3OQogICAgICAgICAgICAgICAgT08wTzAwMDAwTzAwMDBPMDAgWydmb3JtYXRzJ109T08wTzBPMDAwT08wTzAwT08gI2xpbmU6MTgxCiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjE4MgogICAgICAgICAgICAgICAgT08wTzAwMDAwTzAwMDBPMDAgWydsYWJlbCddPU8wME9PME8wT09PMDBPMDAwIC5nZXQgKE8wTzAwME8wMDAwTzAwTzBPIClbMiBdI2xpbmU6MTgzCiAgICAgICAgICAgIGlmIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtICgne30ue30nLmZvcm1hdCAoTzAwME9PTzBPME8wTzAwTzAgLE8wTzAwME8wMDAwTzAwTzBPICkpOiNsaW5lOjE4NgogICAgICAgICAgICAgICAgTzBPME9PMDAwT08wTzBPT08gW08wTzAwME8wMDAwTzAwTzBPIF09T08wTzAwMDAwTzAwMDBPMDAgI2xpbmU6MTg3CiAgICBpZiAnZGVsZXRlX3NlbGVjdGVkJ2luIE8wTzBPTzAwME9PME8wT09PIDojbGluZToxODgKICAgICAgICBkZWwgTzBPME9PMDAwT08wTzBPT08gWydkZWxldGVfc2VsZWN0ZWQnXSNsaW5lOjE4OQogICAgcmV0dXJuIE8wTzBPTzAwME9PME8wT09PICNsaW5lOjE5MApkZWYgc2VhcmNoX3BsYWNlaG9sZGVyIChjbCApOiNsaW5lOjE5MwogICAgTzBPT09PTzBPMDAwMDBPTzAgPWdldF9tb2RlbF9maWVsZHMgKGNsIC5tb2RlbCApI2xpbmU6MTk1CiAgICBmb3IgTzBPTzAwTzAwTzBPME9PMDAgaW4gY2wgLm1vZGVsIC5fbWV0YSAuZmllbGRzIDojbGluZToxOTcKICAgICAgICBpZiBpc2luc3RhbmNlIChPME9PMDBPMDBPME8wT08wMCAsRm9yZWlnbktleSApOiNsaW5lOjE5OAogICAgICAgICAgICBPME9PT09PME8wMDAwME9PMCAuZXh0ZW5kIChnZXRfbW9kZWxfZmllbGRzIChPME9PMDBPMDBPME8wT08wMCAucmVsYXRlZF9tb2RlbCAsTzBPTzAwTzAwTzBPME9PMDAgLm5hbWUgKSkjbGluZToxOTkKICAgIE8wT08wTzAwTzBPME8wME8wID1bXSNsaW5lOjIwMQogICAgZm9yIE8wTzBPME8wT08wME8wTzAwIGluIGNsIC5zZWFyY2hfZmllbGRzIDojbGluZToyMDMKICAgICAgICBmb3IgTzBPTzAwTzAwTzBPME9PMDAgaW4gTzBPT09PTzBPMDAwMDBPTzAgOiNsaW5lOjIwNAogICAgICAgICAgICBpZiBPME9PMDBPMDBPME8wT08wMCBbMCBdPT1PME8wTzBPME9PMDBPME8wMCA6I2xpbmU6MjA1CiAgICAgICAgICAgICAgICBPME9PME8wME8wTzBPMDBPMCAuYXBwZW5kIChPME9PMDBPMDBPME8wT08wMCBbMSBdKSNsaW5lOjIwNgogICAgICAgICAgICAgICAgYnJlYWsgI2xpbmU6MjA3CiAgICByZXR1cm4gIiwiLmpvaW4gKE8wT08wTzAwTzBPME8wME8wICkjbGluZToyMDkKZGVmIHdyaXRlIChkYXRhICxPME8wME8wT08wME8wT09PMCA9J29rJyxPT08wT08wTzAwTzAwMDAwTyA9VHJ1ZSApOiNsaW5lOjIxMgogICAgTzAwTzBPME9PT08wMDAwMDAgPXsnc3RhdGUnOk9PTzBPTzBPMDBPMDAwMDBPICwnbXNnJzpPME8wME8wT08wME8wT09PMCAsJ2RhdGEnOmRhdGEgfSNsaW5lOjIxNwogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKE8wME8wTzBPT09PMDAwMDAwICxjbHMgPUxhenlFbmNvZGVyICksY29udGVudF90eXBlID0nYXBwbGljYXRpb24vanNvbicpI2xpbmU6MjE5CmRlZiB3cml0ZV9vYmogKG9iaiApOiNsaW5lOjIyMgogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKG9iaiAsY2xzID1MYXp5RW5jb2RlciApLGNvbnRlbnRfdHlwZSA9J2FwcGxpY2F0aW9uL2pzb24nKSNsaW5lOjIyMwpkZWYgaGFzX3Blcm1pc3Npb24gKHJlcXVlc3QgLGFkbWluICxwZXJtaXNzaW9uICk6I2xpbmU6MjI2CiAgICBPMDAwTzAwME9PT08wT09PTyA9Z2V0X3Blcm1pc3Npb25fY29kZW5hbWUgKHBlcm1pc3Npb24gLGFkbWluIC5vcHRzICkjbGluZToyMjcKICAgIE9PMDBPT08wT08wTzBPT08wID0ne30ue30nLmZvcm1hdCAoYWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAsTzAwME8wMDBPT09PME9PT08gKSNsaW5lOjIyOAogICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChPTzAwT09PME9PME8wT09PMCApI2xpbmU6MjI5CmRlZiBnZXRfcGVybWlzc2lvbl9jb2RlbmFtZSAoYWN0aW9uICxvcHRzICk6I2xpbmU6MjMyCiAgICAiIiNsaW5lOjIzNQogICAgcmV0dXJuICclc18lcyclKGFjdGlvbiAsb3B0cyAubW9kZWxfbmFtZSApI2xpbmU6MjM2CmZyb20gc2ltcGxldWkgLnRlbXBsYXRldGFncyBpbXBvcnQgc2ltcGxldGFncyAjbGluZToyMzkKZnJvbSBzaW1wbGV1aSAudGVtcGxhdGV0YWdzIC5zaW1wbGV0YWdzIGltcG9ydCBnZXRfY29uZmlnICNsaW5lOjI0MApkZWYgZ2V0X21lbnVzIChyZXF1ZXN0ICxhZG1pbl9zaXRlICk6I2xpbmU6MjQzCiAgICAiIiNsaW5lOjI0OQogICAgTzAwTzAwME9PTzBPT09PT08gPXsnYXBwX2xpc3QnOmFkbWluX3NpdGUgLmdldF9hcHBfbGlzdCAocmVxdWVzdCApLCdyZXF1ZXN0JzpyZXF1ZXN0IH0jbGluZToyNTMKICAgIGRlZiBPTzBPT09PMDBPMDBPME9PMCAoa2V5ICk6I2xpbmU6MjU1CiAgICAgICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChrZXkgKSNsaW5lOjI1NgogICAgZGVmIF9PTzAwMDBPTzAwMDBPTzAwTyAoa2V5ICk6I2xpbmU6MjU4CiAgICAgICAgaWYga2V5ID09J1NJTVBMRVVJX0NPTkZJRyc6I2xpbmU6MjU5CiAgICAgICAgICAgIF9PMDBPT09PME8wTzBPMDBPTyA9Z2V0X2NvbmZpZyAoa2V5ICkjbGluZToyNjEKICAgICAgICAgICAgaWYgX08wME9PT08wTzBPME8wME9PIGFuZCAnbWVudXMnaW4gX08wME9PT08wTzBPME8wME9PIDojbGluZToyNjIKICAgICAgICAgICAgICAgIE9PTzAwTzAwT08wT08wT09PID1fTzAwT09PTzBPME8wTzAwT08gLmdldCAoJ21lbnVzJykjbGluZToyNjMKICAgICAgICAgICAgICAgIE8wMDAwT09PTzBPTzBPT08wID1bXSNsaW5lOjI2NAogICAgICAgICAgICAgICAgZm9yIE8wME8wT09PME9PTzBPMDAwIGluIE9PTzAwTzAwT08wT08wT09PIDojbGluZToyNjYKICAgICAgICAgICAgICAgICAgICBpZiAnY29kZW5hbWUnbm90IGluIE8wME8wT09PME9PTzBPMDAwIDojbGluZToyNjcKICAgICAgICAgICAgICAgICAgICAgICAgTzAwMDBPT09PME9PME9PTzAgLmFwcGVuZCAoTzAwTzBPT08wT09PME8wMDAgKSNsaW5lOjI2OAogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSAjbGluZToyNjkKICAgICAgICAgICAgICAgICAgICBPME9PTzAwME9PMDBPMDAwTyA9TzAwTzBPT08wT09PME8wMDAgLmdldCAoJ2NvZGVuYW1lJykjbGluZToyNzAKICAgICAgICAgICAgICAgICAgICBrZXkgPSd7fS57fScuZm9ybWF0IChPME9PTzAwME9PMDBPMDAwTyAsTzBPT08wMDBPTzAwTzAwME8gKSNsaW5lOjI3MwogICAgICAgICAgICAgICAgICAgIGlmIE9PME9PT08wME8wME8wT08wIChrZXkgKTojbGluZToyNzQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21vZGVscydpbiBPMDBPME9PTzBPT08wTzAwMCA6I2xpbmU6Mjc2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPT08wT09PMDBPTzBPT09PMCA9TzAwTzBPT08wT09PME8wMDAgLmdldCAoJ21vZGVscycpI2xpbmU6Mjc3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPMDAwTzAwMDAwT09PTzAwTyA9W10jbGluZToyNzgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBPTzAwMDBPMDAwMDBPMDAwMCBpbiBPT08wT09PMDBPTzBPT09PMCA6I2xpbmU6Mjc5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2NvZGVuYW1lJ2luIE9PMDAwME8wMDAwME8wMDAwIDojbGluZToyODAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgT08wT09PTzAwTzAwTzBPTzAgKCd7fS57fScuZm9ybWF0IChPME9PTzAwME9PMDBPMDAwTyAsT08wMDAwTzAwMDAwTzAwMDAgLmdldCAoJ2NvZGVuYW1lJykpKTojbGluZToyODEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE8wMDBPMDAwMDBPT09PMDBPIC5hcHBlbmQgKE9PMDAwME8wMDAwME8wMDAwICkjbGluZToyODIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIDojbGluZToyODMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTzAwME8wMDAwME9PT08wME8gLmFwcGVuZCAoT08wMDAwTzAwMDAwTzAwMDAgKSNsaW5lOjI4NAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTzAwTzBPT08wT09PME8wMDAgWydtb2RlbHMnXT1PMDAwTzAwMDAwT09PTzAwTyAjbGluZToyODUKICAgICAgICAgICAgICAgICAgICAgICAgTzAwMDBPT09PME9PME9PTzAgLmFwcGVuZCAoTzAwTzBPT08wT09PME8wMDAgKSNsaW5lOjI4NwogICAgICAgICAgICAgICAgX08wME9PT08wTzBPME8wME9PIFsnbWVudXMnXT1PMDAwME9PT08wT08wT09PMCAjbGluZToyODgKICAgICAgICByZXR1cm4gX08wME9PT08wTzBPME8wME9PICNsaW5lOjI5MAogICAgcmV0dXJuIHNpbXBsZXRhZ3MgLm1lbnVzIChPMDBPMDAwT09PME9PT09PTyAsX2dldF9jb25maWcgPV9PTzAwMDBPTzAwMDBPTzAwTyApI2xpbmU6MjkyCg=='))