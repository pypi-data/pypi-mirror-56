import base64
exec(base64.b64decode(b'aW1wb3J0IG9zICNsaW5lOjEKZnJvbSBkamFuZ28gLmNvbnRyaWIgLmF1dGggLm1vZGVscyBpbXBvcnQgR3JvdXAgI2xpbmU6Mwpmcm9tIGRqYW5nbyAudmlld3MgLmRlY29yYXRvcnMgLmNzcmYgaW1wb3J0IGNzcmZfZXhlbXB0ICNsaW5lOjQKZnJvbSBzaW1wbGVwcm8gLnV0aWxzIGltcG9ydCB3cml0ZSAjbGluZTo2CmZyb20gLnV0aWxzIGltcG9ydCBnZXRfcGVybWlzc2lvbnMgI2xpbmU6NwppbXBvcnQgYmFzZTY0ICNsaW5lOjkKZnJvbSAuLmJhY2tlbmRzIGltcG9ydCBPME8wT09PME9PTzBPTzBPMCAjbGluZToxMQpkZWYgYWN0aW9uIChyZXF1ZXN0ICk6I2xpbmU6MTQKICAgIE8wT08wMDBPMDAwMDAwT09PID1yZXF1ZXN0IC5QT1NUIC5nZXQgKCdhY3Rpb24nKSNsaW5lOjE1CiAgICBPTzAwME9PT09PT09PT09PMCA9eyd0cmVlJzpnZXRfdHJlZSAsJ3NhdmUnOnNhdmUgLCdnZXRfZGV0YWlsJzpnZXRfZGV0YWlsIH0jbGluZToyMQogICAgcmV0dXJuIE9PMDAwT09PT09PT09PT08wIC5nZXQgKE8wT08wMDBPMDAwMDAwT09PICkocmVxdWVzdCApI2xpbmU6MjMKZGVmIGdldF9kZXRhaWwgKHJlcXVlc3QgKTojbGluZToyNgogICAgT09PME9PT08wT08wMDAwMDAgPXJlcXVlc3QgLlBPU1QgLmdldCAoJ2lkJykjbGluZToyNwogICAgTzBPME9PMDAwT09PMDBPT08gPUdyb3VwIC5vYmplY3RzIC5maWx0ZXIgKGlkID1PT08wT09PTzBPTzAwMDAwMCApLmZpcnN0ICgpI2xpbmU6MjgKICAgIE9PME8wME8wMDAwT08wME9PID1bXSNsaW5lOjI5CiAgICBpZiBPME8wT08wMDBPT08wME9PTyA6I2xpbmU6MzAKICAgICAgICBPMDAwT09PME8wT09PTzBPTyA9TzBPME9PMDAwT09PMDBPT08gLnBlcm1pc3Npb25zIC5hbGwgKCkjbGluZTozMQogICAgICAgIGZvciBPT09PMDBPTzBPT08wME8wTyBpbiBPMDAwT09PME8wT09PTzBPTyA6I2xpbmU6MzIKICAgICAgICAgICAgT08wTzAwTzAwMDBPTzAwT08gLmFwcGVuZCAoT09PTzAwT08wT09PMDBPME8gLmlkICkjbGluZTozMwogICAgcmV0dXJuIHdyaXRlIChPTzBPMDBPMDAwME9PMDBPTyApI2xpbmU6MzUKZGVmIHNhdmUgKHJlcXVlc3QgKTojbGluZTozOAogICAgT09PMDAwMDBPT09PME8wMDAgPVRydWUgI2xpbmU6MzkKICAgIE9PT09PTzBPTzAwME9PTzAwID0ib2siI2xpbmU6NDAKICAgIHRyeSA6I2xpbmU6NDEKICAgICAgICBPTzBPTzBPTzAwT09PMDAwTyA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnbmFtZScpI2xpbmU6NDIKICAgICAgICBPMDBPMDBPT08wTzBPT09PMCA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnaWRzJykjbGluZTo0MwogICAgICAgIE9PMDAwTzBPMDBPT08wT09PID1yZXF1ZXN0IC5QT1NUIC5nZXQgKCdpZCcpI2xpbmU6NDQKICAgICAgICBpZiBPTzAwME8wTzAwT09PME9PTyBhbmQgT08wMDBPME8wME9PTzBPT08gIT0nJzojbGluZTo0NwogICAgICAgICAgICBPTzAwT08wT08wTzBPTzAwTyA9R3JvdXAgLm9iamVjdHMgLmdldCAoaWQgPU9PMDAwTzBPMDBPT08wT09PICkjbGluZTo0OAogICAgICAgICAgICBPTzAwT08wT08wTzBPTzAwTyAucGVybWlzc2lvbnMgLmNsZWFyICgpI2xpbmU6NTAKICAgICAgICBlbHNlIDojbGluZTo1MQogICAgICAgICAgICBPTzAwT08wT08wTzBPTzAwTyA9R3JvdXAgLm9iamVjdHMgLmNyZWF0ZSAobmFtZSA9T08wT08wT08wME9PTzAwME8gKSNsaW5lOjUyCiAgICAgICAgaWYgTzAwTzAwT09PME8wT09PTzAgYW5kIE8wME8wME9PTzBPME9PT08wICE9Jyc6I2xpbmU6NTMKICAgICAgICAgICAgTzAwTzAwT09PME8wT09PTzAgPU8wME8wME9PTzBPME9PT08wIC5zcGxpdCAoJywnKSNsaW5lOjU0CiAgICAgICAgICAgIGZvciBPTzAwME8wMDAwMDAwT09PTyBpbiBPMDBPMDBPT08wTzBPT09PMCA6I2xpbmU6NTUKICAgICAgICAgICAgICAgIE9PMDBPTzBPTzBPME9PMDBPIC5wZXJtaXNzaW9ucyAuYWRkIChPTzAwME8wMDAwMDAwT09PTyApI2xpbmU6NTcKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgTzBPMDBPTzBPMDBPMDBPME8gOiNsaW5lOjU4CiAgICAgICAgT09PMDAwMDBPT09PME8wMDAgPUZhbHNlICNsaW5lOjU5CiAgICAgICAgT09PT09PME9PMDAwT09PMDAgPU8wTzAwT08wTzAwTzAwTzBPIC5hcmdzIFswIF0jbGluZTo2MAogICAgcmV0dXJuIHdyaXRlIChOb25lICxPT09PT08wT08wMDBPT08wMCAsT09PMDAwMDBPT09PME8wMDAgKSNsaW5lOjYxCmRlZiBnZXRfdHJlZSAocmVxdWVzdCApOiNsaW5lOjY0CiAgICAiIiNsaW5lOjY5CiAgICBPTzBPME9PMDBPT09PTzAwTyA9Z2V0X3Blcm1pc3Npb25zICgpI2xpbmU6NzAKICAgIHJldHVybiB3cml0ZSAoT08wTzBPTzAwT09PT08wME8gKSNsaW5lOjcxCkBjc3JmX2V4ZW1wdCAjbGluZTo3NApkZWYgb2ZmbGluZV9hY3RpdmUgKHJlcXVlc3QgKTojbGluZTo3NQogICAgT09PMDAwME8wME8wMDBPMDAgPVRydWUgI2xpbmU6NzYKICAgIE9PTzAwT09PMDBPT09PMDBPID0n5r+A5rS75paH5Lu25YaZ5YWl5oiQ5Yqf77yBJyNsaW5lOjc3CiAgICB0cnkgOiNsaW5lOjc5CiAgICAgICAgTzAwMDAwTzBPT08wT08wTzAgPW9zIC5wYXRoIC5qb2luIChvcyAuZ2V0Y3dkICgpLCdzaW1wbGVwcm8ubGljJykjbGluZTo4MAogICAgICAgIE8wMDBPT09PMDBPT08wME8wID1vcGVuIChPMDAwMDBPME9PTzBPTzBPMCAsJ3diJykjbGluZTo4MQogICAgICAgIE8wMDBPT09PMDBPT08wME8wIC5zZWVrICgwICkjbGluZTo4MgogICAgICAgIE9PME8wMDAwME9PTzAwT09PID1yZXF1ZXN0IC5QT1NUIC5nZXQgKCdjb2RlJykjbGluZTo4MwogICAgICAgIE9PT09PMDAwME8wT08wTzAwID1iYXNlNjQgLmI2NGRlY29kZSAoT08wTzAwMDAwT09PMDBPT08gKSNsaW5lOjg0CiAgICAgICAgTzAwME9PT08wME9PTzAwTzAgLndyaXRlIChPT09PTzAwMDBPME9PME8wMCApI2xpbmU6ODUKICAgICAgICBPMDAwT09PTzAwT09PMDBPMCAuY2xvc2UgKCkjbGluZTo4NgogICAgICAgIE8wTzBPT08wT09PME9PME8wIChUcnVlICkjbGluZTo4NwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPT09PTzBPT09PTzBPT08wMCA6I2xpbmU6ODgKICAgICAgICBPT08wMDAwTzAwTzAwME8wMCA9RmFsc2UgI2xpbmU6ODkKICAgICAgICBPT08wME9PTzAwT09PTzAwTyA9T09PT08wT09PT08wT09PMDAgLmFyZ3MgWzAgXSNsaW5lOjkwCiAgICByZXR1cm4gd3JpdGUgKE5vbmUgLE9PTzAwT09PMDBPT09PMDBPICxPT08wMDAwTzAwTzAwME8wMCApI2xpbmU6OTIK'))