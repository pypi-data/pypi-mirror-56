import base64
exec(base64.b64decode(b'ZnJvbSBkamFuZ28gLmNvbnRyaWIgLmF1dGggLm1vZGVscyBpbXBvcnQgUGVybWlzc2lvbiAjbGluZToxCmRlZiBnZXRfYWN0aW9uX25hbWUgKG5hbWUgKTojbGluZTo0CiAgICAiIiNsaW5lOjkKICAgIG5hbWUgPW5hbWUgLnJlcGxhY2UgKCdDYW4gYWRkICcsJ+WinuWKoCcpLnJlcGxhY2UgKCdDYW4gY2hhbmdlICcsJ+e8lui+kScpLnJlcGxhY2UgKCdDYW4gZGVsZXRlICcsJ+WIoOmZpCcpLnJlcGxhY2UgKCdDYW4gdmlldyAnLCfmn6XnnIsnKSNsaW5lOjExCiAgICByZXR1cm4gbmFtZSAjbGluZToxMgpkZWYgZ2V0X3Blcm1pc3Npb25zICgpOiNsaW5lOjE1CiAgICAiIiNsaW5lOjE5CiAgICBPT08wME9PME9PTzAwTzAwMCA9UGVybWlzc2lvbiAub2JqZWN0cyAuYWxsICgpI2xpbmU6MjAKICAgIE8wMDAwT09PMDAwTzBPME9PID17fSNsaW5lOjIzCiAgICBmb3IgT09PT09PT08wMDBPME9PTzAgaW4gT09PMDBPTzBPT08wME8wMDAgOiNsaW5lOjI1CiAgICAgICAgT08wTzAwT09PME8wTzBPMDAgPU9PT09PT09PMDAwTzBPT08wIC5jb250ZW50X3R5cGUgLmFwcF9sYWJlbCAjbGluZToyNgogICAgICAgIGlmIE9PME8wME9PTzBPME8wTzAwIG5vdCBpbiBPMDAwME9PTzAwME8wTzBPTyA6I2xpbmU6MjcKICAgICAgICAgICAgTzAwMDBPT08wMDBPME8wT08gW09PME8wME9PTzBPME8wTzAwIF09eydsYWJlbCc6T08wTzAwT09PME8wTzBPMDAgLCdjaGlsZHJlbic6W09PT09PT09PMDAwTzBPT08wIF19I2xpbmU6MzEKICAgICAgICBlbHNlIDojbGluZTozMgogICAgICAgICAgICBPME8wMDAwTzAwME8wTzBPMCA9TzAwMDBPT08wMDBPME8wT08gLmdldCAoT08wTzAwT09PME8wTzBPMDAgKSNsaW5lOjMzCiAgICAgICAgICAgIE9PMDBPME9PME9PTzBPT09PID1PME8wMDAwTzAwME8wTzBPMCAuZ2V0ICgnY2hpbGRyZW4nKSNsaW5lOjM0CiAgICAgICAgICAgIE9PMDBPME9PME9PTzBPT09PIC5hcHBlbmQgKE9PT09PT09PMDAwTzBPT08wICkjbGluZTozNQogICAgZm9yIE9PT08wMDBPTzAwME8wME9PIGluIE8wMDAwT09PMDAwTzBPME9PIDojbGluZTo0MAogICAgICAgIE9PT09PT09PMDAwTzBPT08wID1PMDAwME9PTzAwME8wTzBPTyAuZ2V0IChPT09PMDAwT08wMDBPMDBPTyApI2xpbmU6NDEKICAgICAgICBPTzAwTzBPTzBPT08wT09PTyA9T09PT09PT08wMDBPME9PTzAgLmdldCAoJ2NoaWxkcmVuJykjbGluZTo0MgogICAgICAgIE8wME9PMDAwT08wTzBPME8wID17fSNsaW5lOjQ1CiAgICAgICAgZm9yIE9PME8wME9PTzBPTzBPTzBPIGluIE9PMDBPME9PME9PTzBPT09PIDojbGluZTo0NgogICAgICAgICAgICBPTzBPMDBPT08wTzBPME8wMCA9T08wTzAwT09PME9PME9PME8gLmNvbnRlbnRfdHlwZSAubmFtZSAjbGluZTo0OAogICAgICAgICAgICBpZiBPTzBPMDBPT08wTzBPME8wMCBub3QgaW4gTzAwT08wMDBPTzBPME8wTzAgOiNsaW5lOjQ5CiAgICAgICAgICAgICAgICBPMDBPTzAwME9PME8wTzBPMCBbT08wTzAwT09PME8wTzBPMDAgXT17J2xhYmVsJzpPTzBPMDBPT08wTzBPME8wMCAsJ2NoaWxkcmVuJzpbeydpZCc6T08wTzAwT09PME9PME9PME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT08wTzAwT09PME9PME9PME8gLm5hbWUgKX1dfSNsaW5lOjU2CiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjU3CiAgICAgICAgICAgICAgICBPMDBPTzAwME9PME8wTzBPMCBbT08wTzAwT09PME8wTzBPMDAgXS5nZXQgKCdjaGlsZHJlbicpLmFwcGVuZCAoeydpZCc6T08wTzAwT09PME9PME9PME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT08wTzAwT09PME9PME9PME8gLm5hbWUgKX0pI2xpbmU6NjEKICAgICAgICBPME9PMDAwME9PTzBPT09PTyA9W10jbGluZTo2MgogICAgICAgIGZvciBPTzBPMDBPT08wT08wT08wTyBpbiBPMDBPTzAwME9PME8wTzBPMCA6I2xpbmU6NjMKICAgICAgICAgICAgTzBPTzAwMDBPT08wT09PT08gLmFwcGVuZCAoTzAwT08wMDBPTzBPME8wTzAgLmdldCAoT08wTzAwT09PME9PME9PME8gKSkjbGluZTo2NAogICAgICAgIE9PT09PT09PMDAwTzBPT08wIFsnY2hpbGRyZW4nXT1PME9PMDAwME9PTzBPT09PTyAjbGluZTo2NQogICAgTzBPME8wMDAwME9PME8wTzAgPVtdI2xpbmU6NjcKICAgIGZvciBPTzBPMDBPT08wT08wT08wTyBpbiBPMDAwME9PTzAwME8wTzBPTyA6I2xpbmU6NjgKICAgICAgICBPME8wTzAwMDAwT08wTzBPMCAuYXBwZW5kIChPMDAwME9PTzAwME8wTzBPTyAuZ2V0IChPTzBPMDBPT08wT08wT08wTyApKSNsaW5lOjY5CiAgICByZXR1cm4gTzBPME8wMDAwME9PME8wTzAgI2xpbmU6NzEK'))