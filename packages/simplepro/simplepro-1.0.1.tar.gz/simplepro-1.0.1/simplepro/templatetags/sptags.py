import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6Mgpmcm9tIGRqYW5nbyBpbXBvcnQgdGVtcGxhdGUgI2xpbmU6NApyZWdpc3RlciA9dGVtcGxhdGUgLkxpYnJhcnkgKCkjbGluZTo2CmZyb20gaW1wb3J0X2V4cG9ydCAuYWRtaW4gaW1wb3J0IEltcG9ydEV4cG9ydE1peGluQmFzZSAjbGluZTo4CmZyb20gc2ltcGxlcHJvIGltcG9ydCBjb25mICNsaW5lOjkKaW1wb3J0IHNpbXBsZXBybyAjbGluZToxMAppbXBvcnQgc2ltcGxldWkgI2xpbmU6MTEKQHJlZ2lzdGVyIC5zaW1wbGVfdGFnICh0YWtlc19jb250ZXh0ID1UcnVlICkjbGluZToxNApkZWYgaGFzX2ltcG9ydF9leHBvcnQgKGNvbnRleHQgKTojbGluZToxNQogICAgT08wMDAwMDBPME9PT09PMDAgPWNvbnRleHQgLmdldCAoJ2NsJykjbGluZToxNgogICAgcmV0dXJuIGlzc3ViY2xhc3MgKE9PMDAwMDAwTzBPT09PTzAwIC5fX2NsYXNzX18gLEltcG9ydEV4cG9ydE1peGluQmFzZSApI2xpbmU6MTcKQHJlZ2lzdGVyIC5zaW1wbGVfdGFnICh0YWtlc19jb250ZXh0ID1UcnVlICkjbGluZToyMApkZWYgZ2V0X2Rpc3BsYXlfbmFtZSAoY29udGV4dCApOiNsaW5lOjIxCiAgICBPMDAwME9PTzBPT08wME9PTyA9Y29udGV4dCAuZ2V0ICgndXNlcicpI2xpbmU6MjIKICAgIGlmIE8wMDAwT09PME9PTzAwT09PIDojbGluZToyNAogICAgICAgIE8wMDBPMDBPME8wTzBPT09PID0nJyNsaW5lOjI1CiAgICAgICAgaWYgTzAwMDBPT08wT09PMDBPT08gLmZpcnN0X25hbWUgOiNsaW5lOjI3CiAgICAgICAgICAgIE8wMDBPMDBPME8wTzBPT09PICs9TzAwMDBPT08wT09PMDBPT08gLmZpcnN0X25hbWUgI2xpbmU6MjgKICAgICAgICBpZiBPMDAwME9PTzBPT08wME9PTyAubGFzdF9uYW1lIDojbGluZToyOQogICAgICAgICAgICBPMDAwTzAwTzBPME8wT09PTyArPU8wMDAwT09PME9PTzAwT09PIC5sYXN0X25hbWUgI2xpbmU6MzAKICAgIGlmIG5vdCBPMDAwTzAwTzBPME8wT09PTyA6I2xpbmU6MzEKICAgICAgICBPMDAwTzAwTzBPME8wT09PTyA9c3RyIChPMDAwME9PTzBPT08wME9PTyApI2xpbmU6MzIKICAgIHJldHVybiBPMDAwTzAwTzBPME8wT09PTyAjbGluZTozMwpAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6MzYKZGVmIGdldF9zZXJ2ZXJfdXJsICgpOiNsaW5lOjM3CiAgICByZXR1cm4gY29uZiAuZ2V0X3NlcnZlcl91cmwgKCkjbGluZTozOApAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6NDEKZGVmIGdldF9zcF92ZXJzaW9uICgpOiNsaW5lOjQyCiAgICByZXR1cm4gc2ltcGxlcHJvIC5nZXRfdmVyc2lvbiAoKSNsaW5lOjQzCkByZWdpc3RlciAuc2ltcGxlX3RhZyAjbGluZTo0NgpkZWYgZ2V0X2RldmljZV9pZCAoKTojbGluZTo0NwogICAgcmV0dXJuIGNvbmYgLmdldF9kZXZpY2VfaWQgKCkjbGluZTo0OApAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6NTEKZGVmIGdldF9zaW1wbGVfdmVyc2lvbiAoKTojbGluZTo1MgogICAgcmV0dXJuIHNpbXBsZXVpIC5nZXRfdmVyc2lvbiAoKSNsaW5lOjUzCkByZWdpc3RlciAuc2ltcGxlX3RhZyAodGFrZXNfY29udGV4dCA9VHJ1ZSApI2xpbmU6NTYKZGVmIHRlc3RfdGFnIChjb250ZXh0ICk6I2xpbmU6NTcKICAgIHByaW50IChjb250ZXh0ICkjbGluZTo1OAogICAgTzAwTzAwTzAwMDBPTzAwT08gPWNvbnRleHQgLmdldCAoJ2ZpZWxkc2V0JykjbGluZTo1OQogICAgZm9yIE9PMDAwMDBPTzAwT08wTzAwIGluIE8wME8wME8wMDAwT08wME9PIDojbGluZTo2MAogICAgICAgIHByaW50IChPTzAwMDAwT08wME9PME8wMCApI2xpbmU6NjEKICAgIHBhc3MgI2xpbmU6NjIK'))