import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6MQpmcm9tIGRqYW5nbyAuY29yZSAuc2VyaWFsaXplcnMgLmpzb24gaW1wb3J0IERqYW5nb0pTT05FbmNvZGVyICNsaW5lOjMKZnJvbSBkamFuZ28gLmRiIC5tb2RlbHMgaW1wb3J0IEZvcmVpZ25LZXkgI2xpbmU6NApmcm9tIGRqYW5nbyAuaHR0cCBpbXBvcnQgSHR0cFJlc3BvbnNlICNsaW5lOjUKZnJvbSBkamFuZ28gLnV0aWxzIC5lbmNvZGluZyBpbXBvcnQgZm9yY2VfdGV4dCAjbGluZTo2CmZyb20gZGphbmdvIC51dGlscyAuZnVuY3Rpb25hbCBpbXBvcnQgUHJvbWlzZSAjbGluZTo3CmltcG9ydCBkYXRldGltZSAjbGluZTo5CmNsYXNzIExhenlFbmNvZGVyIChEamFuZ29KU09ORW5jb2RlciApOiNsaW5lOjEyCiAgICAiIiNsaW5lOjE1CiAgICBkZWYgZGVmYXVsdCAoc2VsZiAsb2JqICk6I2xpbmU6MTcKICAgICAgICBpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRldGltZSApOiNsaW5lOjE4CiAgICAgICAgICAgIHJldHVybiBvYmogLnN0cmZ0aW1lICgiJVktJW0tJWQgJUg6JU06JVMiKSNsaW5lOjE5CiAgICAgICAgZWxpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRlICk6I2xpbmU6MjAKICAgICAgICAgICAgcmV0dXJuIG9iaiAuc3RyZnRpbWUgKCIlWS0lbS0lZCIpI2xpbmU6MjEKICAgICAgICBlbGlmIGlzaW5zdGFuY2UgKG9iaiAsUHJvbWlzZSApOiNsaW5lOjIyCiAgICAgICAgICAgIHJldHVybiBmb3JjZV90ZXh0IChvYmogKSNsaW5lOjIzCiAgICAgICAgcmV0dXJuIHN0ciAob2JqICkjbGluZToyNApkZWYgZ2V0X21vZGVsX2ZpZWxkcyAobW9kZWwgLE8wME8wT08wT08wTzBPTzBPID1Ob25lICk6I2xpbmU6MjgKICAgICIiI2xpbmU6MzQKICAgIE8wME8wT09PT09PTzBPT08wID1bXSNsaW5lOjM1CiAgICBPTzBPMDAwT09PMDAwME8wTyA9bW9kZWwgLl9tZXRhIC5maWVsZHMgI2xpbmU6MzYKICAgIGZvciBPTzAwMDBPT09PTzAwTzBPMCBpbiBPTzBPMDAwT09PMDAwME8wTyA6I2xpbmU6MzcKICAgICAgICBPMDAwTzAwMDAwME9PMDAwMCA9T08wMDAwT09PT08wME8wTzAgLm5hbWUgI2xpbmU6MzgKICAgICAgICBpZiBoYXNhdHRyIChPTzAwMDBPT09PTzAwTzBPMCAsJ3ZlcmJvc2VfbmFtZScpOiNsaW5lOjM5CiAgICAgICAgICAgIE8wMDBPMDAwMDAwT08wMDAwID1nZXRhdHRyIChPTzAwMDBPT09PTzAwTzBPMCAsJ3ZlcmJvc2VfbmFtZScpI2xpbmU6NDAKICAgICAgICBpZiBpc2luc3RhbmNlIChPMDAwTzAwMDAwME9PMDAwMCAsUHJvbWlzZSApOiNsaW5lOjQyCiAgICAgICAgICAgIE8wMDBPMDAwMDAwT08wMDAwID1zdHIgKE8wMDBPMDAwMDAwT08wMDAwICkjbGluZTo0MwogICAgICAgIGlmIE8wME8wT08wT08wTzBPTzBPIDojbGluZTo0NQogICAgICAgICAgICBPMDBPME9PT09PT08wT09PMCAuYXBwZW5kICgoJ3t9X197fScuZm9ybWF0IChPMDBPME9PME9PME8wT08wTyAsT08wMDAwT09PT08wME8wTzAgLm5hbWUgKSxPMDAwTzAwMDAwME9PMDAwMCApKSNsaW5lOjQ2CiAgICAgICAgZWxzZSA6I2xpbmU6NDcKICAgICAgICAgICAgTzAwTzBPT09PT09PME9PTzAgLmFwcGVuZCAoKE9PMDAwME9PT09PMDBPME8wIC5uYW1lICxPMDAwTzAwMDAwME9PMDAwMCApKSNsaW5lOjQ4CiAgICByZXR1cm4gTzAwTzBPT09PT09PME9PTzAgI2xpbmU6NTAKZGVmIGZpbmRfZmllbGQgKGZpZWxkcyAsbmFtZSApOiNsaW5lOjUzCiAgICBmb3IgT09PME8wME9PMDBPT08wME8gaW4gZmllbGRzIDojbGluZTo1NAogICAgICAgIGlmIG5hbWUgPT1PT08wTzAwT08wME9PTzAwTyBbMCBdOiNsaW5lOjU1CiAgICAgICAgICAgIHJldHVybiBPT08wTzAwT08wME9PTzAwTyBbMSBdI2xpbmU6NTYKICAgIHJldHVybiBGYWxzZSAjbGluZTo1NwpNT0RFTF9DQUNIRSA9e30jbGluZTo2MQpkZWYgZ2V0X21vZGVsX2luZm8gKG1vZGVsX2FkbWluICxyZXF1ZXN0ICk6I2xpbmU6NjQKICAgIE9PMDAwTzBPME8wMDAwTzAwID1zdHIgKG1vZGVsX2FkbWluICkjbGluZTo2OAogICAgaWYgT08wMDBPME8wTzAwMDBPMDAgaW4gTU9ERUxfQ0FDSEUgOiNsaW5lOjY5CiAgICAgICAgTzAwTzAwTzAwTzBPME8wME8gPU1PREVMX0NBQ0hFIC5nZXQgKE9PMDAwTzBPME8wMDAwTzAwICkjbGluZTo3MAogICAgICAgIHJldHVybiBPMDBPMDBPMDBPME8wTzAwTyAuZ2V0ICgndmFsdWVzX2ZpZWxkcycpLE8wME8wME8wME8wTzBPMDBPIC5nZXQgKCdmdW5fZmllbGRzJyksTzAwTzAwTzAwTzBPME8wME8gLmdldCAoJ2hlYWRlcnMnKSxPMDBPMDBPMDBPME8wTzAwTyAuZ2V0ICgnZm9ybWF0dGVyJyksTzAwTzAwTzAwTzBPME8wME8gLmdldCAoJ2Nob2ljZXMnKSNsaW5lOjcyCiAgICBPT09PT08wT08wT08wT09PMCA9Z2V0X21vZGVsX2ZpZWxkcyAobW9kZWxfYWRtaW4gLm1vZGVsICkjbGluZTo3MwogICAgTzBPTzBPTzBPTzBPMDAwTzAgPW1vZGVsX2FkbWluIC5nZXRfbGlzdF9kaXNwbGF5IChyZXF1ZXN0ICkjbGluZTo3NQogICAgTzAwME9PMDBPMDBPMDBPT08gPVtdI2xpbmU6NzYKICAgIE9PT08wME8wTzBPTzBPTzBPID1bXSNsaW5lOjc3CiAgICBPMDAwMDAwTzBPME8wME8wTyA9W10jbGluZTo3OAogICAgTzBPME9PTzAwT08wME8wME8gPXt9I2xpbmU6ODEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZmllbGRzX29wdGlvbnMnKTojbGluZTo4MgogICAgICAgIE8wTzBPT08wME9PMDBPMDBPID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsJ2ZpZWxkc19vcHRpb25zJykjbGluZTo4MwogICAgZm9yIE8wMDAwT09PT09PME8wTzAwIGluIE8wT08wT08wT08wTzAwME8wIDojbGluZTo4NQogICAgICAgIE9PT09PT08wTzBPMDBPTzBPID1maW5kX2ZpZWxkIChPT09PT08wT08wT08wT09PMCAsTzAwMDBPT09PT08wTzBPMDAgKSNsaW5lOjg2CiAgICAgICAgaWYgT09PT09PTzBPME8wME9PME8gOiNsaW5lOjg3CiAgICAgICAgICAgIE9PT08wME8wTzBPTzBPTzBPIC5hcHBlbmQgKE8wMDAwT09PT09PME8wTzAwICkjbGluZTo4OAogICAgICAgICAgICBPT08wME8wMDAwMDBPT09PMCA9eyduYW1lJzpPMDAwME9PT09PTzBPME8wMCAsJ2xhYmVsJzpPT09PT09PME8wTzAwT08wTyB9I2xpbmU6OTIKICAgICAgICAgICAgaWYgTzAwMDBPT09PT08wTzBPMDAgaW4gTzBPME9PTzAwT08wME8wME8gOiNsaW5lOjkzCiAgICAgICAgICAgICAgICBPT08wME8wMDAwMDBPT09PMCA9ZGljdCAoT09PMDBPMDAwMDAwT09PTzAgLCoqTzBPME9PTzAwT08wME8wME8gLmdldCAoTzAwMDBPT09PT08wTzBPMDAgKSkjbGluZTo5NAogICAgICAgICAgICBpZiAnc29ydGFibGUnbm90IGluIE9PTzAwTzAwMDAwME9PT08wIDojbGluZTo5NgogICAgICAgICAgICAgICAgT09PMDBPMDAwMDAwT09PTzAgWydzb3J0YWJsZSddPSdjdXN0b20nI2xpbmU6OTgKICAgICAgICAgICAgTzAwMDAwME8wTzBPMDBPME8gLmFwcGVuZCAoT09PMDBPMDAwMDAwT09PTzAgKSNsaW5lOjk5CiAgICAgICAgZWxzZSA6I2xpbmU6MTAwCiAgICAgICAgICAgIE8wMDBPTzAwTzAwTzAwT09PIC5hcHBlbmQgKE8wMDAwT09PT09PME8wTzAwICkjbGluZToxMDEKICAgICAgICAgICAgT09PT09PTzBPME8wME9PME8gPU8wMDAwT09PT09PME8wTzAwICNsaW5lOjEwMgogICAgICAgICAgICBpZiBoYXNhdHRyIChtb2RlbF9hZG1pbiAsTzAwMDBPT09PT08wTzBPMDAgKTojbGluZToxMDMKICAgICAgICAgICAgICAgIE8wT09PT09PMDBPME9PME9PID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsTzAwMDBPT09PT08wTzBPMDAgKS5fX2RpY3RfXyAjbGluZToxMDQKICAgICAgICAgICAgZWxzZSA6I2xpbmU6MTA1CiAgICAgICAgICAgICAgICBPME9PT09PTzAwTzBPTzBPTyA9Z2V0YXR0ciAobW9kZWxfYWRtaW4gLm1vZGVsICxPMDAwME9PT09PTzBPME8wMCApLl9fZGljdF9fICNsaW5lOjEwNgogICAgICAgICAgICBpZiAnc2hvcnRfZGVzY3JpcHRpb24naW4gTzBPT09PT08wME8wT08wT08gOiNsaW5lOjEwNwogICAgICAgICAgICAgICAgT09PT09PTzBPME8wME9PME8gPU8wT09PT09PMDBPME9PME9PIC5nZXQgKCdzaG9ydF9kZXNjcmlwdGlvbicpI2xpbmU6MTA4CiAgICAgICAgICAgIGVsaWYgT09PT09PTzBPME8wME9PME8gPT0nX19zdHJfXyc6I2xpbmU6MTA5CiAgICAgICAgICAgICAgICBPT09PT09PME8wTzAwT08wTyA9bW9kZWxfYWRtaW4gLm1vZGVsIC5fbWV0YSAudmVyYm9zZV9uYW1lX3BsdXJhbCAjbGluZToxMTAKICAgICAgICAgICAgT09PMDBPMDAwMDAwT09PTzAgPXsnbmFtZSc6TzAwMDBPT09PT08wTzBPMDAgLCdsYWJlbCc6T09PT09PTzBPME8wME9PME8gfSNsaW5lOjExNAogICAgICAgICAgICBpZiBPMDAwME9PT09PTzBPME8wMCBpbiBPME8wT09PMDBPTzAwTzAwTyA6I2xpbmU6MTE1CiAgICAgICAgICAgICAgICBPT08wME8wMDAwMDBPT09PMCA9ZGljdCAoT09PMDBPMDAwMDAwT09PTzAgLCoqTzBPME9PTzAwT08wME8wME8gLmdldCAoTzAwMDBPT09PT08wTzBPMDAgKSkjbGluZToxMTYKICAgICAgICAgICAgT09PMDBPMDAwMDAwT09PTzAgWydzb3J0YWJsZSddPUZhbHNlICNsaW5lOjExOAogICAgICAgICAgICBPMDAwMDAwTzBPME8wME8wTyAuYXBwZW5kIChPT08wME8wMDAwMDBPT09PMCApI2xpbmU6MTE5CiAgICBPME9PTzAwTzBPMDAwT08wMCA9Tm9uZSAjbGluZToxMjEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJyk6I2xpbmU6MTIyCiAgICAgICAgTzBPT08wME8wTzAwME9PMDAgPWdldGF0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJykjbGluZToxMjMKICAgIE8wTzBPMDBPT08wME8wMDBPID1tb2RlbF9hZG1pbiAubW9kZWwgI2xpbmU6MTI2CiAgICBPMDAwT09PME8wT08wME9PMCA9e30jbGluZToxMjcKICAgIGZvciBPMDBPTzBPTzAwT08wME8wMCBpbiBkaXIgKE8wTzBPMDBPT08wME8wMDBPICk6I2xpbmU6MTI4CiAgICAgICAgaWYgTzAwT08wT08wME9PMDBPMDAgLmVuZHN3aXRoICgnY2hvaWNlcycpOiNsaW5lOjEyOQogICAgICAgICAgICBPTzAwME8wME9PTzBPME9PMCA9e30jbGluZToxMzAKICAgICAgICAgICAgT08wME8wME9PME8wT09PT08gPWdldGF0dHIgKE8wTzBPMDBPT08wME8wMDBPICxPMDBPTzBPTzAwT08wME8wMCApI2xpbmU6MTMxCiAgICAgICAgICAgIGZvciBPMDAwME9PT09PTzBPME8wMCBpbiBPTzAwTzAwT08wTzBPT09PTyA6I2xpbmU6MTMyCiAgICAgICAgICAgICAgICBPTzAwME8wME9PTzBPME9PMCBbTzAwMDBPT09PT08wTzBPMDAgWzAgXV09TzAwMDBPT09PT08wTzBPMDAgWzEgXSNsaW5lOjEzMwogICAgICAgICAgICBPMDAwT09PME8wT08wME9PMCBbTzAwT08wT08wME9PMDBPMDAgXT1PTzAwME8wME9PTzBPME9PMCAjbGluZToxMzQKICAgIGZvciBPMDBPTzBPTzAwT08wME8wMCBpbiBPME8wTzAwT09PMDBPMDAwTyAuX21ldGEgLmZpZWxkcyA6I2xpbmU6MTM1CiAgICAgICAgT08wMDBPMDBPT08wTzBPTzAgPXt9I2xpbmU6MTM2CiAgICAgICAgaWYgaGFzYXR0ciAoTzAwT08wT08wME9PMDBPMDAgLCdjaG9pY2VzJyk6I2xpbmU6MTM3CiAgICAgICAgICAgIGlmIGxlbiAoTzAwT08wT08wME9PMDBPMDAgLmNob2ljZXMgKT4wIDojbGluZToxMzgKICAgICAgICAgICAgICAgIGZvciBPMDAwME9PT09PTzBPME8wMCBpbiBPMDBPTzBPTzAwT08wME8wMCAuY2hvaWNlcyA6I2xpbmU6MTM5CiAgICAgICAgICAgICAgICAgICAgT08wMDBPMDBPT08wTzBPTzAgW08wMDAwT09PT09PME8wTzAwIFswIF1dPU8wMDAwT09PT09PME8wTzAwIFsxIF0jbGluZToxNDAKICAgICAgICAgICAgICAgIE8wMDBPT08wTzBPTzAwT08wIFtPMDBPTzBPTzAwT08wME8wMCAubmFtZSBdPU9PMDAwTzAwT09PME8wT08wICNsaW5lOjE0MQogICAgTU9ERUxfQ0FDSEUgW09PMDAwTzBPME8wMDAwTzAwIF09eyd2YWx1ZXNfZmllbGRzJzpPT09PMDBPME8wT08wT08wTyAsJ2Z1bl9maWVsZHMnOk8wMDBPTzAwTzAwTzAwT09PICwnaGVhZGVycyc6TzAwMDAwME8wTzBPMDBPME8gLCdmb3JtYXR0ZXInOk8wT09PMDBPME8wMDBPTzAwICwnY2hvaWNlcyc6TzAwME9PTzBPME9PMDBPTzAgLH0jbGluZToxNDgKICAgIHJldHVybiBPT09PMDBPME8wT08wT08wTyAsTzAwME9PMDBPMDBPMDBPT08gLE8wMDAwMDBPME8wTzAwTzBPICxPME9PTzAwTzBPMDAwT08wMCAsTzAwME9PTzBPME9PMDBPTzAgI2xpbmU6MTQ5CmRlZiBnZXRfY3VzdG9tX2J1dHRvbiAocmVxdWVzdCAsYWRtaW4gKTojbGluZToxNTIKICAgIE9PMDAwTzBPMDAwME9PT08wID17fSNsaW5lOjE1MwogICAgTzBPMDBPMDAwMDAwMDBPME8gPWFkbWluIC5nZXRfYWN0aW9ucyAocmVxdWVzdCApI2xpbmU6MTU0CiAgICBPME9PTzAwMDAwTzBPMDBPMCA9YWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAjbGluZToxNTkKICAgIGlmIE8wTzAwTzAwMDAwMDAwTzBPIDojbGluZToxNjAKICAgICAgICBPMDBPME9PTzBPTzBPME9PMCA9MCAjbGluZToxNjEKICAgICAgICBmb3IgTzAwMDAwTzBPTzAwTzAwMDAgaW4gTzBPMDBPMDAwMDAwMDBPME8gOiNsaW5lOjE2MgogICAgICAgICAgICBPMDBPTzAwME8wT09PMDAwMCA9e30jbGluZToxNjMKICAgICAgICAgICAgTzAwT08wME8wMDAwME9PT08gPU8wTzAwTzAwMDAwMDAwTzBPIC5nZXQgKE8wMDAwME8wT08wME8wMDAwIClbMCBdI2xpbmU6MTY0CiAgICAgICAgICAgIGZvciBPME8wMDAwTzAwTzBPMDAwMCAsT09PT09PT08wME8wMDBPT08gaW4gTzAwT08wME8wMDAwME9PT08gLl9fZGljdF9fIC5pdGVtcyAoKTojbGluZToxNjUKICAgICAgICAgICAgICAgIGlmIE8wTzAwMDBPMDBPME8wMDAwICE9J19fbGVuX18nYW5kIE8wTzAwMDBPMDBPME8wMDAwICE9J19fd3JhcHBlZF9fJzojbGluZToxNjYKICAgICAgICAgICAgICAgICAgICBPMDBPTzAwME8wT09PMDAwMCBbTzBPMDAwME8wME8wTzAwMDAgXT1PT09PT09PTzAwTzAwME9PTyAjbGluZToxNjcKICAgICAgICAgICAgTzAwT08wMDBPME9PTzAwMDAgWydlaWQnXT1PMDBPME9PTzBPTzBPME9PMCAjbGluZToxNjgKICAgICAgICAgICAgTzAwTzBPT08wT08wTzBPTzAgKz0xICNsaW5lOjE2OQogICAgICAgICAgICBpZiBPMDAwMDBPME9PMDBPMDAwMCA9PSdleHBvcnRfYWRtaW5fYWN0aW9uJzojbGluZToxNzAKICAgICAgICAgICAgICAgIE8wME9PMDAwTzBPT08wMDAwIFsnbGFiZWwnXT0n6YCJ5Lit5a+85Ye6JyNsaW5lOjE3MQogICAgICAgICAgICAgICAgTzAwT08wMDBPME9PTzAwMDAgWydpc0V4cG9ydCddPVRydWUgI2xpbmU6MTcyCiAgICAgICAgICAgICAgICBPMDBPTzAwME8wT09PMDAwMCBbJ2ljb24nXT0nZWwtaWNvbi1maW5pc2hlZCcjbGluZToxNzMKICAgICAgICAgICAgICAgIE8wME9PMDBPMDAwMDBPMDAwID1bXSNsaW5lOjE3NAogICAgICAgICAgICAgICAgZm9yIE8wMDBPT09PMDBPME9PME9PIGluIGVudW1lcmF0ZSAoYWRtaW4gLmdldF9leHBvcnRfZm9ybWF0cyAoKSk6I2xpbmU6MTc1CiAgICAgICAgICAgICAgICAgICAgTzAwT08wME8wMDAwME8wMDAgLmFwcGVuZCAoeyd2YWx1ZSc6TzAwME9PT08wME8wT08wT08gWzAgXSwnbGFiZWwnOk8wMDBPT09PMDBPME9PME9PIFsxIF0oKS5nZXRfdGl0bGUgKCl9KSNsaW5lOjE3OQogICAgICAgICAgICAgICAgTzAwT08wMDBPME9PTzAwMDAgWydmb3JtYXRzJ109TzAwT08wME8wMDAwME8wMDAgI2xpbmU6MTgxCiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjE4MgogICAgICAgICAgICAgICAgTzAwT08wMDBPME9PTzAwMDAgWydsYWJlbCddPU8wTzAwTzAwMDAwMDAwTzBPIC5nZXQgKE8wMDAwME8wT08wME8wMDAwIClbMiBdI2xpbmU6MTgzCiAgICAgICAgICAgIGlmIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtICgne30ue30nLmZvcm1hdCAoTzBPT08wMDAwME8wTzAwTzAgLE8wMDAwME8wT08wME8wMDAwICkpOiNsaW5lOjE4NgogICAgICAgICAgICAgICAgT08wMDBPME8wMDAwT09PTzAgW08wMDAwME8wT08wME8wMDAwIF09TzAwT08wMDBPME9PTzAwMDAgI2xpbmU6MTg3CiAgICBpZiAnZGVsZXRlX3NlbGVjdGVkJ2luIE9PMDAwTzBPMDAwME9PT08wIDojbGluZToxODgKICAgICAgICBkZWwgT08wMDBPME8wMDAwT09PTzAgWydkZWxldGVfc2VsZWN0ZWQnXSNsaW5lOjE4OQogICAgcmV0dXJuIE9PMDAwTzBPMDAwME9PT08wICNsaW5lOjE5MApkZWYgc2VhcmNoX3BsYWNlaG9sZGVyIChjbCApOiNsaW5lOjE5MwogICAgTzBPTzAwTzBPMDBPME8wTzAgPWdldF9tb2RlbF9maWVsZHMgKGNsIC5tb2RlbCApI2xpbmU6MTk1CiAgICBmb3IgT08wMDBPMDBPMDAwME8wME8gaW4gY2wgLm1vZGVsIC5fbWV0YSAuZmllbGRzIDojbGluZToxOTcKICAgICAgICBpZiBpc2luc3RhbmNlIChPTzAwME8wME8wMDAwTzAwTyAsRm9yZWlnbktleSApOiNsaW5lOjE5OAogICAgICAgICAgICBPME9PMDBPME8wME8wTzBPMCAuZXh0ZW5kIChnZXRfbW9kZWxfZmllbGRzIChPTzAwME8wME8wMDAwTzAwTyAucmVsYXRlZF9tb2RlbCAsT08wMDBPMDBPMDAwME8wME8gLm5hbWUgKSkjbGluZToxOTkKICAgIE8wT08wTzBPTzAwT09PTzBPID1bXSNsaW5lOjIwMQogICAgZm9yIE8wMDBPTzAwMDAwME9PMDAwIGluIGNsIC5zZWFyY2hfZmllbGRzIDojbGluZToyMDMKICAgICAgICBmb3IgT08wMDBPMDBPMDAwME8wME8gaW4gTzBPTzAwTzBPMDBPME8wTzAgOiNsaW5lOjIwNAogICAgICAgICAgICBpZiBPTzAwME8wME8wMDAwTzAwTyBbMCBdPT1PMDAwT08wMDAwMDBPTzAwMCA6I2xpbmU6MjA1CiAgICAgICAgICAgICAgICBPME9PME8wT08wME9PT08wTyAuYXBwZW5kIChPTzAwME8wME8wMDAwTzAwTyBbMSBdKSNsaW5lOjIwNgogICAgICAgICAgICAgICAgYnJlYWsgI2xpbmU6MjA3CiAgICByZXR1cm4gIiwiLmpvaW4gKE8wT08wTzBPTzAwT09PTzBPICkjbGluZToyMDkKZGVmIHdyaXRlIChkYXRhICxPTzBPT09PMDAwTzBPT08wTyA9J29rJyxPT08wTzBPT09PT08wME8wMCA9VHJ1ZSApOiNsaW5lOjIxMgogICAgTzAwTzBPME9PTzAwT09PT08gPXsnc3RhdGUnOk9PTzBPME9PT09PTzAwTzAwICwnbXNnJzpPTzBPT09PMDAwTzBPT08wTyAsJ2RhdGEnOmRhdGEgfSNsaW5lOjIxNwogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKE8wME8wTzBPT08wME9PT09PICxjbHMgPUxhenlFbmNvZGVyICksY29udGVudF90eXBlID0nYXBwbGljYXRpb24vanNvbicpI2xpbmU6MjE5CmRlZiB3cml0ZV9vYmogKG9iaiApOiNsaW5lOjIyMgogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKG9iaiAsY2xzID1MYXp5RW5jb2RlciApLGNvbnRlbnRfdHlwZSA9J2FwcGxpY2F0aW9uL2pzb24nKSNsaW5lOjIyMwpkZWYgaGFzX3Blcm1pc3Npb24gKHJlcXVlc3QgLGFkbWluICxwZXJtaXNzaW9uICk6I2xpbmU6MjI2CiAgICBPME9PTzBPME8wT09PME9PMCA9Z2V0X3Blcm1pc3Npb25fY29kZW5hbWUgKHBlcm1pc3Npb24gLGFkbWluIC5vcHRzICkjbGluZToyMjcKICAgIE8wME9PME9PME8wMDAwTzAwID0ne30ue30nLmZvcm1hdCAoYWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAsTzBPT08wTzBPME9PTzBPTzAgKSNsaW5lOjIyOAogICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChPMDBPTzBPTzBPMDAwME8wMCApI2xpbmU6MjI5CmRlZiBnZXRfcGVybWlzc2lvbl9jb2RlbmFtZSAoYWN0aW9uICxvcHRzICk6I2xpbmU6MjMyCiAgICAiIiNsaW5lOjIzNQogICAgcmV0dXJuICclc18lcyclKGFjdGlvbiAsb3B0cyAubW9kZWxfbmFtZSApI2xpbmU6MjM2CmZyb20gc2ltcGxldWkgLnRlbXBsYXRldGFncyBpbXBvcnQgc2ltcGxldGFncyAjbGluZToyMzkKZnJvbSBzaW1wbGV1aSAudGVtcGxhdGV0YWdzIC5zaW1wbGV0YWdzIGltcG9ydCBnZXRfY29uZmlnICNsaW5lOjI0MApkZWYgZ2V0X21lbnVzIChyZXF1ZXN0ICxhZG1pbl9zaXRlICk6I2xpbmU6MjQzCiAgICAiIiNsaW5lOjI0OQogICAgTzBPME8wT08wTzAwTzBPTzAgPXsnYXBwX2xpc3QnOmFkbWluX3NpdGUgLmdldF9hcHBfbGlzdCAocmVxdWVzdCApLCdyZXF1ZXN0JzpyZXF1ZXN0IH0jbGluZToyNTMKICAgIGRlZiBPT09PTzBPT09PMDBPME8wMCAoa2V5ICk6I2xpbmU6MjU1CiAgICAgICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChrZXkgKSNsaW5lOjI1NgogICAgZGVmIF9PME9PMDBPT09PT09PME8wTyAoa2V5ICk6I2xpbmU6MjU4CiAgICAgICAgaWYga2V5ID09J1NJTVBMRVVJX0NPTkZJRyc6I2xpbmU6MjU5CiAgICAgICAgICAgIF9PME8wT08wME9PME9PTzAwTyA9Z2V0X2NvbmZpZyAoa2V5ICkjbGluZToyNjEKICAgICAgICAgICAgaWYgX08wTzBPTzAwT08wT09PMDBPIGFuZCAnbWVudXMnaW4gX08wTzBPTzAwT08wT09PMDBPIDojbGluZToyNjIKICAgICAgICAgICAgICAgIE8wTzAwTzBPMDAwT08wT08wID1fTzBPME9PMDBPTzBPT08wME8gLmdldCAoJ21lbnVzJykjbGluZToyNjMKICAgICAgICAgICAgICAgIE8wMDAwT09PME9PME9PT08wID1bXSNsaW5lOjI2NAogICAgICAgICAgICAgICAgZm9yIE8wTzBPTzBPTzBPMDBPME8wIGluIE8wTzAwTzBPMDAwT08wT08wIDojbGluZToyNjYKICAgICAgICAgICAgICAgICAgICBpZiAnY29kZW5hbWUnbm90IGluIE8wTzBPTzBPTzBPMDBPME8wIDojbGluZToyNjcKICAgICAgICAgICAgICAgICAgICAgICAgTzAwMDBPT08wT08wT09PTzAgLmFwcGVuZCAoTzBPME9PME9PME8wME8wTzAgKSNsaW5lOjI2OAogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSAjbGluZToyNjkKICAgICAgICAgICAgICAgICAgICBPMDAwTzBPME8wMDAwTzAwMCA9TzBPME9PME9PME8wME8wTzAgLmdldCAoJ2NvZGVuYW1lJykjbGluZToyNzAKICAgICAgICAgICAgICAgICAgICBrZXkgPSd7fS57fScuZm9ybWF0IChPMDAwTzBPME8wMDAwTzAwMCAsTzAwME8wTzBPMDAwME8wMDAgKSNsaW5lOjI3MwogICAgICAgICAgICAgICAgICAgIGlmIE9PT09PME9PT08wME8wTzAwIChrZXkgKTojbGluZToyNzQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21vZGVscydpbiBPME8wT08wT08wTzAwTzBPMCA6I2xpbmU6Mjc2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPME8wMDAwMDAwMDBPMDBPTyA9TzBPME9PME9PME8wME8wTzAgLmdldCAoJ21vZGVscycpI2xpbmU6Mjc3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPMDBPTzAwMDBPME8wT09PTyA9W10jbGluZToyNzgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBPME9PME9PME8wT09PMDBPTyBpbiBPME8wMDAwMDAwMDBPMDBPTyA6I2xpbmU6Mjc5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2NvZGVuYW1lJ2luIE8wT08wT08wTzBPT08wME9PIDojbGluZToyODAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgT09PT08wT09PTzAwTzBPMDAgKCd7fS57fScuZm9ybWF0IChPMDAwTzBPME8wMDAwTzAwMCAsTzBPTzBPTzBPME9PTzAwT08gLmdldCAoJ2NvZGVuYW1lJykpKTojbGluZToyODEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE8wME9PMDAwME8wTzBPT09PIC5hcHBlbmQgKE8wT08wT08wTzBPT08wME9PICkjbGluZToyODIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIDojbGluZToyODMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTzAwT08wMDAwTzBPME9PT08gLmFwcGVuZCAoTzBPTzBPTzBPME9PTzAwT08gKSNsaW5lOjI4NAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTzBPME9PME9PME8wME8wTzAgWydtb2RlbHMnXT1PMDBPTzAwMDBPME8wT09PTyAjbGluZToyODUKICAgICAgICAgICAgICAgICAgICAgICAgTzAwMDBPT08wT08wT09PTzAgLmFwcGVuZCAoTzBPME9PME9PME8wME8wTzAgKSNsaW5lOjI4NwogICAgICAgICAgICAgICAgX08wTzBPTzAwT08wT09PMDBPIFsnbWVudXMnXT1PMDAwME9PTzBPTzBPT09PMCAjbGluZToyODgKICAgICAgICByZXR1cm4gX08wTzBPTzAwT08wT09PMDBPICNsaW5lOjI5MAogICAgcmV0dXJuIHNpbXBsZXRhZ3MgLm1lbnVzIChPME8wTzBPTzBPMDBPME9PMCAsX2dldF9jb25maWcgPV9PME9PMDBPT09PT09PME8wTyApI2xpbmU6MjkyCg=='))