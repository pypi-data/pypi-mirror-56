import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6MQppbXBvcnQgb3MgI2xpbmU6Mgpmcm9tIGRqYW5nbyAuY29udHJpYiAuYXV0aCAubW9kZWxzIGltcG9ydCBQZXJtaXNzaW9uICxHcm91cCAjbGluZTo0CmZyb20gZGphbmdvIC5zaG9ydGN1dHMgaW1wb3J0IHJlbmRlciAjbGluZTo1CmZyb20gLnV0aWxzIGltcG9ydCBnZXRfcGVybWlzc2lvbnMgI2xpbmU6Ngpmcm9tIHNpbXBsZXBybyAudXRpbHMgaW1wb3J0IHdyaXRlICx3cml0ZV9vYmogI2xpbmU6Nwpmcm9tIHNpbXBsZXBybyBpbXBvcnQgY29uZiAjbGluZTo4CmltcG9ydCByZXF1ZXN0cyAjbGluZTo5CmltcG9ydCBzdHJ1Y3QgI2xpbmU6MTAKZGVmIGFjdGlvbiAocmVxdWVzdCApOiNsaW5lOjEzCiAgICBPMDBPME8wMDAwTzBPT09PTyA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnYWN0aW9uJykjbGluZToxNAogICAgTzBPTzBPTzBPTzAwTzBPMDAgPXsndHJlZSc6Z2V0X3RyZWUgLCdzYXZlJzpzYXZlICwnZ2V0X2RldGFpbCc6Z2V0X2RldGFpbCB9I2xpbmU6MjAKICAgIHJldHVybiBPME9PME9PME9PMDBPME8wMCAuZ2V0IChPMDBPME8wMDAwTzBPT09PTyApKHJlcXVlc3QgKSNsaW5lOjIyCmRlZiBnZXRfZGV0YWlsIChyZXF1ZXN0ICk6I2xpbmU6MjUKICAgIE9PT09PT09PT08wT08wMDBPID1yZXF1ZXN0IC5QT1NUIC5nZXQgKCdpZCcpI2xpbmU6MjYKICAgIE8wMDAwTzAwMDAwTzBPT09PID1Hcm91cCAub2JqZWN0cyAuZmlsdGVyIChpZCA9T09PT09PT09PTzBPTzAwME8gKS5maXJzdCAoKSNsaW5lOjI3CiAgICBPMDAwT08wT08wME8wTzBPTyA9W10jbGluZToyOAogICAgaWYgTzAwMDBPMDAwMDBPME9PT08gOiNsaW5lOjI5CiAgICAgICAgTzAwMDAwMDAwMDBPT09PTzAgPU8wMDAwTzAwMDAwTzBPT09PIC5wZXJtaXNzaW9ucyAuYWxsICgpI2xpbmU6MzAKICAgICAgICBmb3IgTzBPT08wTzBPT09PTzAwTzAgaW4gTzAwMDAwMDAwMDBPT09PTzAgOiNsaW5lOjMxCiAgICAgICAgICAgIE8wMDBPTzBPTzAwTzBPME9PIC5hcHBlbmQgKE8wT09PME8wT09PT08wME8wIC5pZCApI2xpbmU6MzIKICAgIHJldHVybiB3cml0ZSAoTzAwME9PME9PMDBPME8wT08gKSNsaW5lOjM0CmRlZiBzYXZlIChyZXF1ZXN0ICk6I2xpbmU6MzcKICAgIE9PT08wMDBPT09PT09PTzBPID1UcnVlICNsaW5lOjM4CiAgICBPTzBPMDBPMDBPT08wT09PMCA9Im9rIiNsaW5lOjM5CiAgICB0cnkgOiNsaW5lOjQwCiAgICAgICAgTzBPTzAwT08wTzBPTzAwMDAgPXJlcXVlc3QgLlBPU1QgLmdldCAoJ25hbWUnKSNsaW5lOjQxCiAgICAgICAgTzBPTzAwMDBPME9PME9PTzAgPXJlcXVlc3QgLlBPU1QgLmdldCAoJ2lkcycpI2xpbmU6NDIKICAgICAgICBPTzBPMDAwTzBPTzAwME8wTyA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnaWQnKSNsaW5lOjQzCiAgICAgICAgaWYgT08wTzAwME8wT08wMDBPME8gYW5kIE9PME8wMDBPME9PMDAwTzBPICE9Jyc6I2xpbmU6NDYKICAgICAgICAgICAgT09PME9PT09PT08wTzAwMDAgPUdyb3VwIC5vYmplY3RzIC5nZXQgKGlkID1PTzBPMDAwTzBPTzAwME8wTyApI2xpbmU6NDcKICAgICAgICAgICAgT09PME9PT09PT08wTzAwMDAgLnBlcm1pc3Npb25zIC5jbGVhciAoKSNsaW5lOjQ5CiAgICAgICAgZWxzZSA6I2xpbmU6NTAKICAgICAgICAgICAgT09PME9PT09PT08wTzAwMDAgPUdyb3VwIC5vYmplY3RzIC5jcmVhdGUgKG5hbWUgPU8wT08wME9PME8wT08wMDAwICkjbGluZTo1MQogICAgICAgIGlmIE8wT08wMDAwTzBPTzBPT08wIGFuZCBPME9PMDAwME8wT08wT09PMCAhPScnOiNsaW5lOjUyCiAgICAgICAgICAgIE8wT08wMDAwTzBPTzBPT08wID1PME9PMDAwME8wT08wT09PMCAuc3BsaXQgKCcsJykjbGluZTo1MwogICAgICAgICAgICBmb3IgTzBPME9PTzAwME9PMDAwMDAgaW4gTzBPTzAwMDBPME9PME9PTzAgOiNsaW5lOjU0CiAgICAgICAgICAgICAgICBPT08wT09PT09PTzBPMDAwMCAucGVybWlzc2lvbnMgLmFkZCAoTzBPME9PTzAwME9PMDAwMDAgKSNsaW5lOjU2CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE9PME9PME8wTzBPTzAwT09PIDojbGluZTo1NwogICAgICAgIE9PT08wMDBPT09PT09PTzBPID1GYWxzZSAjbGluZTo1OAogICAgICAgIE9PME8wME8wME9PTzBPT08wID1PTzBPTzBPME8wT08wME9PTyAuYXJncyBbMCBdI2xpbmU6NTkKICAgIHJldHVybiB3cml0ZSAoTm9uZSAsT08wTzAwTzAwT09PME9PTzAgLE9PT08wMDBPT09PT09PTzBPICkjbGluZTo2MApkZWYgZ2V0X3RyZWUgKHJlcXVlc3QgKTojbGluZTo2MwogICAgIiIjbGluZTo2OAogICAgTzBPMDBPMDAwMDAwME8wTzAgPWdldF9wZXJtaXNzaW9ucyAoKSNsaW5lOjY5CiAgICByZXR1cm4gd3JpdGUgKE8wTzAwTzAwMDAwMDBPME8wICkjbGluZTo3MAo='))