import base64
exec(base64.b64decode(b'ZnJvbSBkamFuZ28gLmNvbnRyaWIgLmF1dGggLm1vZGVscyBpbXBvcnQgUGVybWlzc2lvbiAjbGluZToxCmRlZiBnZXRfYWN0aW9uX25hbWUgKG5hbWUgKTojbGluZTo0CiAgICAiIiNsaW5lOjkKICAgIG5hbWUgPW5hbWUgLnJlcGxhY2UgKCdDYW4gYWRkICcsJ+WinuWKoCcpLnJlcGxhY2UgKCdDYW4gY2hhbmdlICcsJ+e8lui+kScpLnJlcGxhY2UgKCdDYW4gZGVsZXRlICcsJ+WIoOmZpCcpLnJlcGxhY2UgKCdDYW4gdmlldyAnLCfmn6XnnIsnKSNsaW5lOjExCiAgICByZXR1cm4gbmFtZSAjbGluZToxMgpkZWYgZ2V0X3Blcm1pc3Npb25zICgpOiNsaW5lOjE1CiAgICAiIiNsaW5lOjE5CiAgICBPT08wT09PTzAwME9PME9PMCA9UGVybWlzc2lvbiAub2JqZWN0cyAuYWxsICgpI2xpbmU6MjAKICAgIE8wMDAwTzAwME8wME9PMDBPID17fSNsaW5lOjIzCiAgICBmb3IgTzBPT09PTzAwMDAwT08wT08gaW4gT09PME9PT08wMDBPTzBPTzAgOiNsaW5lOjI1CiAgICAgICAgT09PTzAwMDBPT08wT08wME8gPU8wT09PT08wMDAwME9PME9PIC5jb250ZW50X3R5cGUgLmFwcF9sYWJlbCAjbGluZToyNgogICAgICAgIGlmIE9PT08wMDAwT09PME9PMDBPIG5vdCBpbiBPMDAwME8wMDBPMDBPTzAwTyA6I2xpbmU6MjcKICAgICAgICAgICAgTzAwMDBPMDAwTzAwT08wME8gW09PT08wMDAwT09PME9PMDBPIF09eydsYWJlbCc6T09PTzAwMDBPT08wT08wME8gLCdjaGlsZHJlbic6W08wT09PT08wMDAwME9PME9PIF19I2xpbmU6MzEKICAgICAgICBlbHNlIDojbGluZTozMgogICAgICAgICAgICBPME8wT09PME8wT09PMDAwMCA9TzAwMDBPMDAwTzAwT08wME8gLmdldCAoT09PTzAwMDBPT08wT08wME8gKSNsaW5lOjMzCiAgICAgICAgICAgIE9PME8wTzBPT08wT08wME9PID1PME8wT09PME8wT09PMDAwMCAuZ2V0ICgnY2hpbGRyZW4nKSNsaW5lOjM0CiAgICAgICAgICAgIE9PME8wTzBPT08wT08wME9PIC5hcHBlbmQgKE8wT09PT08wMDAwME9PME9PICkjbGluZTozNQogICAgZm9yIE9PMDAwMDBPME8wMDBPT08wIGluIE8wMDAwTzAwME8wME9PMDBPIDojbGluZTo0MAogICAgICAgIE8wT09PT08wMDAwME9PME9PID1PMDAwME8wMDBPMDBPTzAwTyAuZ2V0IChPTzAwMDAwTzBPMDAwT09PMCApI2xpbmU6NDEKICAgICAgICBPTzBPME8wT09PME9PMDBPTyA9TzBPT09PTzAwMDAwT08wT08gLmdldCAoJ2NoaWxkcmVuJykjbGluZTo0MgogICAgICAgIE8wMDAwMDBPTzAwT09PMDAwID17fSNsaW5lOjQ1CiAgICAgICAgZm9yIE9PT08wTzAwTzBPME9PMDBPIGluIE9PME8wTzBPT08wT08wME9PIDojbGluZTo0NgogICAgICAgICAgICBPT09PMDAwME9PTzBPTzAwTyA9T09PTzBPMDBPME8wT08wME8gLmNvbnRlbnRfdHlwZSAubmFtZSAjbGluZTo0OAogICAgICAgICAgICBpZiBPT09PMDAwME9PTzBPTzAwTyBub3QgaW4gTzAwMDAwME9PMDBPT08wMDAgOiNsaW5lOjQ5CiAgICAgICAgICAgICAgICBPMDAwMDAwT08wME9PTzAwMCBbT09PTzAwMDBPT08wT08wME8gXT17J2xhYmVsJzpPT09PMDAwME9PTzBPTzAwTyAsJ2NoaWxkcmVuJzpbeydpZCc6T09PTzBPMDBPME8wT08wME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT09PTzBPMDBPME8wT08wME8gLm5hbWUgKX1dfSNsaW5lOjU2CiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjU3CiAgICAgICAgICAgICAgICBPMDAwMDAwT08wME9PTzAwMCBbT09PTzAwMDBPT08wT08wME8gXS5nZXQgKCdjaGlsZHJlbicpLmFwcGVuZCAoeydpZCc6T09PTzBPMDBPME8wT08wME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT09PTzBPMDBPME8wT08wME8gLm5hbWUgKX0pI2xpbmU6NjEKICAgICAgICBPTzBPME9PME9PTzAwMDAwTyA9W10jbGluZTo2MgogICAgICAgIGZvciBPT09PME8wME8wTzBPTzAwTyBpbiBPMDAwMDAwT08wME9PTzAwMCA6I2xpbmU6NjMKICAgICAgICAgICAgT08wTzBPTzBPT08wMDAwME8gLmFwcGVuZCAoTzAwMDAwME9PMDBPT08wMDAgLmdldCAoT09PTzBPMDBPME8wT08wME8gKSkjbGluZTo2NAogICAgICAgIE8wT09PT08wMDAwME9PME9PIFsnY2hpbGRyZW4nXT1PTzBPME9PME9PTzAwMDAwTyAjbGluZTo2NQogICAgTzAwMDAwMDBPME9PMDBPME8gPVtdI2xpbmU6NjcKICAgIGZvciBPT09PME8wME8wTzBPTzAwTyBpbiBPMDAwME8wMDBPMDBPTzAwTyA6I2xpbmU6NjgKICAgICAgICBPMDAwMDAwME8wT08wME8wTyAuYXBwZW5kIChPMDAwME8wMDBPMDBPTzAwTyAuZ2V0IChPT09PME8wME8wTzBPTzAwTyApKSNsaW5lOjY5CiAgICByZXR1cm4gTzAwMDAwMDBPME9PMDBPME8gI2xpbmU6NzEK'))