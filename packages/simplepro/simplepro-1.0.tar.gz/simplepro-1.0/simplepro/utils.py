import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6MQpmcm9tIGRqYW5nbyAuY29yZSAuc2VyaWFsaXplcnMgLmpzb24gaW1wb3J0IERqYW5nb0pTT05FbmNvZGVyICNsaW5lOjMKZnJvbSBkamFuZ28gLmRiIC5tb2RlbHMgaW1wb3J0IEZvcmVpZ25LZXkgI2xpbmU6NApmcm9tIGRqYW5nbyAuaHR0cCBpbXBvcnQgSHR0cFJlc3BvbnNlICNsaW5lOjUKZnJvbSBkamFuZ28gLnV0aWxzIC5lbmNvZGluZyBpbXBvcnQgZm9yY2VfdGV4dCAjbGluZTo2CmZyb20gZGphbmdvIC51dGlscyAuZnVuY3Rpb25hbCBpbXBvcnQgUHJvbWlzZSAjbGluZTo3CmltcG9ydCBkYXRldGltZSAjbGluZTo5CmNsYXNzIExhenlFbmNvZGVyIChEamFuZ29KU09ORW5jb2RlciApOiNsaW5lOjEyCiAgICAiIiNsaW5lOjE1CiAgICBkZWYgZGVmYXVsdCAoc2VsZiAsb2JqICk6I2xpbmU6MTcKICAgICAgICBpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRldGltZSApOiNsaW5lOjE4CiAgICAgICAgICAgIHJldHVybiBvYmogLnN0cmZ0aW1lICgiJVktJW0tJWQgJUg6JU06JVMiKSNsaW5lOjE5CiAgICAgICAgZWxpZiBpc2luc3RhbmNlIChvYmogLGRhdGV0aW1lIC5kYXRlICk6I2xpbmU6MjAKICAgICAgICAgICAgcmV0dXJuIG9iaiAuc3RyZnRpbWUgKCIlWS0lbS0lZCIpI2xpbmU6MjEKICAgICAgICBlbGlmIGlzaW5zdGFuY2UgKG9iaiAsUHJvbWlzZSApOiNsaW5lOjIyCiAgICAgICAgICAgIHJldHVybiBmb3JjZV90ZXh0IChvYmogKSNsaW5lOjIzCiAgICAgICAgcmV0dXJuIHN0ciAob2JqICkjbGluZToyNApkZWYgZ2V0X21vZGVsX2ZpZWxkcyAobW9kZWwgLE9PT09PT09PTzBPTzBPMDBPID1Ob25lICk6I2xpbmU6MjgKICAgICIiI2xpbmU6MzQKICAgIE8wMDBPTzBPMDBPME8wMDBPID1bXSNsaW5lOjM1CiAgICBPT08wMDAwTzAwME8wT09PTyA9bW9kZWwgLl9tZXRhIC5maWVsZHMgI2xpbmU6MzYKICAgIGZvciBPTzAwME8wTzAwT08wMDAwTyBpbiBPT08wMDAwTzAwME8wT09PTyA6I2xpbmU6MzcKICAgICAgICBPTzBPT09PTzBPMDAwMDBPTyA9T08wMDBPME8wME9PMDAwME8gLm5hbWUgI2xpbmU6MzgKICAgICAgICBpZiBoYXNhdHRyIChPTzAwME8wTzAwT08wMDAwTyAsJ3ZlcmJvc2VfbmFtZScpOiNsaW5lOjM5CiAgICAgICAgICAgIE9PME9PT09PME8wMDAwME9PID1nZXRhdHRyIChPTzAwME8wTzAwT08wMDAwTyAsJ3ZlcmJvc2VfbmFtZScpI2xpbmU6NDAKICAgICAgICBpZiBpc2luc3RhbmNlIChPTzBPT09PTzBPMDAwMDBPTyAsUHJvbWlzZSApOiNsaW5lOjQyCiAgICAgICAgICAgIE9PME9PT09PME8wMDAwME9PID1zdHIgKE9PME9PT09PME8wMDAwME9PICkjbGluZTo0MwogICAgICAgIGlmIE9PT09PT09PTzBPTzBPMDBPIDojbGluZTo0NQogICAgICAgICAgICBPMDAwT08wTzAwTzBPMDAwTyAuYXBwZW5kICgoJ3t9X197fScuZm9ybWF0IChPT09PT09PT08wT08wTzAwTyAsT08wMDBPME8wME9PMDAwME8gLm5hbWUgKSxPTzBPT09PTzBPMDAwMDBPTyApKSNsaW5lOjQ2CiAgICAgICAgZWxzZSA6I2xpbmU6NDcKICAgICAgICAgICAgTzAwME9PME8wME8wTzAwME8gLmFwcGVuZCAoKE9PMDAwTzBPMDBPTzAwMDBPIC5uYW1lICxPTzBPT09PTzBPMDAwMDBPTyApKSNsaW5lOjQ4CiAgICByZXR1cm4gTzAwME9PME8wME8wTzAwME8gI2xpbmU6NTAKZGVmIGZpbmRfZmllbGQgKGZpZWxkcyAsbmFtZSApOiNsaW5lOjUzCiAgICBmb3IgTzAwT09PT09PTzBPME8wTzAgaW4gZmllbGRzIDojbGluZTo1NAogICAgICAgIGlmIG5hbWUgPT1PMDBPT09PT09PME8wTzBPMCBbMCBdOiNsaW5lOjU1CiAgICAgICAgICAgIHJldHVybiBPMDBPT09PT09PME8wTzBPMCBbMSBdI2xpbmU6NTYKICAgIHJldHVybiBGYWxzZSAjbGluZTo1NwpNT0RFTF9DQUNIRSA9e30jbGluZTo2MQpkZWYgZ2V0X21vZGVsX2luZm8gKG1vZGVsX2FkbWluICxyZXF1ZXN0ICk6I2xpbmU6NjQKICAgIE8wTzBPTzAwT08wT08wME9PID1zdHIgKG1vZGVsX2FkbWluICkjbGluZTo2OAogICAgaWYgTzBPME9PMDBPTzBPTzAwT08gaW4gTU9ERUxfQ0FDSEUgOiNsaW5lOjY5CiAgICAgICAgT09PTzBPT08wT09PMDBPMDAgPU1PREVMX0NBQ0hFIC5nZXQgKE8wTzBPTzAwT08wT08wME9PICkjbGluZTo3MAogICAgICAgIHJldHVybiBPT09PME9PTzBPT08wME8wMCAuZ2V0ICgndmFsdWVzX2ZpZWxkcycpLE9PT08wT09PME9PTzAwTzAwIC5nZXQgKCdmdW5fZmllbGRzJyksT09PTzBPT08wT09PMDBPMDAgLmdldCAoJ2hlYWRlcnMnKSxPT09PME9PTzBPT08wME8wMCAuZ2V0ICgnZm9ybWF0dGVyJyksT09PTzBPT08wT09PMDBPMDAgLmdldCAoJ2Nob2ljZXMnKSNsaW5lOjcyCiAgICBPME9PT09PTzAwMDAwME8wTyA9Z2V0X21vZGVsX2ZpZWxkcyAobW9kZWxfYWRtaW4gLm1vZGVsICkjbGluZTo3MwogICAgT08wMDBPTzAwME9PT08wMDAgPW1vZGVsX2FkbWluIC5nZXRfbGlzdF9kaXNwbGF5IChyZXF1ZXN0ICkjbGluZTo3NQogICAgT09PMDAwT08wMDAwTzAwME8gPVtdI2xpbmU6NzYKICAgIE8wME8wT08wTzBPME9PME9PID1bXSNsaW5lOjc3CiAgICBPTzBPME9PMDAwME8wME8wTyA9W10jbGluZTo3OAogICAgT09PME9PMDBPTzAwME8wTzAgPXt9I2xpbmU6ODEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZmllbGRzX29wdGlvbnMnKTojbGluZTo4MgogICAgICAgIE9PTzBPTzAwT08wMDBPME8wID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsJ2ZpZWxkc19vcHRpb25zJykjbGluZTo4MwogICAgZm9yIE8wMDAwMDBPT09PT08wT09PIGluIE9PMDAwT08wMDBPT09PMDAwIDojbGluZTo4NQogICAgICAgIE8wT09PT09PMDBPT09PMDBPID1maW5kX2ZpZWxkIChPME9PT09PTzAwMDAwME8wTyAsTzAwMDAwME9PT09PTzBPT08gKSNsaW5lOjg2CiAgICAgICAgaWYgTzBPT09PT08wME9PT08wME8gOiNsaW5lOjg3CiAgICAgICAgICAgIE8wME8wT08wTzBPME9PME9PIC5hcHBlbmQgKE8wMDAwMDBPT09PT08wT09PICkjbGluZTo4OAogICAgICAgICAgICBPME9PME9PMDBPMDBPT08wTyA9eyduYW1lJzpPMDAwMDAwT09PT09PME9PTyAsJ2xhYmVsJzpPME9PT09PTzAwT09PTzAwTyB9I2xpbmU6OTIKICAgICAgICAgICAgaWYgTzAwMDAwME9PT09PTzBPT08gaW4gT09PME9PMDBPTzAwME8wTzAgOiNsaW5lOjkzCiAgICAgICAgICAgICAgICBPME9PME9PMDBPMDBPT08wTyA9ZGljdCAoTzBPTzBPTzAwTzAwT09PME8gLCoqT09PME9PMDBPTzAwME8wTzAgLmdldCAoTzAwMDAwME9PT09PTzBPT08gKSkjbGluZTo5NAogICAgICAgICAgICBpZiAnc29ydGFibGUnbm90IGluIE8wT08wT08wME8wME9PTzBPIDojbGluZTo5NgogICAgICAgICAgICAgICAgTzBPTzBPTzAwTzAwT09PME8gWydzb3J0YWJsZSddPSdjdXN0b20nI2xpbmU6OTgKICAgICAgICAgICAgT08wTzBPTzAwMDBPMDBPME8gLmFwcGVuZCAoTzBPTzBPTzAwTzAwT09PME8gKSNsaW5lOjk5CiAgICAgICAgZWxzZSA6I2xpbmU6MTAwCiAgICAgICAgICAgIE9PTzAwME9PMDAwME8wMDBPIC5hcHBlbmQgKE8wMDAwMDBPT09PT08wT09PICkjbGluZToxMDEKICAgICAgICAgICAgTzBPT09PT08wME9PT08wME8gPU8wMDAwMDBPT09PT08wT09PICNsaW5lOjEwMgogICAgICAgICAgICBpZiBoYXNhdHRyIChtb2RlbF9hZG1pbiAsTzAwMDAwME9PT09PTzBPT08gKTojbGluZToxMDMKICAgICAgICAgICAgICAgIE9PME8wT08wMDBPT08wT09PID1nZXRhdHRyIChtb2RlbF9hZG1pbiAsTzAwMDAwME9PT09PTzBPT08gKS5fX2RpY3RfXyAjbGluZToxMDQKICAgICAgICAgICAgZWxzZSA6I2xpbmU6MTA1CiAgICAgICAgICAgICAgICBPTzBPME9PMDAwT09PME9PTyA9Z2V0YXR0ciAobW9kZWxfYWRtaW4gLm1vZGVsICxPMDAwMDAwT09PT09PME9PTyApLl9fZGljdF9fICNsaW5lOjEwNgogICAgICAgICAgICBpZiAnc2hvcnRfZGVzY3JpcHRpb24naW4gT08wTzBPTzAwME9PTzBPT08gOiNsaW5lOjEwNwogICAgICAgICAgICAgICAgTzBPT09PT08wME9PT08wME8gPU9PME8wT08wMDBPT08wT09PIC5nZXQgKCdzaG9ydF9kZXNjcmlwdGlvbicpI2xpbmU6MTA4CiAgICAgICAgICAgIGVsaWYgTzBPT09PT08wME9PT08wME8gPT0nX19zdHJfXyc6I2xpbmU6MTA5CiAgICAgICAgICAgICAgICBPME9PT09PTzAwT09PTzAwTyA9bW9kZWxfYWRtaW4gLm1vZGVsIC5fbWV0YSAudmVyYm9zZV9uYW1lX3BsdXJhbCAjbGluZToxMTAKICAgICAgICAgICAgTzBPTzBPTzAwTzAwT09PME8gPXsnbmFtZSc6TzAwMDAwME9PT09PTzBPT08gLCdsYWJlbCc6TzBPT09PT08wME9PT08wME8gfSNsaW5lOjExNAogICAgICAgICAgICBpZiBPMDAwMDAwT09PT09PME9PTyBpbiBPT08wT08wME9PMDAwTzBPMCA6I2xpbmU6MTE1CiAgICAgICAgICAgICAgICBPME9PME9PMDBPMDBPT08wTyA9ZGljdCAoTzBPTzBPTzAwTzAwT09PME8gLCoqT09PME9PMDBPTzAwME8wTzAgLmdldCAoTzAwMDAwME9PT09PTzBPT08gKSkjbGluZToxMTYKICAgICAgICAgICAgTzBPTzBPTzAwTzAwT09PME8gWydzb3J0YWJsZSddPUZhbHNlICNsaW5lOjExOAogICAgICAgICAgICBPTzBPME9PMDAwME8wME8wTyAuYXBwZW5kIChPME9PME9PMDBPMDBPT08wTyApI2xpbmU6MTE5CiAgICBPME8wT09PTzBPME8wMDBPTyA9Tm9uZSAjbGluZToxMjEKICAgIGlmIGhhc2F0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJyk6I2xpbmU6MTIyCiAgICAgICAgTzBPME9PT08wTzBPMDAwT08gPWdldGF0dHIgKG1vZGVsX2FkbWluICwnZm9ybWF0dGVyJykjbGluZToxMjMKICAgIE9PT08wTzAwME8wTzBPT09PID1tb2RlbF9hZG1pbiAubW9kZWwgI2xpbmU6MTI2CiAgICBPMDAwTzAwT08wME9PME9PTyA9e30jbGluZToxMjcKICAgIGZvciBPMDAwME9PTzAwME9PME8wMCBpbiBkaXIgKE9PT08wTzAwME8wTzBPT09PICk6I2xpbmU6MTI4CiAgICAgICAgaWYgTzAwMDBPT08wMDBPTzBPMDAgLmVuZHN3aXRoICgnY2hvaWNlcycpOiNsaW5lOjEyOQogICAgICAgICAgICBPTzBPT09PME8wMDBPTzAwTyA9e30jbGluZToxMzAKICAgICAgICAgICAgT08wME9PTzBPME8wMDAwT08gPWdldGF0dHIgKE9PT08wTzAwME8wTzBPT09PICxPMDAwME9PTzAwME9PME8wMCApI2xpbmU6MTMxCiAgICAgICAgICAgIGZvciBPMDAwMDAwT09PT09PME9PTyBpbiBPTzAwT09PME8wTzAwMDBPTyA6I2xpbmU6MTMyCiAgICAgICAgICAgICAgICBPTzBPT09PME8wMDBPTzAwTyBbTzAwMDAwME9PT09PTzBPT08gWzAgXV09TzAwMDAwME9PT09PTzBPT08gWzEgXSNsaW5lOjEzMwogICAgICAgICAgICBPMDAwTzAwT08wME9PME9PTyBbTzAwMDBPT08wMDBPTzBPMDAgXT1PTzBPT09PME8wMDBPTzAwTyAjbGluZToxMzQKICAgIGZvciBPMDAwME9PTzAwME9PME8wMCBpbiBPT09PME8wMDBPME8wT09PTyAuX21ldGEgLmZpZWxkcyA6I2xpbmU6MTM1CiAgICAgICAgT08wT09PTzBPMDAwT08wME8gPXt9I2xpbmU6MTM2CiAgICAgICAgaWYgaGFzYXR0ciAoTzAwMDBPT08wMDBPTzBPMDAgLCdjaG9pY2VzJyk6I2xpbmU6MTM3CiAgICAgICAgICAgIGlmIGxlbiAoTzAwMDBPT08wMDBPTzBPMDAgLmNob2ljZXMgKT4wIDojbGluZToxMzgKICAgICAgICAgICAgICAgIGZvciBPMDAwMDAwT09PT09PME9PTyBpbiBPMDAwME9PTzAwME9PME8wMCAuY2hvaWNlcyA6I2xpbmU6MTM5CiAgICAgICAgICAgICAgICAgICAgT08wT09PTzBPMDAwT08wME8gW08wMDAwMDBPT09PT08wT09PIFswIF1dPU8wMDAwMDBPT09PT08wT09PIFsxIF0jbGluZToxNDAKICAgICAgICAgICAgICAgIE8wMDBPMDBPTzAwT08wT09PIFtPMDAwME9PTzAwME9PME8wMCAubmFtZSBdPU9PME9PT08wTzAwME9PMDBPICNsaW5lOjE0MQogICAgTU9ERUxfQ0FDSEUgW08wTzBPTzAwT08wT08wME9PIF09eyd2YWx1ZXNfZmllbGRzJzpPMDBPME9PME8wTzBPTzBPTyAsJ2Z1bl9maWVsZHMnOk9PTzAwME9PMDAwME8wMDBPICwnaGVhZGVycyc6T08wTzBPTzAwMDBPMDBPME8gLCdmb3JtYXR0ZXInOk8wTzBPT09PME8wTzAwME9PICwnY2hvaWNlcyc6TzAwME8wME9PMDBPTzBPT08gLH0jbGluZToxNDgKICAgIHJldHVybiBPMDBPME9PME8wTzBPTzBPTyAsT09PMDAwT08wMDAwTzAwME8gLE9PME8wT08wMDAwTzAwTzBPICxPME8wT09PTzBPME8wMDBPTyAsTzAwME8wME9PMDBPTzBPT08gI2xpbmU6MTQ5CmRlZiBnZXRfY3VzdG9tX2J1dHRvbiAocmVxdWVzdCAsYWRtaW4gKTojbGluZToxNTIKICAgIE9PT09PMDAwTzAwMDAwT08wID17fSNsaW5lOjE1MwogICAgTzAwMDAwMDBPTzBPME9PMDAgPWFkbWluIC5nZXRfYWN0aW9ucyAocmVxdWVzdCApI2xpbmU6MTU0CiAgICBPMDBPME8wMDBPT09PME8wTyA9YWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAjbGluZToxNTkKICAgIGlmIE8wMDAwMDAwT08wTzBPTzAwIDojbGluZToxNjAKICAgICAgICBPT09PME8wMDAwT08wT09PMCA9MCAjbGluZToxNjEKICAgICAgICBmb3IgT08wMDBPME8wME9PTzBPTzAgaW4gTzAwMDAwMDBPTzBPME9PMDAgOiNsaW5lOjE2MgogICAgICAgICAgICBPMDAwME8wMDBPTzBPMDAwMCA9e30jbGluZToxNjMKICAgICAgICAgICAgTzAwMDBPME9PME8wT08wTzAgPU8wMDAwMDAwT08wTzBPTzAwIC5nZXQgKE9PMDAwTzBPMDBPT08wT08wIClbMCBdI2xpbmU6MTY0CiAgICAgICAgICAgIGZvciBPME8wT08wME9PTzAwT08wTyAsT09PME9PMDBPMDBPME9PMDAgaW4gTzAwMDBPME9PME8wT08wTzAgLl9fZGljdF9fIC5pdGVtcyAoKTojbGluZToxNjUKICAgICAgICAgICAgICAgIGlmIE8wTzBPTzAwT09PMDBPTzBPICE9J19fbGVuX18nYW5kIE8wTzBPTzAwT09PMDBPTzBPICE9J19fd3JhcHBlZF9fJzojbGluZToxNjYKICAgICAgICAgICAgICAgICAgICBPMDAwME8wMDBPTzBPMDAwMCBbTzBPME9PMDBPT08wME9PME8gXT1PT08wT08wME8wME8wT08wMCAjbGluZToxNjcKICAgICAgICAgICAgTzAwMDBPMDAwT08wTzAwMDAgWydlaWQnXT1PT09PME8wMDAwT08wT09PMCAjbGluZToxNjgKICAgICAgICAgICAgT09PTzBPMDAwME9PME9PTzAgKz0xICNsaW5lOjE2OQogICAgICAgICAgICBpZiBPTzAwME8wTzAwT09PME9PMCA9PSdleHBvcnRfYWRtaW5fYWN0aW9uJzojbGluZToxNzAKICAgICAgICAgICAgICAgIE8wMDAwTzAwME9PME8wMDAwIFsnbGFiZWwnXT0n6YCJ5Lit5a+85Ye6JyNsaW5lOjE3MQogICAgICAgICAgICAgICAgTzAwMDBPMDAwT08wTzAwMDAgWydpc0V4cG9ydCddPVRydWUgI2xpbmU6MTcyCiAgICAgICAgICAgICAgICBPMDAwME8wMDBPTzBPMDAwMCBbJ2ljb24nXT0nZWwtaWNvbi1maW5pc2hlZCcjbGluZToxNzMKICAgICAgICAgICAgICAgIE8wME8wME9PT09PME8wT08wID1bXSNsaW5lOjE3NAogICAgICAgICAgICAgICAgZm9yIE8wMDAwT09PT09PT09PME8wIGluIGVudW1lcmF0ZSAoYWRtaW4gLmdldF9leHBvcnRfZm9ybWF0cyAoKSk6I2xpbmU6MTc1CiAgICAgICAgICAgICAgICAgICAgTzAwTzAwT09PT08wTzBPTzAgLmFwcGVuZCAoeyd2YWx1ZSc6TzAwMDBPT09PT09PT08wTzAgWzAgXSwnbGFiZWwnOk8wMDAwT09PT09PT09PME8wIFsxIF0oKS5nZXRfdGl0bGUgKCl9KSNsaW5lOjE3OQogICAgICAgICAgICAgICAgTzAwMDBPMDAwT08wTzAwMDAgWydmb3JtYXRzJ109TzAwTzAwT09PT08wTzBPTzAgI2xpbmU6MTgxCiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjE4MgogICAgICAgICAgICAgICAgTzAwMDBPMDAwT08wTzAwMDAgWydsYWJlbCddPU8wMDAwMDAwT08wTzBPTzAwIC5nZXQgKE9PMDAwTzBPMDBPT08wT08wIClbMiBdI2xpbmU6MTgzCiAgICAgICAgICAgIGlmIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtICgne30ue30nLmZvcm1hdCAoTzAwTzBPMDAwT09PTzBPME8gLE9PMDAwTzBPMDBPT08wT08wICkpOiNsaW5lOjE4NgogICAgICAgICAgICAgICAgT09PT08wMDBPMDAwMDBPTzAgW09PMDAwTzBPMDBPT08wT08wIF09TzAwMDBPMDAwT08wTzAwMDAgI2xpbmU6MTg3CiAgICBpZiAnZGVsZXRlX3NlbGVjdGVkJ2luIE9PT09PMDAwTzAwMDAwT08wIDojbGluZToxODgKICAgICAgICBkZWwgT09PT08wMDBPMDAwMDBPTzAgWydkZWxldGVfc2VsZWN0ZWQnXSNsaW5lOjE4OQogICAgcmV0dXJuIE9PT09PMDAwTzAwMDAwT08wICNsaW5lOjE5MApkZWYgc2VhcmNoX3BsYWNlaG9sZGVyIChjbCApOiNsaW5lOjE5MwogICAgT08wMDAwTzBPTzBPTzBPMDAgPWdldF9tb2RlbF9maWVsZHMgKGNsIC5tb2RlbCApI2xpbmU6MTk1CiAgICBmb3IgT09PTzBPT09PME8wT08wTzAgaW4gY2wgLm1vZGVsIC5fbWV0YSAuZmllbGRzIDojbGluZToxOTcKICAgICAgICBpZiBpc2luc3RhbmNlIChPT09PME9PT08wTzBPTzBPMCAsRm9yZWlnbktleSApOiNsaW5lOjE5OAogICAgICAgICAgICBPTzAwMDBPME9PME9PME8wMCAuZXh0ZW5kIChnZXRfbW9kZWxfZmllbGRzIChPT09PME9PT08wTzBPTzBPMCAucmVsYXRlZF9tb2RlbCAsT09PTzBPT09PME8wT08wTzAgLm5hbWUgKSkjbGluZToxOTkKICAgIE9PTzBPT09PMDBPME8wT09PID1bXSNsaW5lOjIwMQogICAgZm9yIE8wTzAwME8wME9PTzBPME9PIGluIGNsIC5zZWFyY2hfZmllbGRzIDojbGluZToyMDMKICAgICAgICBmb3IgT09PTzBPT09PME8wT08wTzAgaW4gT08wMDAwTzBPTzBPTzBPMDAgOiNsaW5lOjIwNAogICAgICAgICAgICBpZiBPT09PME9PT08wTzBPTzBPMCBbMCBdPT1PME8wMDBPMDBPT08wTzBPTyA6I2xpbmU6MjA1CiAgICAgICAgICAgICAgICBPT08wT09PTzAwTzBPME9PTyAuYXBwZW5kIChPT09PME9PT08wTzBPTzBPMCBbMSBdKSNsaW5lOjIwNgogICAgICAgICAgICAgICAgYnJlYWsgI2xpbmU6MjA3CiAgICByZXR1cm4gIiwiLmpvaW4gKE9PTzBPT09PMDBPME8wT09PICkjbGluZToyMDkKZGVmIHdyaXRlIChkYXRhICxPME9PMDAwME9PME9PTzBPTyA9J29rJyxPT09PME9PMDAwME9PTzAwTyA9VHJ1ZSApOiNsaW5lOjIxMgogICAgTzBPME8wMDAwT08wTzAwT08gPXsnc3RhdGUnOk9PT08wT08wMDAwT09PMDBPICwnbXNnJzpPME9PMDAwME9PME9PTzBPTyAsJ2RhdGEnOmRhdGEgfSNsaW5lOjIxNwogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKE8wTzBPMDAwME9PME8wME9PICxjbHMgPUxhenlFbmNvZGVyICksY29udGVudF90eXBlID0nYXBwbGljYXRpb24vanNvbicpI2xpbmU6MjE5CmRlZiB3cml0ZV9vYmogKG9iaiApOiNsaW5lOjIyMgogICAgcmV0dXJuIEh0dHBSZXNwb25zZSAoanNvbiAuZHVtcHMgKG9iaiAsY2xzID1MYXp5RW5jb2RlciApLGNvbnRlbnRfdHlwZSA9J2FwcGxpY2F0aW9uL2pzb24nKSNsaW5lOjIyMwpkZWYgaGFzX3Blcm1pc3Npb24gKHJlcXVlc3QgLGFkbWluICxwZXJtaXNzaW9uICk6I2xpbmU6MjI2CiAgICBPTzBPTzAwMDAwMDAwMDAwMCA9Z2V0X3Blcm1pc3Npb25fY29kZW5hbWUgKHBlcm1pc3Npb24gLGFkbWluIC5vcHRzICkjbGluZToyMjcKICAgIE8wT08wMDBPTzAwMDBPMDBPID0ne30ue30nLmZvcm1hdCAoYWRtaW4gLm9wdHMgLmFwcF9sYWJlbCAsT08wT08wMDAwMDAwMDAwMDAgKSNsaW5lOjIyOAogICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChPME9PMDAwT08wMDAwTzAwTyApI2xpbmU6MjI5CmRlZiBnZXRfcGVybWlzc2lvbl9jb2RlbmFtZSAoYWN0aW9uICxvcHRzICk6I2xpbmU6MjMyCiAgICAiIiNsaW5lOjIzNQogICAgcmV0dXJuICclc18lcyclKGFjdGlvbiAsb3B0cyAubW9kZWxfbmFtZSApI2xpbmU6MjM2CmZyb20gc2ltcGxldWkgLnRlbXBsYXRldGFncyBpbXBvcnQgc2ltcGxldGFncyAjbGluZToyMzkKZnJvbSBzaW1wbGV1aSAudGVtcGxhdGV0YWdzIC5zaW1wbGV0YWdzIGltcG9ydCBnZXRfY29uZmlnICNsaW5lOjI0MApkZWYgZ2V0X21lbnVzIChyZXF1ZXN0ICxhZG1pbl9zaXRlICk6I2xpbmU6MjQzCiAgICAiIiNsaW5lOjI0OQogICAgT09PTzAwME8wMDAwMDBPTzAgPXsnYXBwX2xpc3QnOmFkbWluX3NpdGUgLmdldF9hcHBfbGlzdCAocmVxdWVzdCApLCdyZXF1ZXN0JzpyZXF1ZXN0IH0jbGluZToyNTMKICAgIGRlZiBPME8wME8wMDBPTzBPTzAwTyAoa2V5ICk6I2xpbmU6MjU1CiAgICAgICAgcmV0dXJuIHJlcXVlc3QgLnVzZXIgLmhhc19wZXJtIChrZXkgKSNsaW5lOjI1NgogICAgZGVmIF9PTzAwME9PT08wME8wME8wTyAoa2V5ICk6I2xpbmU6MjU4CiAgICAgICAgaWYga2V5ID09J1NJTVBMRVVJX0NPTkZJRyc6I2xpbmU6MjU5CiAgICAgICAgICAgIF9PTzBPTzAwTzBPME9PMDBPTyA9Z2V0X2NvbmZpZyAoa2V5ICkjbGluZToyNjEKICAgICAgICAgICAgaWYgX09PME9PMDBPME8wT08wME9PIGFuZCAnbWVudXMnaW4gX09PME9PMDBPME8wT08wME9PIDojbGluZToyNjIKICAgICAgICAgICAgICAgIE8wMDBPME9PT09PME8wT08wID1fT08wT08wME8wTzBPTzAwT08gLmdldCAoJ21lbnVzJykjbGluZToyNjMKICAgICAgICAgICAgICAgIE8wME8wT09PMDBPME9PMDAwID1bXSNsaW5lOjI2NAogICAgICAgICAgICAgICAgZm9yIE9PTzBPME9PT09PT08wME9PIGluIE8wMDBPME9PT09PME8wT08wIDojbGluZToyNjYKICAgICAgICAgICAgICAgICAgICBpZiAnY29kZW5hbWUnbm90IGluIE9PTzBPME9PT09PT08wME9PIDojbGluZToyNjcKICAgICAgICAgICAgICAgICAgICAgICAgTzAwTzBPT08wME8wT08wMDAgLmFwcGVuZCAoT09PME8wT09PT09PTzAwT08gKSNsaW5lOjI2OAogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSAjbGluZToyNjkKICAgICAgICAgICAgICAgICAgICBPMDBPTzAwT09PMDAwTzBPTyA9T09PME8wT09PT09PTzAwT08gLmdldCAoJ2NvZGVuYW1lJykjbGluZToyNzAKICAgICAgICAgICAgICAgICAgICBrZXkgPSd7fS57fScuZm9ybWF0IChPMDBPTzAwT09PMDAwTzBPTyAsTzAwT08wME9PTzAwME8wT08gKSNsaW5lOjI3MwogICAgICAgICAgICAgICAgICAgIGlmIE8wTzAwTzAwME9PME9PMDBPIChrZXkgKTojbGluZToyNzQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21vZGVscydpbiBPT08wTzBPT09PT09PMDBPTyA6I2xpbmU6Mjc2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTzAwT08wMDAwTzAwMDBPTyA9T09PME8wT09PT09PTzAwT08gLmdldCAoJ21vZGVscycpI2xpbmU6Mjc3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTzAwMDBPMDAwME8wTzBPMCA9W10jbGluZToyNzgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBPME8wT09PTzBPTzAwME8wMCBpbiBPTzAwT08wMDAwTzAwMDBPTyA6I2xpbmU6Mjc5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2NvZGVuYW1lJ2luIE8wTzBPT09PME9PMDAwTzAwIDojbGluZToyODAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgTzBPMDBPMDAwT08wT08wME8gKCd7fS57fScuZm9ybWF0IChPMDBPTzAwT09PMDAwTzBPTyAsTzBPME9PT08wT08wMDBPMDAgLmdldCAoJ2NvZGVuYW1lJykpKTojbGluZToyODEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9PMDAwME8wMDAwTzBPME8wIC5hcHBlbmQgKE8wTzBPT09PME9PMDAwTzAwICkjbGluZToyODIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIDojbGluZToyODMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT08wMDAwTzAwMDBPME8wTzAgLmFwcGVuZCAoTzBPME9PT08wT08wMDBPMDAgKSNsaW5lOjI4NAogICAgICAgICAgICAgICAgICAgICAgICAgICAgT09PME8wT09PT09PTzAwT08gWydtb2RlbHMnXT1PTzAwMDBPMDAwME8wTzBPMCAjbGluZToyODUKICAgICAgICAgICAgICAgICAgICAgICAgTzAwTzBPT08wME8wT08wMDAgLmFwcGVuZCAoT09PME8wT09PT09PTzAwT08gKSNsaW5lOjI4NwogICAgICAgICAgICAgICAgX09PME9PMDBPME8wT08wME9PIFsnbWVudXMnXT1PMDBPME9PTzAwTzBPTzAwMCAjbGluZToyODgKICAgICAgICByZXR1cm4gX09PME9PMDBPME8wT08wME9PICNsaW5lOjI5MAogICAgcmV0dXJuIHNpbXBsZXRhZ3MgLm1lbnVzIChPT09PMDAwTzAwMDAwME9PMCAsX2dldF9jb25maWcgPV9PTzAwME9PT08wME8wME8wTyApI2xpbmU6MjkyCg=='))