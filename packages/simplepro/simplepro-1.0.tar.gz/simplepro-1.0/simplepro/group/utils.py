import base64
exec(base64.b64decode(b'ZnJvbSBkamFuZ28gLmNvbnRyaWIgLmF1dGggLm1vZGVscyBpbXBvcnQgUGVybWlzc2lvbiAjbGluZToxCmRlZiBnZXRfYWN0aW9uX25hbWUgKG5hbWUgKTojbGluZTo0CiAgICAiIiNsaW5lOjkKICAgIG5hbWUgPW5hbWUgLnJlcGxhY2UgKCdDYW4gYWRkICcsJ+WinuWKoCcpLnJlcGxhY2UgKCdDYW4gY2hhbmdlICcsJ+e8lui+kScpLnJlcGxhY2UgKCdDYW4gZGVsZXRlICcsJ+WIoOmZpCcpLnJlcGxhY2UgKCdDYW4gdmlldyAnLCfmn6XnnIsnKSNsaW5lOjExCiAgICByZXR1cm4gbmFtZSAjbGluZToxMgpkZWYgZ2V0X3Blcm1pc3Npb25zICgpOiNsaW5lOjE1CiAgICAiIiNsaW5lOjE5CiAgICBPME8wME8wT08wTzBPT08wTyA9UGVybWlzc2lvbiAub2JqZWN0cyAuYWxsICgpI2xpbmU6MjAKICAgIE8wTzAwMDBPT08wMDBPT09PID17fSNsaW5lOjIzCiAgICBmb3IgTzAwMDBPT09PME8wMDBPME8gaW4gTzBPMDBPME9PME8wT09PME8gOiNsaW5lOjI1CiAgICAgICAgTzBPTzAwT09PTzBPTzAwTzAgPU8wMDAwT09PTzBPMDAwTzBPIC5jb250ZW50X3R5cGUgLmFwcF9sYWJlbCAjbGluZToyNgogICAgICAgIGlmIE8wT08wME9PT08wT08wME8wIG5vdCBpbiBPME8wMDAwT09PMDAwT09PTyA6I2xpbmU6MjcKICAgICAgICAgICAgTzBPMDAwME9PTzAwME9PT08gW08wT08wME9PT08wT08wME8wIF09eydsYWJlbCc6TzBPTzAwT09PTzBPTzAwTzAgLCdjaGlsZHJlbic6W08wMDAwT09PTzBPMDAwTzBPIF19I2xpbmU6MzEKICAgICAgICBlbHNlIDojbGluZTozMgogICAgICAgICAgICBPT08wME8wME8wME8wMDAwTyA9TzBPMDAwME9PTzAwME9PT08gLmdldCAoTzBPTzAwT09PTzBPTzAwTzAgKSNsaW5lOjMzCiAgICAgICAgICAgIE9PTzAwTzAwMDAwMDAwME9PID1PT08wME8wME8wME8wMDAwTyAuZ2V0ICgnY2hpbGRyZW4nKSNsaW5lOjM0CiAgICAgICAgICAgIE9PTzAwTzAwMDAwMDAwME9PIC5hcHBlbmQgKE8wMDAwT09PTzBPMDAwTzBPICkjbGluZTozNQogICAgZm9yIE9PT09PTzAwTzAwMDAwT08wIGluIE8wTzAwMDBPT08wMDBPT09PIDojbGluZTo0MAogICAgICAgIE8wMDAwT09PTzBPMDAwTzBPID1PME8wMDAwT09PMDAwT09PTyAuZ2V0IChPT09PT08wME8wMDAwME9PMCApI2xpbmU6NDEKICAgICAgICBPT08wME8wMDAwMDAwMDBPTyA9TzAwMDBPT09PME8wMDBPME8gLmdldCAoJ2NoaWxkcmVuJykjbGluZTo0MgogICAgICAgIE8wTzBPME8wMDAwT09PTzBPID17fSNsaW5lOjQ1CiAgICAgICAgZm9yIE9PTzAwTzBPTzAwME9PTzBPIGluIE9PTzAwTzAwMDAwMDAwME9PIDojbGluZTo0NgogICAgICAgICAgICBPME9PMDBPT09PME9PMDBPMCA9T09PMDBPME9PMDAwT09PME8gLmNvbnRlbnRfdHlwZSAubmFtZSAjbGluZTo0OAogICAgICAgICAgICBpZiBPME9PMDBPT09PME9PMDBPMCBub3QgaW4gTzBPME8wTzAwMDBPT09PME8gOiNsaW5lOjQ5CiAgICAgICAgICAgICAgICBPME8wTzBPMDAwME9PT08wTyBbTzBPTzAwT09PTzBPTzAwTzAgXT17J2xhYmVsJzpPME9PMDBPT09PME9PMDBPMCAsJ2NoaWxkcmVuJzpbeydpZCc6T09PMDBPME9PMDAwT09PME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT09PMDBPME9PMDAwT09PME8gLm5hbWUgKX1dfSNsaW5lOjU2CiAgICAgICAgICAgIGVsc2UgOiNsaW5lOjU3CiAgICAgICAgICAgICAgICBPME8wTzBPMDAwME9PT08wTyBbTzBPTzAwT09PTzBPTzAwTzAgXS5nZXQgKCdjaGlsZHJlbicpLmFwcGVuZCAoeydpZCc6T09PMDBPME9PMDAwT09PME8gLmlkICwnbGFiZWwnOmdldF9hY3Rpb25fbmFtZSAoT09PMDBPME9PMDAwT09PME8gLm5hbWUgKX0pI2xpbmU6NjEKICAgICAgICBPMDAwTzAwME8wME9PMDBPMCA9W10jbGluZTo2MgogICAgICAgIGZvciBPT08wME8wT08wMDBPT08wTyBpbiBPME8wTzBPMDAwME9PT08wTyA6I2xpbmU6NjMKICAgICAgICAgICAgTzAwME8wMDBPMDBPTzAwTzAgLmFwcGVuZCAoTzBPME8wTzAwMDBPT09PME8gLmdldCAoT09PMDBPME9PMDAwT09PME8gKSkjbGluZTo2NAogICAgICAgIE8wMDAwT09PTzBPMDAwTzBPIFsnY2hpbGRyZW4nXT1PMDAwTzAwME8wME9PMDBPMCAjbGluZTo2NQogICAgT08wT08wMDBPT09PME8wT08gPVtdI2xpbmU6NjcKICAgIGZvciBPT08wME8wT08wMDBPT08wTyBpbiBPME8wMDAwT09PMDAwT09PTyA6I2xpbmU6NjgKICAgICAgICBPTzBPTzAwME9PT08wTzBPTyAuYXBwZW5kIChPME8wMDAwT09PMDAwT09PTyAuZ2V0IChPT08wME8wT08wMDBPT08wTyApKSNsaW5lOjY5CiAgICByZXR1cm4gT08wT08wMDBPT09PME8wT08gI2xpbmU6NzEK'))