import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6MQppbXBvcnQgb3MgI2xpbmU6Mgpmcm9tIGRqYW5nbyAuY29udHJpYiAuYXV0aCAubW9kZWxzIGltcG9ydCBQZXJtaXNzaW9uICxHcm91cCAjbGluZTo0CmZyb20gZGphbmdvIC5zaG9ydGN1dHMgaW1wb3J0IHJlbmRlciAjbGluZTo1CmZyb20gLnV0aWxzIGltcG9ydCBnZXRfcGVybWlzc2lvbnMgI2xpbmU6Ngpmcm9tIHNpbXBsZXBybyAudXRpbHMgaW1wb3J0IHdyaXRlICx3cml0ZV9vYmogI2xpbmU6Nwpmcm9tIHNpbXBsZXBybyBpbXBvcnQgY29uZiAjbGluZTo4CmltcG9ydCByZXF1ZXN0cyAjbGluZTo5CmltcG9ydCBzdHJ1Y3QgI2xpbmU6MTAKZGVmIGFjdGlvbiAocmVxdWVzdCApOiNsaW5lOjEzCiAgICBPT08wTzAwMDAwME9PT08wMCA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnYWN0aW9uJykjbGluZToxNAogICAgTzBPME9PTzBPME8wTzAwTzAgPXsndHJlZSc6Z2V0X3RyZWUgLCdzYXZlJzpzYXZlICwnZ2V0X2RldGFpbCc6Z2V0X2RldGFpbCB9I2xpbmU6MjAKICAgIHJldHVybiBPME8wT09PME8wTzBPMDBPMCAuZ2V0IChPT08wTzAwMDAwME9PT08wMCApKHJlcXVlc3QgKSNsaW5lOjIyCmRlZiBnZXRfZGV0YWlsIChyZXF1ZXN0ICk6I2xpbmU6MjUKICAgIE8wT08wMDAwT08wME8wMDAwID1yZXF1ZXN0IC5QT1NUIC5nZXQgKCdpZCcpI2xpbmU6MjYKICAgIE9PME8wTzAwMDBPMDAwTzBPID1Hcm91cCAub2JqZWN0cyAuZmlsdGVyIChpZCA9TzBPTzAwMDBPTzAwTzAwMDAgKS5maXJzdCAoKSNsaW5lOjI3CiAgICBPTzBPME8wMDAwTzBPMDAwMCA9W10jbGluZToyOAogICAgaWYgT08wTzBPMDAwME8wMDBPME8gOiNsaW5lOjI5CiAgICAgICAgT08wMDBPTzBPME9PMDBPMDAgPU9PME8wTzAwMDBPMDAwTzBPIC5wZXJtaXNzaW9ucyAuYWxsICgpI2xpbmU6MzAKICAgICAgICBmb3IgT08wME9PT08wTzBPMDAwMDAgaW4gT08wMDBPTzBPME9PMDBPMDAgOiNsaW5lOjMxCiAgICAgICAgICAgIE9PME8wTzAwMDBPME8wMDAwIC5hcHBlbmQgKE9PMDBPT09PME8wTzAwMDAwIC5pZCApI2xpbmU6MzIKICAgIHJldHVybiB3cml0ZSAoT08wTzBPMDAwME8wTzAwMDAgKSNsaW5lOjM0CmRlZiBzYXZlIChyZXF1ZXN0ICk6I2xpbmU6MzcKICAgIE9PT08wTzBPME8wME9PMDBPID1UcnVlICNsaW5lOjM4CiAgICBPTzAwT08wTzAwTzBPMDAwMCA9Im9rIiNsaW5lOjM5CiAgICB0cnkgOiNsaW5lOjQwCiAgICAgICAgT09PTzAwT08wME8wME9PME8gPXJlcXVlc3QgLlBPU1QgLmdldCAoJ25hbWUnKSNsaW5lOjQxCiAgICAgICAgTzBPME8wME9PT08wMDAwTzAgPXJlcXVlc3QgLlBPU1QgLmdldCAoJ2lkcycpI2xpbmU6NDIKICAgICAgICBPT08wME9PME8wME9PTzAwMCA9cmVxdWVzdCAuUE9TVCAuZ2V0ICgnaWQnKSNsaW5lOjQzCiAgICAgICAgaWYgT09PMDBPTzBPMDBPT08wMDAgYW5kIE9PTzAwT08wTzAwT09PMDAwICE9Jyc6I2xpbmU6NDYKICAgICAgICAgICAgTzAwT09PTzAwMDAwMDBPMDAgPUdyb3VwIC5vYmplY3RzIC5nZXQgKGlkID1PT08wME9PME8wME9PTzAwMCApI2xpbmU6NDcKICAgICAgICAgICAgTzAwT09PTzAwMDAwMDBPMDAgLnBlcm1pc3Npb25zIC5jbGVhciAoKSNsaW5lOjQ5CiAgICAgICAgZWxzZSA6I2xpbmU6NTAKICAgICAgICAgICAgTzAwT09PTzAwMDAwMDBPMDAgPUdyb3VwIC5vYmplY3RzIC5jcmVhdGUgKG5hbWUgPU9PT08wME9PMDBPMDBPTzBPICkjbGluZTo1MQogICAgICAgIGlmIE8wTzBPMDBPT09PMDAwME8wIGFuZCBPME8wTzAwT09PTzAwMDBPMCAhPScnOiNsaW5lOjUyCiAgICAgICAgICAgIE8wTzBPMDBPT09PMDAwME8wID1PME8wTzAwT09PTzAwMDBPMCAuc3BsaXQgKCcsJykjbGluZTo1MwogICAgICAgICAgICBmb3IgT09PT09PT09PT09PT09PME8gaW4gTzBPME8wME9PT08wMDAwTzAgOiNsaW5lOjU0CiAgICAgICAgICAgICAgICBPMDBPT09PMDAwMDAwME8wMCAucGVybWlzc2lvbnMgLmFkZCAoT09PT09PT09PT09PT09PME8gKSNsaW5lOjU2CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wME9PT08wTzAwME9PT08wIDojbGluZTo1NwogICAgICAgIE9PT08wTzBPME8wME9PMDBPID1GYWxzZSAjbGluZTo1OAogICAgICAgIE9PMDBPTzBPMDBPME8wMDAwID1PMDBPT09PME8wMDBPT09PMCAuYXJncyBbMCBdI2xpbmU6NTkKICAgIHJldHVybiB3cml0ZSAoTm9uZSAsT08wME9PME8wME8wTzAwMDAgLE9PT08wTzBPME8wME9PMDBPICkjbGluZTo2MApkZWYgZ2V0X3RyZWUgKHJlcXVlc3QgKTojbGluZTo2MwogICAgIiIjbGluZTo2OAogICAgT08wME8wMDBPME9PME9PME8gPWdldF9wZXJtaXNzaW9ucyAoKSNsaW5lOjY5CiAgICByZXR1cm4gd3JpdGUgKE9PMDBPMDAwTzBPTzBPTzBPICkjbGluZTo3MAo='))