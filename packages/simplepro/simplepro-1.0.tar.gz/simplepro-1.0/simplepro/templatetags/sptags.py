import base64
exec(base64.b64decode(b'aW1wb3J0IGpzb24gI2xpbmU6Mgpmcm9tIGRqYW5nbyBpbXBvcnQgdGVtcGxhdGUgI2xpbmU6NApyZWdpc3RlciA9dGVtcGxhdGUgLkxpYnJhcnkgKCkjbGluZTo2CmZyb20gaW1wb3J0X2V4cG9ydCAuYWRtaW4gaW1wb3J0IEltcG9ydEV4cG9ydE1peGluQmFzZSAjbGluZTo4CmZyb20gc2ltcGxlcHJvIGltcG9ydCBjb25mICNsaW5lOjkKaW1wb3J0IHNpbXBsZXBybyAjbGluZToxMAppbXBvcnQgc2ltcGxldWkgI2xpbmU6MTEKQHJlZ2lzdGVyIC5zaW1wbGVfdGFnICh0YWtlc19jb250ZXh0ID1UcnVlICkjbGluZToxNApkZWYgaGFzX2ltcG9ydF9leHBvcnQgKGNvbnRleHQgKTojbGluZToxNQogICAgTzAwMDAwTzBPTzAwME8wT08gPWNvbnRleHQgLmdldCAoJ2NsJykjbGluZToxNgogICAgcmV0dXJuIGlzc3ViY2xhc3MgKE8wMDAwME8wT08wMDBPME9PIC5fX2NsYXNzX18gLEltcG9ydEV4cG9ydE1peGluQmFzZSApI2xpbmU6MTcKQHJlZ2lzdGVyIC5zaW1wbGVfdGFnICh0YWtlc19jb250ZXh0ID1UcnVlICkjbGluZToyMApkZWYgZ2V0X2Rpc3BsYXlfbmFtZSAoY29udGV4dCApOiNsaW5lOjIxCiAgICBPT09PTzBPT08wMDAwME9PMCA9Y29udGV4dCAuZ2V0ICgndXNlcicpI2xpbmU6MjIKICAgIGlmIE9PT09PME9PTzAwMDAwT08wIDojbGluZToyNAogICAgICAgIE9PMDAwT08wT09PTzAwT08wID0nJyNsaW5lOjI1CiAgICAgICAgaWYgT09PT08wT09PMDAwMDBPTzAgLmZpcnN0X25hbWUgOiNsaW5lOjI3CiAgICAgICAgICAgIE9PMDAwT08wT09PTzAwT08wICs9T09PT08wT09PMDAwMDBPTzAgLmZpcnN0X25hbWUgI2xpbmU6MjgKICAgICAgICBpZiBPT09PTzBPT08wMDAwME9PMCAubGFzdF9uYW1lIDojbGluZToyOQogICAgICAgICAgICBPTzAwME9PME9PT08wME9PMCArPU9PT09PME9PTzAwMDAwT08wIC5sYXN0X25hbWUgI2xpbmU6MzAKICAgIGlmIG5vdCBPTzAwME9PME9PT08wME9PMCA6I2xpbmU6MzEKICAgICAgICBPTzAwME9PME9PT08wME9PMCA9c3RyIChPT09PTzBPT08wMDAwME9PMCApI2xpbmU6MzIKICAgIHJldHVybiBPTzAwME9PME9PT08wME9PMCAjbGluZTozMwpAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6MzYKZGVmIGdldF9zZXJ2ZXJfdXJsICgpOiNsaW5lOjM3CiAgICByZXR1cm4gY29uZiAuZ2V0X3NlcnZlcl91cmwgKCkjbGluZTozOApAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6NDEKZGVmIGdldF9zcF92ZXJzaW9uICgpOiNsaW5lOjQyCiAgICByZXR1cm4gc2ltcGxlcHJvIC5nZXRfdmVyc2lvbiAoKSNsaW5lOjQzCkByZWdpc3RlciAuc2ltcGxlX3RhZyAjbGluZTo0NgpkZWYgZ2V0X2RldmljZV9pZCAoKTojbGluZTo0NwogICAgcmV0dXJuIGNvbmYgLmdldF9kZXZpY2VfaWQgKCkjbGluZTo0OApAcmVnaXN0ZXIgLnNpbXBsZV90YWcgI2xpbmU6NTEKZGVmIGdldF9zaW1wbGVfdmVyc2lvbiAoKTojbGluZTo1MgogICAgcmV0dXJuIHNpbXBsZXVpIC5nZXRfdmVyc2lvbiAoKSNsaW5lOjUzCkByZWdpc3RlciAuc2ltcGxlX3RhZyAodGFrZXNfY29udGV4dCA9VHJ1ZSApI2xpbmU6NTYKZGVmIHRlc3RfdGFnIChjb250ZXh0ICk6I2xpbmU6NTcKICAgIHByaW50IChjb250ZXh0ICkjbGluZTo1OAogICAgT09PT08wME8wME9PME8wMDAgPWNvbnRleHQgLmdldCAoJ2ZpZWxkc2V0JykjbGluZTo1OQogICAgZm9yIE8wT09PTzBPT09PMDBPTzAwIGluIE9PT09PMDBPMDBPTzBPMDAwIDojbGluZTo2MAogICAgICAgIHByaW50IChPME9PT08wT09PTzAwT08wMCApI2xpbmU6NjEKICAgIHBhc3MgI2xpbmU6NjIK'))