
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>csnake.codewriter &#8212; csnake  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for csnake.codewriter</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Mapping</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">._version</span> <span class="k">import</span> <span class="n">get_versions</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">CExtendedLiteral</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">Function</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">generate_c_value_initializer</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">Struct</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="nn">.cconstructs</span> <span class="k">import</span> <span class="n">VariableValue</span>
<span class="kn">from</span> <span class="nn">.codewriterlite</span> <span class="k">import</span> <span class="n">CodeWriterLite</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">assure_str</span>

<span class="n">SOURCE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://gitlab.com/andrejr/csnake&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="n">get_versions</span><span class="p">()[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>
<span class="n">PYPI_URL</span> <span class="o">=</span> <span class="s2">&quot;https://pypi.org/project/csnake&quot;</span>


<span class="k">class</span> <span class="nc">DefStackEmptyError</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
    <span class="s2">&quot;Ended a if[n]def that wasn&#39;t started earlier. To ignore, use </span><span class="se">\</span>
<span class="s2">    ignore_ifdef_stack=True as parameter&quot;</span>


<span class="k">class</span> <span class="nc">SwitchStackEmptyError</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
    <span class="s2">&quot;Ended a switch that wasn&#39;t started earlier. To ignore, use </span><span class="se">\</span>
<span class="s2">    ignore_switch_stack=True as parameter&quot;</span>


<div class="viewcode-block" id="CodeWriter"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter">[docs]</a><span class="k">class</span> <span class="nc">CodeWriter</span><span class="p">(</span><span class="n">CodeWriterLite</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Container class for C code, with methods to add C constructs.</span>

<span class="sd">    :class:`CodeWriter` (abbreviated `CW` or `cw`) is a code container that</span>
<span class="sd">    allows you to add code (both manually written and generated), access it as</span>
<span class="sd">    a :obj:`str`, iterate over the lines of code and output the code to a file.</span>

<span class="sd">    It also helps you to indent and dedent code, open or close code blocks</span>
<span class="sd">    consistently.</span>

<span class="sd">    :class:`CodeWriter` is iterable (iterates over lines of code), and also has</span>
<span class="sd">    methods like :meth:`__contains__` and :meth:`__len__`.</span>

<span class="sd">    Here&#39;s an overview of abc&#39;s :class:`CodeWriter` is a virtual subclass of:</span>

<span class="sd">    &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">    &gt;&gt;&gt; from collections.abc import Container, Iterable, Sized, Collection</span>
<span class="sd">    &gt;&gt;&gt; cwr = CodeWriter()</span>
<span class="sd">    &gt;&gt;&gt; assert isinstance(cwr, Container)</span>
<span class="sd">    &gt;&gt;&gt; assert isinstance(cwr, Iterable)</span>
<span class="sd">    &gt;&gt;&gt; assert isinstance(cwr, Sized)</span>
<span class="sd">    &gt;&gt;&gt; assert isinstance(cwr, Collection)</span>

<span class="sd">    Args:</span>
<span class="sd">        lf: linefeed character used to separate lines of code when</span>
<span class="sd">            rendering code with :func:`str` or :attr:`code`.</span>
<span class="sd">        indent: indentation unit string or :class:`int` number of spaces,</span>
<span class="sd">            used to indent code.</span>

<span class="sd">    Attributes:</span>

<span class="sd">        lf(str): linefeed character used to separate lines of code when</span>
<span class="sd">            rendering code with :func:`str` or :attr:`code`.</span>

<span class="sd">        lines(list(str)): lines of code.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_def_stack&quot;</span><span class="p">,</span> <span class="s2">&quot;_switch_stack&quot;</span><span class="p">)</span>

    <span class="n">_CPP</span> <span class="o">=</span> <span class="s2">&quot;__cplusplus&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lf</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>

        <span class="c1"># initialize values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_stack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_switch_stack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="CodeWriter.add_autogen_comment"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_autogen_comment">[docs]</a>    <span class="k">def</span> <span class="nf">add_autogen_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a comment denoting the code was autogenerated by a script.</span>

<span class="sd">        File name of the script the file is generated from is optional.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_file_name: name of the script the code was generated from</span>

<span class="sd">        Examples:</span>
<span class="sd">            Without a script file name:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; cwr1 = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cwr1.add_autogen_comment()</span>
<span class="sd">            &gt;&gt;&gt; print(cwr1) # doctest: +SKIP</span>
<span class="sd">            /*</span>
<span class="sd">            * This file was automatically generated using csnake v0.2.1.</span>
<span class="sd">            *</span>
<span class="sd">            * This file should not be edited directly, any changes will be</span>
<span class="sd">            * overwritten next time the script is run.</span>
<span class="sd">            *</span>
<span class="sd">            * Source code for csnake is available at:</span>
<span class="sd">            * https://gitlab.com/andrejr/csnake</span>
<span class="sd">            */</span>

<span class="sd">            With a script name:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; cwr2 = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cwr2.add_autogen_comment(&#39;test.py&#39;)</span>
<span class="sd">            &gt;&gt;&gt; print(cwr2) # doctest: +SKIP</span>
<span class="sd">            /*</span>
<span class="sd">            * This file was automatically generated using csnake v0.2.1.</span>
<span class="sd">            *</span>
<span class="sd">            * This file should not be edited directly, any changes will be</span>
<span class="sd">            * overwritten next time the script is run.</span>
<span class="sd">            * Make any changes to the file &#39;test.py&#39;, not this file.</span>
<span class="sd">            *</span>
<span class="sd">            * Source code for csnake is available at:</span>
<span class="sd">            * https://gitlab.com/andrejr/csnake</span>
<span class="sd">            */</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_comment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&quot;This file was automatically generated using csnake v</span><span class="si">{__version__}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;This file should not be edited directly, any changes will be&quot;</span><span class="p">,</span>
                <span class="s2">&quot;overwritten next time the script is run.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">source_file_name</span><span class="p">:</span>
            <span class="n">source_file_name</span> <span class="o">=</span> <span class="n">assure_str</span><span class="p">(</span><span class="n">source_file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">source_file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;Make any changes to the file &#39;</span><span class="si">{source_file_name}</span><span class="s2">&#39;, not this file.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Source code for csnake is available at:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">SOURCE_URL</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">PYPI_URL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s2">&quot;csnake is also available on PyPI, at :&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{PYPI_URL}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_comment</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.add_license_comment"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_license_comment">[docs]</a>    <span class="k">def</span> <span class="nf">add_license_comment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">license_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">intro</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a comment with the license and authors.</span>

<span class="sd">        The comment also adds the year to the copyright.</span>

<span class="sd">        Args:</span>
<span class="sd">            license\\_: :obj:`str` containing the text of the license</span>
<span class="sd">            authors: optional iterable containing mappings (dict-likes, one per</span>
<span class="sd">                author) with key-value pairs for keys &#39;name&#39; (author&#39;s name)</span>
<span class="sd">                and email (author&#39;s email, optional)</span>

<span class="sd">            intro: introductory text added before the author list, optional</span>
<span class="sd">            year: year of the copyright (optional). If it is left out, current</span>
<span class="sd">                year is assumed.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if any of the arguments is of wrong type</span>

<span class="sd">        Examples:</span>
<span class="sd">            Just license:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; license_text = &#39;license\\ntext\\nlines&#39;</span>
<span class="sd">            &gt;&gt;&gt; cw1 = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cw1.add_license_comment(license_text)</span>
<span class="sd">            &gt;&gt;&gt; print(cw1)</span>
<span class="sd">            /*</span>
<span class="sd">            * license</span>
<span class="sd">            * text</span>
<span class="sd">            * lines</span>
<span class="sd">            */</span>

<span class="sd">            With introduction:</span>

<span class="sd">            &gt;&gt;&gt; intro_text = &#39;intro\\ntext&#39;</span>
<span class="sd">            &gt;&gt;&gt; cw2 = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cw2.add_license_comment(license_text, intro=intro_text)</span>
<span class="sd">            &gt;&gt;&gt; print(cw2)</span>
<span class="sd">            /*</span>
<span class="sd">            * intro</span>
<span class="sd">            * text</span>
<span class="sd">            *</span>
<span class="sd">            * license</span>
<span class="sd">            * text</span>
<span class="sd">            * lines</span>
<span class="sd">            */</span>

<span class="sd">            With authors (and year; year defaults to current year):</span>

<span class="sd">            &gt;&gt;&gt; authors = [</span>
<span class="sd">            ...     {&#39;name&#39;: &#39;Author Surname&#39;},</span>
<span class="sd">            ...     {&#39;name&#39;: &#39;Other Surname&#39;, &#39;email&#39;: &#39;test@email&#39;},</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; cw3 = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cw3.add_license_comment(</span>
<span class="sd">            ...     license_text, authors=authors, intro=intro_text, year=2018</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; print(cw3)</span>
<span class="sd">            /*</span>
<span class="sd">            * intro</span>
<span class="sd">            * text</span>
<span class="sd">            *</span>
<span class="sd">            * Copyright © 2018 Author Surname</span>
<span class="sd">            * Copyright © 2018 Other Surname &lt;test@email&gt;</span>
<span class="sd">            *</span>
<span class="sd">            * license</span>
<span class="sd">            * text</span>
<span class="sd">            * lines</span>
<span class="sd">            */</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_comment</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">intro</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">intro</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">year</span><span class="p">:</span>
            <span class="n">year</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">authors</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
                    <span class="s2">&quot;Copyright © </span><span class="si">{year}</span><span class="s2"> </span><span class="si">{name}{email}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">assure_str</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]),</span>
                        <span class="n">email</span><span class="o">=</span><span class="s2">&quot; &lt;</span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">assure_str</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="n">author</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">license_</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;license_ must be a string.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">license_</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">end_comment</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.add_define"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_define">[docs]</a>    <span class="k">def</span> <span class="nf">add_define</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CExtendedLiteral</span><span class="p">,</span> <span class="n">VariableValue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a define directive for macros.</span>

<span class="sd">        Macros may or may not have a value.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: macro name</span>
<span class="sd">            value: literal or variable assigned to the macro (optional)</span>
<span class="sd">            comment: comment accompanying macro definition</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable, Subscript</span>
<span class="sd">            &gt;&gt;&gt; cwr = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cwr.add_define(&#39;PI&#39;, 3.14)</span>
<span class="sd">            &gt;&gt;&gt; cwr.add_define(&#39;LOG&#39;)</span>
<span class="sd">            &gt;&gt;&gt; somearr = Variable(&#39;some_array&#39;, &#39;int&#39;, value=range(0, 5))</span>
<span class="sd">            &gt;&gt;&gt; cwr.add_define(&#39;DEST&#39;, Subscript(somearr, 2))</span>
<span class="sd">            &gt;&gt;&gt; print(cwr)</span>
<span class="sd">            #define PI 3.14</span>
<span class="sd">            #define LOG</span>
<span class="sd">            #define DEST some_array[2]</span>

<span class="sd">        Todo:</span>

<span class="sd">            - Make a class (within the :mod:`cconstructs`) representing a</span>
<span class="sd">              macro, so that object-type defines may be used as initializers.</span>
<span class="sd">            - Add support for function-like macros.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">assure_str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;#define </span><span class="si">{name}{value}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="n">value</span><span class="o">=</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">generate_c_value_initializer</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.start_if_def"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.start_if_def">[docs]</a>    <span class="k">def</span> <span class="nf">start_if_def</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">define</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start an :ccode:`#ifdef` or :ccode:`#ifndef` (preprocessor) block.</span>

<span class="sd">        :ccode:`#ifdef` (or :ccode:`#ifndef`) blocks can be nested.</span>
<span class="sd">        :ccode:`#endif` always ends the innermost block. :ccode:`endif`</span>
<span class="sd">        statements are added by :meth:`end_if_def`.</span>

<span class="sd">        Args:</span>
<span class="sd">            define: name of the macro whose existence we&#39;re checking.</span>

<span class="sd">            invert: (optional) whether this block is an :ccode:`#ifndef`</span>
<span class="sd">                (:code:`True`) or :ccode:`#ifdef` (:code:`False`, default).</span>

<span class="sd">            comment: (optional) comment accompanying the statement.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if one of the arguments is of the wrong type.</span>

<span class="sd">        Examples:</span>
<span class="sd">            :meth:`start_if_def` and :meth:`end_if_def` in action, including</span>
<span class="sd">            nested ifdefs:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; cwr = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cwr.start_if_def(&#39;DEBUG&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cwr.start_if_def(&#39;ARM&#39;, invert=True)</span>
<span class="sd">            &gt;&gt;&gt; cwr.add_define(&#39;LOG&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cwr.end_if_def()</span>
<span class="sd">            &gt;&gt;&gt; cwr.end_if_def()</span>
<span class="sd">            &gt;&gt;&gt; print(cwr)</span>
<span class="sd">            #ifdef DEBUG</span>
<span class="sd">            #ifndef ARM</span>
<span class="sd">            #define LOG</span>
<span class="sd">            #endif /* ARM */</span>
<span class="sd">            #endif /* DEBUG */</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">define</span><span class="p">)</span>

        <span class="n">define</span> <span class="o">=</span> <span class="n">assure_str</span><span class="p">(</span><span class="n">define</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">invert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;#ifndef </span><span class="si">{define}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;#ifdef </span><span class="si">{define}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.end_if_def"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.end_if_def">[docs]</a>    <span class="k">def</span> <span class="nf">end_if_def</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_ifdef_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert an :ccode:`#endif` to end a :ccode:`#ifdef` (preprocessor) block.</span>

<span class="sd">        :ccode:`#ifdef` (or :ccode:`#ifndef`) blocks can be nested.</span>
<span class="sd">        :ccode:`#endif` always ends the innermost block. :ccode:`endif`</span>
<span class="sd">        statements are added by :meth:`end_if_def`.</span>

<span class="sd">        Args:</span>
<span class="sd">            ignore_ifdef_stack: (optional) don&#39;t throw an exception</span>
<span class="sd">                :ccode:`#endif` if is unmatched.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if one of the arguments is of the wrong type.</span>

<span class="sd">            DefStackEmptyError: if there isn&#39;t a matching :code:`#ifdef` and</span>
<span class="sd">                :obj:`ignore_ifdef_stack` isn&#39;t set.</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_if_def`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">def_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_def_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ignore_ifdef_stack</span><span class="p">:</span>
                <span class="n">def_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DefStackEmptyError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s2">&quot;#endif&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">def_name</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.cpp_entry"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.cpp_entry">[docs]</a>    <span class="k">def</span> <span class="nf">cpp_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start a conditional :ccode:`extern &quot;C&quot;` for use CPP compilers.</span>

<span class="sd">        Examples:</span>
<span class="sd">            :meth:`cpp_entry` and :meth:`cpp_exit` in action:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; cwr = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cwr.cpp_entry()</span>
<span class="sd">            &gt;&gt;&gt; cwr.add_line(&#39;some_code();&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cwr.cpp_exit()</span>
<span class="sd">            &gt;&gt;&gt; print(cwr)</span>
<span class="sd">            #ifdef __cplusplus</span>
<span class="sd">            extern &quot;C&quot; {</span>
<span class="sd">            #endif /* __cplusplus */</span>
<span class="sd">            some_code();</span>
<span class="sd">            #ifdef __cplusplus</span>
<span class="sd">            }</span>
<span class="sd">            #endif /* __cplusplus */</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_if_def</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CPP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;extern &quot;C&quot; {&#39;</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_if_def</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.cpp_exit"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.cpp_exit">[docs]</a>    <span class="k">def</span> <span class="nf">cpp_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;End a conditional :ccode:`extern &quot;C&quot;` for use CPP compilers.</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`cpp_entry`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_if_def</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CPP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_if_def</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.start_switch"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.start_switch">[docs]</a>    <span class="k">def</span> <span class="nf">start_switch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">switch</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CExtendedLiteral</span><span class="p">,</span> <span class="n">VariableValue</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start a switch statement.</span>

<span class="sd">        Used with :meth:`end_switch`, :meth:`add_switch_case`,</span>
<span class="sd">        :meth:`add_switch_default`, :meth:`add_switch_break`,</span>
<span class="sd">        :meth:`add_switch_return`, to form C switch statements.</span>

<span class="sd">        Switch statements can be nested, so :meth:`end_switch` closes the</span>
<span class="sd">        innermost switch.</span>

<span class="sd">        Args:</span>
<span class="sd">            switch: literal or variable the choice depends on.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Demonstration of switch-related methods:</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; var = Variable(&quot;somevar&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; case_var = Variable(&quot;case_var&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; cw.start_switch(var)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_case(2)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_line(&#39;do_something();&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_break()</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_case(case_var)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_return(5)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_default()</span>
<span class="sd">            &gt;&gt;&gt; cw.add_switch_return(8)</span>
<span class="sd">            &gt;&gt;&gt; cw.end_switch()</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            switch (somevar)</span>
<span class="sd">            {</span>
<span class="sd">                case 2:</span>
<span class="sd">                    do_something();</span>
<span class="sd">                    break;</span>
<span class="sd">                case case_var:</span>
<span class="sd">                    return 5;</span>
<span class="sd">                default:</span>
<span class="sd">                    return 8;</span>
<span class="sd">            } /* ~switch (somevar) */</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">switch_str</span> <span class="o">=</span> <span class="n">generate_c_value_initializer</span><span class="p">(</span><span class="n">switch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_switch_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">switch_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;switch (</span><span class="si">{switch_str}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_brace</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.end_switch"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.end_switch">[docs]</a>    <span class="k">def</span> <span class="nf">end_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_switch_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;End a switch statement.</span>

<span class="sd">        Used with :meth:`start_switch`, :meth:`add_switch_case`,</span>
<span class="sd">        :meth:`add_switch_default`, :meth:`add_switch_break`,</span>
<span class="sd">        :meth:`add_switch_return`, to form C switch statements.</span>

<span class="sd">        Switch statements can be nested, so :meth:`end_switch` closes the</span>
<span class="sd">        innermost switch.</span>

<span class="sd">        Args:</span>
<span class="sd">            ignore_switch_stack: don&#39;t throw an exception if a switch start is</span>
<span class="sd">                missing</span>

<span class="sd">        Raises:</span>
<span class="sd">            SwitchStackEmptyError: if :meth:`end_switch` is called outside of a</span>
<span class="sd">            switch statement, and :obj:`ignore_switch_stack` is :code:`False`.</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_switch`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_brace</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">switch_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_switch_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ignore_switch_stack</span><span class="p">:</span>
                <span class="n">switch_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SwitchStackEmptyError</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">switch_name</span> <span class="o">=</span> <span class="n">switch_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot; /* ~switch (</span><span class="si">{switch_name}</span><span class="s2">) */&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_switch_case"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_switch_case">[docs]</a>    <span class="k">def</span> <span class="nf">add_switch_case</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="n">Union</span><span class="p">[</span><span class="n">CExtendedLiteral</span><span class="p">,</span> <span class="n">VariableValue</span><span class="p">],</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a switch case statement.</span>

<span class="sd">        Used with :meth:`start_switch`, :meth:`end_switch`,</span>
<span class="sd">        :meth:`add_switch_default`, :meth:`add_switch_break`,</span>
<span class="sd">        :meth:`add_switch_return`, to form C switch statements.</span>

<span class="sd">        Args:</span>
<span class="sd">            case: literal or variable representing the current case&#39;s value</span>
<span class="sd">            comment: accompanying inline comment</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_switch`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&quot;case {generate_c_value_initializer(case)}:&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.add_switch_default"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_switch_default">[docs]</a>    <span class="k">def</span> <span class="nf">add_switch_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a switch default statement.</span>

<span class="sd">        Used with :meth:`start_switch`, :meth:`end_switch`,</span>
<span class="sd">        :meth:`add_switch_case`, :meth:`add_switch_break`,</span>
<span class="sd">        :meth:`add_switch_return`, to form C switch statements.</span>

<span class="sd">        Switch statements can be nested, so :meth:`end_switch` closes the</span>
<span class="sd">        innermost switch.</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_switch`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s2">&quot;default:&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.add_switch_break"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_switch_break">[docs]</a>    <span class="k">def</span> <span class="nf">add_switch_break</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Break a switch case.</span>

<span class="sd">        Used with :meth:`start_switch`, :meth:`end_switch`,</span>
<span class="sd">        :meth:`add_switch_case`, :meth:`add_switch_default`,</span>
<span class="sd">        :meth:`add_switch_return`, to form C switch statements.</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_switch`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s2">&quot;break;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dedent</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.add_switch_return"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_switch_return">[docs]</a>    <span class="k">def</span> <span class="nf">add_switch_return</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CExtendedLiteral</span><span class="p">,</span> <span class="n">VariableValue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return inside of a switch statement</span>

<span class="sd">        Used with :meth:`start_switch`, :meth:`end_switch`,</span>
<span class="sd">        :meth:`add_switch_case`, :meth:`add_switch_default`,</span>
<span class="sd">        :meth:`add_switch_break`, to form C switch statements.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: literal or variable representing the value to return</span>

<span class="sd">        Examples:</span>
<span class="sd">            See :meth:`start_switch`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
            <span class="s2">&quot;return</span><span class="si">{val}</span><span class="s2">;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">val</span><span class="o">=</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">generate_c_value_initializer</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dedent</span><span class="p">()</span></div>

<div class="viewcode-block" id="CodeWriter.include"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.include">[docs]</a>    <span class="k">def</span> <span class="nf">include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an :ccode:`#include` directive.</span>

<span class="sd">        System headers should be surrounded with brackets `(&lt;&gt;)`, while local</span>
<span class="sd">        headers may or may not be surrounded with quotation marks `(&quot;&quot;)` (the</span>
<span class="sd">        resulting code will have quotation marks surrounding the header&#39;s name)</span>

<span class="sd">        Args:</span>
<span class="sd">            name: name of header to include, with or without brackets/quotes.</span>
<span class="sd">                If no brackets/quotes surround the name, quotes are used by</span>
<span class="sd">                default.</span>

<span class="sd">            comment: accompanying inline comment</span>

<span class="sd">        Examples:</span>
<span class="sd">            All types of includes.</span>

<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; cw.include(&#39;&quot;some_local_header.h&quot;&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cw.include(&#39;other_local_header.h&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cw.include(&quot;&lt;string.h&gt;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            #include &quot;some_local_header.h&quot;</span>
<span class="sd">            #include &quot;other_local_header.h&quot;</span>
<span class="sd">            #include &lt;string.h&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(&lt;.*&gt;|&quot;.*&quot;)$&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;&quot;</span><span class="si">{name}</span><span class="s1">&quot;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
            <span class="s2">&quot;#include </span><span class="si">{name}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">),</span>
            <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
            <span class="n">ignore_indent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_enum"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_enum">[docs]</a>    <span class="k">def</span> <span class="nf">add_enum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum</span><span class="p">:</span> <span class="n">Enum</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an enumeration definition.</span>

<span class="sd">        Args:</span>
<span class="sd">            enum: enum in question</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Enum` for details on the `enum` class</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import (</span>
<span class="sd">            ...     CodeWriter, Enum, Variable, Dereference, AddressOf</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; name = &quot;somename&quot;</span>
<span class="sd">            &gt;&gt;&gt; pfx = &quot;pfx&quot;</span>
<span class="sd">            &gt;&gt;&gt; typedef = False</span>
<span class="sd">            &gt;&gt;&gt; enum = Enum(name, prefix=pfx, typedef=typedef)</span>
<span class="sd">            &gt;&gt;&gt; cval1 = Variable(&quot;varname&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; enum.add_value(&quot;val1&quot;, 1)</span>
<span class="sd">            &gt;&gt;&gt; enum.add_value(&quot;val2&quot;, Dereference(1000))</span>
<span class="sd">            &gt;&gt;&gt; enum.add_value(&quot;val3&quot;, cval1)</span>
<span class="sd">            &gt;&gt;&gt; enum.add_value(&quot;val4&quot;, AddressOf(cval1), &quot;some comment&quot;)</span>
<span class="sd">            &gt;&gt;&gt; cw.add_enum(enum)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            enum somename</span>
<span class="sd">            {</span>
<span class="sd">                pfxval1 = 1,</span>
<span class="sd">                pfxval2 = *1000,</span>
<span class="sd">                pfxval3 = varname,</span>
<span class="sd">                pfxval4 = &amp;varname /* some comment */</span>
<span class="sd">            };</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;enum must be of type &quot;Enum&quot;&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">generate_declaration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indent_unit</span><span class="p">)</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_variable_declaration"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_variable_declaration">[docs]</a>    <span class="k">def</span> <span class="nf">add_variable_declaration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">extern</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a variable&#39;s declaration.</span>

<span class="sd">        Args:</span>
<span class="sd">            variable: variable in question</span>
<span class="sd">            extern: wheter to add the :ccode:`extern` qualifier to the</span>
<span class="sd">            declaration (`True`) or not (`False`, default)</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Variable` for details on the `Variable` class</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; var = Variable(</span>
<span class="sd">            ...     &quot;test&quot;,</span>
<span class="sd">            ...     primitive=&quot;int&quot;,</span>
<span class="sd">            ...     value=np.arange(24).reshape((2, 3, 4))</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; cw.add_variable_declaration(var)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            int test[2][3][4];</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;variable must be of type &#39;Variable&#39;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span>
            <span class="n">variable</span><span class="o">.</span><span class="n">generate_declaration</span><span class="p">(</span><span class="n">extern</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
            <span class="n">comment</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">comment</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_variable_initialization"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_variable_initialization">[docs]</a>    <span class="k">def</span> <span class="nf">add_variable_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="n">Variable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a variable&#39;s initialization.</span>

<span class="sd">        Args:</span>
<span class="sd">            variable: variable in question</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Variable` for details on the `Variable` class</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; var = Variable(</span>
<span class="sd">            ...     &quot;test&quot;,</span>
<span class="sd">            ...     primitive=&quot;int&quot;,</span>
<span class="sd">            ...     value=np.arange(24).reshape((2, 3, 4))</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; cw.add_variable_initialization(var)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            int test[2][3][4] = {</span>
<span class="sd">                {</span>
<span class="sd">                    {0, 1, 2, 3},</span>
<span class="sd">                    {4, 5, 6, 7},</span>
<span class="sd">                    {8, 9, 10, 11}</span>
<span class="sd">                },</span>
<span class="sd">                {</span>
<span class="sd">                    {12, 13, 14, 15},</span>
<span class="sd">                    {16, 17, 18, 19},</span>
<span class="sd">                    {20, 21, 22, 23}</span>
<span class="sd">                }</span>
<span class="sd">            };</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;variable must be of type &#39;Variable&#39;&quot;</span><span class="p">)</span>

        <span class="n">init_cwr</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">generate_initialization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indent_unit</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">init_cwr</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">init_cwr</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_struct"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_struct">[docs]</a>    <span class="k">def</span> <span class="nf">add_struct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">struct</span><span class="p">:</span> <span class="n">Struct</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a struct declaration.</span>

<span class="sd">        Args:</span>
<span class="sd">            struct: struct in question</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Struct` for details on the `Struct` class.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable, Struct</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; strct = Struct(&quot;strname&quot;, typedef=False)</span>
<span class="sd">            &gt;&gt;&gt; var1 = Variable(&quot;var1&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; var2 = Variable(&quot;var2&quot;, &quot;int&quot;, value=range(10))</span>
<span class="sd">            &gt;&gt;&gt; strct.add_variable(var1)</span>
<span class="sd">            &gt;&gt;&gt; strct.add_variable(var2)</span>
<span class="sd">            &gt;&gt;&gt; strct.add_variable((&quot;var3&quot;, &quot;int&quot;))</span>
<span class="sd">            &gt;&gt;&gt; strct.add_variable({&quot;name&quot;: &quot;var4&quot;, &quot;primitive&quot;: &quot;int&quot;})</span>
<span class="sd">            &gt;&gt;&gt; cw.add_struct(strct)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            struct strname</span>
<span class="sd">            {</span>
<span class="sd">                int var1;</span>
<span class="sd">                int var2[10];</span>
<span class="sd">                int var3;</span>
<span class="sd">                int var4;</span>
<span class="sd">            };</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">Struct</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;struct must be of type &#39;Struct&#39;&quot;</span><span class="p">)</span>

        <span class="n">declaration</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">generate_declaration</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_indent_unit</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declaration</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>  <span class="c1"># mypy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">declaration</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_function_prototype"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_function_prototype">[docs]</a>    <span class="k">def</span> <span class="nf">add_function_prototype</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Function</span><span class="p">,</span> <span class="n">extern</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a functions&#39;s prototype.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: function in question</span>
<span class="sd">            extern: wheter to add the :ccode:`extern` qualifier to the</span>
<span class="sd">            prototype (`True`) or not (`False`, default)</span>
<span class="sd">            comment: accompanying inline comment</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Function` for details on the `Function` class</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable, Function</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; arg1 = Variable(&quot;arg1&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg2 = Variable(&quot;arg2&quot;, &quot;int&quot;, value=range(10))</span>
<span class="sd">            &gt;&gt;&gt; arg3 = (&quot;arg3&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg4 = {&quot;name&quot;: &quot;arg4&quot;, &quot;primitive&quot;: &quot;int&quot;}</span>
<span class="sd">            &gt;&gt;&gt; fun = Function(</span>
<span class="sd">            ...     &quot;testfunct&quot;, &quot;void&quot;, arguments=(arg1, arg2, arg3, arg4)</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; fun.add_code((&quot;code;&quot;, &quot;more_code;&quot;))</span>
<span class="sd">            &gt;&gt;&gt; cw.add_function_prototype(fun)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            void testfunct(int arg1, int arg2[10], int arg3, int arg4);</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func must be of type &#39;Function&#39;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">generate_prototype</span><span class="p">(</span><span class="n">extern</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_function_definition"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_function_definition">[docs]</a>    <span class="k">def</span> <span class="nf">add_function_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a functions&#39;s definition / implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: function in question</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Function` for details on the `Function` class</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable, Function</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; arg1 = Variable(&quot;arg1&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg2 = Variable(&quot;arg2&quot;, &quot;int&quot;, value=range(10))</span>
<span class="sd">            &gt;&gt;&gt; arg3 = (&quot;arg3&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg4 = {&quot;name&quot;: &quot;arg4&quot;, &quot;primitive&quot;: &quot;int&quot;}</span>
<span class="sd">            &gt;&gt;&gt; fun = Function(</span>
<span class="sd">            ...     &quot;testfunct&quot;, &quot;void&quot;, arguments=(arg1, arg2, arg3, arg4)</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; fun.add_code((&quot;code;&quot;, &quot;more_code;&quot;))</span>
<span class="sd">            &gt;&gt;&gt; cw.add_function_definition(fun)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            void testfunct(int arg1, int arg2[10], int arg3, int arg4)</span>
<span class="sd">            {</span>
<span class="sd">                code;</span>
<span class="sd">                more_code;</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument func must be of type &#39;Function&#39;&quot;</span><span class="p">)</span>

        <span class="n">definition</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">generate_definition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indent_unit</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">definition</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>  <span class="c1"># mypy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_lines</span><span class="p">(</span><span class="n">definition</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.add_function_call"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.add_function_call">[docs]</a>    <span class="k">def</span> <span class="nf">add_function_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Function</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a call to a function with listed arguments.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: function in question</span>
<span class="sd">            \\*arg: (rest of the args) function&#39;s args in sequence</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`Function` for details on the `Function` class</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from csnake import CodeWriter, Variable, Function</span>
<span class="sd">            &gt;&gt;&gt; cw = CodeWriter()</span>
<span class="sd">            &gt;&gt;&gt; arg1 = Variable(&quot;arg1&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg2 = Variable(&quot;arg2&quot;, &quot;int&quot;, value=range(10))</span>
<span class="sd">            &gt;&gt;&gt; arg3 = (&quot;arg3&quot;, &quot;int&quot;)</span>
<span class="sd">            &gt;&gt;&gt; arg4 = {&quot;name&quot;: &quot;arg4&quot;, &quot;primitive&quot;: &quot;int&quot;}</span>
<span class="sd">            &gt;&gt;&gt; fun = Function(</span>
<span class="sd">            ...     &quot;testfunct&quot;, &quot;void&quot;, arguments=(arg1, arg2, arg3, arg4)</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; fun.add_code((&quot;code;&quot;, &quot;more_code;&quot;))</span>
<span class="sd">            &gt;&gt;&gt; cw.add_function_call(fun, 1, 2, 3, 4)</span>
<span class="sd">            &gt;&gt;&gt; print(cw)</span>
<span class="sd">            testfunct(1, 2, 3, 4);</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;func must be of type &#39;Function&#39;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">generate_call</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeWriter.write_to_file"><a class="viewcode-back" href="../../api.html#csnake.CodeWriter.write_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write code to filename.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: name of the file to write code into</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
            <span class="n">openfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">csnake</a></h1>



<p class="blurb">C code generation package</p>






<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Developer Interface (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Andrej Radović.
      
    </div>

    

    
  </body>
</html>