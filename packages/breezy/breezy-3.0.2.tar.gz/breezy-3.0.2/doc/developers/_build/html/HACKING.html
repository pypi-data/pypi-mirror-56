
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Breezy Developer Guide &#8212; Breezy 3.0.2dev documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>

    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Breezy Testing Guide" href="testing.html" />
    <link rel="prev" title="Tracking Bugs in Breezy" href="bug-handling.html" />
<link rel="stylesheet" href="_static/brz-doc.css" type="text/css" />
 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Developer Document Catalog (3.0.2dev)</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="bug-handling.html" title="Tracking Bugs in Breezy"
             accesskey="P">previous</a> |
          <a href="testing.html" title="Breezy Testing Guide"
             accesskey="N">next</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="breezy-developer-guide">
<h1>Breezy Developer Guide<a class="headerlink" href="#breezy-developer-guide" title="Permalink to this headline">¶</a></h1>
<p>This document describes the Breezy internals and the development process.
It’s meant for people interested in developing Breezy, and some parts will
also be useful to people developing Breezy plugins.</p>
<p>If you have any questions or something seems to be incorrect, unclear or
missing, please talk to us in <code class="docutils literal notranslate"><span class="pre">irc://irc.freenode.net/#bzr</span></code>, or write to
the Breezy mailing list.  To propose a correction or addition to this
document, send a merge request or new text to the mailing list.</p>
<p>The latest developer documentation can be found online at
<a class="reference external" href="https://www.breezy-vcs.org/developers/">https://www.breezy-vcs.org/developers/</a>.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exploring-the-breezy-platform">
<h3>Exploring the Breezy Platform<a class="headerlink" href="#exploring-the-breezy-platform" title="Permalink to this headline">¶</a></h3>
<p>Before making changes, it’s a good idea to explore the work already
done by others. Perhaps the new feature or improvement you’re looking
for is available in another plug-in already? If you find a bug,
perhaps someone else has already fixed it?</p>
<p>To answer these questions and more, take a moment to explore the
overall Breezy Platform. Here are some links to browse:</p>
<ul class="simple">
<li><p>The Plugins page on the Wiki - <a class="reference external" href="http://wiki.bazaar.canonical.com/BzrPlugins">http://wiki.bazaar.canonical.com/BzrPlugins</a></p></li>
<li><p>The Breezy product family on Launchpad - <a class="reference external" href="https://launchpad.net/breezy">https://launchpad.net/breezy</a></p></li>
<li><p>Bug Tracker for the core product - <a class="reference external" href="https://bugs.launchpad.net/brz/">https://bugs.launchpad.net/brz/</a></p></li>
</ul>
<p>If nothing else, perhaps you’ll find inspiration in how other developers
have solved their challenges.</p>
</div>
<div class="section" id="finding-something-to-do">
<h3>Finding Something To Do<a class="headerlink" href="#finding-something-to-do" title="Permalink to this headline">¶</a></h3>
<p>Ad-hoc performance work can also be done. One useful tool is the ‘evil’ debug
flag. For instance running <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">-Devil</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&quot;test&quot;</span></code> will log a backtrace
to the Breezy log file for every method call which triggers a slow or non-scalable
part of the breezy library. So checking that a given command with <code class="docutils literal notranslate"><span class="pre">-Devil</span></code> has
no backtraces logged to the log file is a good way to find problem function
calls that might be nested deep in the code base.</p>
</div>
<div class="section" id="planning-and-discussing-changes">
<h3>Planning and Discussing Changes<a class="headerlink" href="#planning-and-discussing-changes" title="Permalink to this headline">¶</a></h3>
<p>There is a very active community around Breezy. Mostly we meet on IRC
(#bzr on irc.freenode.net) and on the mailing list. To join the Breezy
community, see <a class="reference external" href="https://www.breezy-vcs.org/pages/support.html">https://www.breezy-vcs.org/pages/support.html</a>.</p>
<p>If you are planning to make a change, it’s a very good idea to mention it
on the IRC channel and/or on the mailing list. There are many advantages
to involving the community before you spend much time on a change.
These include:</p>
<ul class="simple">
<li><p>you get to build on the wisdom of others, saving time</p></li>
<li><p>if others can direct you to similar code, it minimises the work to be done</p></li>
<li><p>it assists everyone in coordinating direction, priorities and effort.</p></li>
</ul>
<p>In summary, maximising the input from others typically minimises the
total effort required to get your changes merged. The community is
friendly, helpful and always keen to welcome newcomers.</p>
</div>
<div class="section" id="breezy-development-in-a-nutshell">
<h3>Breezy Development in a Nutshell<a class="headerlink" href="#breezy-development-in-a-nutshell" title="Permalink to this headline">¶</a></h3>
<p>One of the fun things about working on a version control system like Breezy is
that the users have a high level of proficiency in contributing back into
the tool.  Consider the following very brief introduction to contributing back
to Breezy.  More detailed instructions are in the following sections.</p>
<div class="section" id="making-the-change">
<h4>Making the change<a class="headerlink" href="#making-the-change" title="Permalink to this headline">¶</a></h4>
<p>First, get a local copy of the development mainline (See <a class="reference internal" href="#why-make-a-local-copy-of-bzr-dev">Why make a local
copy of bzr.dev?</a>.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz init-repo ~/bzr
$ cd ~/bzr
$ brz branch lp:brz bzr.dev
</pre></div>
</div>
<p>Now make your own branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz branch bzr.dev 123456-my-bugfix
</pre></div>
</div>
<p>This will give you a branch called “123456-my-bugfix” that you can work on
and commit in. Here, you can study the code, make a fix or a new feature.
Feel free to commit early and often (after all, it’s your branch!).</p>
<p>Documentation improvements are an easy place to get started giving back to the
Breezy project.  The documentation is in the <cite>doc/</cite> subdirectory of the Breezy
source tree.</p>
<p>When you are done, make sure that you commit your last set of changes as well!
Once you are happy with your changes, ask for them to be merged, as described
below.</p>
</div>
<div class="section" id="making-a-merge-proposal">
<h4>Making a Merge Proposal<a class="headerlink" href="#making-a-merge-proposal" title="Permalink to this headline">¶</a></h4>
<p>The Breezy developers use Launchpad to further enable a truly distributed
style of development.  Anyone can propose a branch for merging into the Breezy
trunk.  To start this process, you need to push your branch to Launchpad.  To
do this, you will need a Launchpad account and user name, e.g.
<cite>your_lp_username</cite>.  You can push your branch to Launchpad directly from
Breezy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brz push lp:~&lt;your_lp_username&gt;/bzr/meaningful_name_here
</pre></div>
</div>
<p>After you have pushed your branch, you will need to propose it for merging to
the Breezy trunk.  Go to
&lt;<a class="reference external" href="https://launchpad.net">https://launchpad.net</a>/~&lt;your_lp_username&gt;/bzr/meaningful_name_here&gt; and choose
“Propose for merging into another branch”.  Select “lp:bzr” to hand
your changes off to the Breezy developers for review and merging.</p>
<p>Alternatively, after pushing you can use the <code class="docutils literal notranslate"><span class="pre">propose</span></code> command to
create the merge proposal.</p>
<p>Using a meaningful name for your branch will help you and the reviewer(s)
better track the submission. Use a very succint description of your submission
and prefix it with bug number if needed (lp:~mbp/bzr/484558-merge-directory
for example). Alternatively, you can suffix with the bug number
(lp:~jameinel/bzr/export-file-511987).</p>
</div>
<div class="section" id="review-cover-letters">
<h4>Review cover letters<a class="headerlink" href="#review-cover-letters" title="Permalink to this headline">¶</a></h4>
<p>Please put a “cover letter” on your merge request explaining:</p>
<ul class="simple">
<li><p>the reason <strong>why</strong> you’re making this change</p></li>
<li><p><strong>how</strong> this change achieves this purpose</p></li>
<li><p>anything else you may have fixed in passing</p></li>
<li><p>anything significant that you thought of doing, such as a more
extensive fix or a different approach, but didn’t or couldn’t do now</p></li>
</ul>
<p>A good cover letter makes reviewers’ lives easier because they can decide
from the letter whether they agree with the purpose and approach, and then
assess whether the patch actually does what the cover letter says.
Explaining any “drive-by fixes” or roads not taken may also avoid queries
from the reviewer.  All in all this should give faster and better reviews.
Sometimes writing the cover letter helps the submitter realize something
else they need to do.  The size of the cover letter should be proportional
to the size and complexity of the patch.</p>
</div>
<div class="section" id="why-make-a-local-copy-of-bzr-dev">
<h4>Why make a local copy of bzr.dev?<a class="headerlink" href="#why-make-a-local-copy-of-bzr-dev" title="Permalink to this headline">¶</a></h4>
<p>Making a local mirror of bzr.dev is not strictly necessary, but it means</p>
<ul>
<li><p>You can use that copy of bzr.dev as your main brz executable, and keep it
up-to-date using <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">pull</span></code>.</p></li>
<li><p>Certain operations are faster, and can be done when offline.  For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">bundle</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span> <span class="pre">-r</span> <span class="pre">ancestor:...</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">merge</span></code></p></li>
</ul>
</li>
<li><p>When it’s time to create your next branch, it’s more convenient.  When you
have further contributions to make, you should do them in their own branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd ~/bzr
$ brz branch bzr.dev additional_fixes
$ cd additional_fixes # hack, hack, hack
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="understanding-the-development-process">
<h3>Understanding the Development Process<a class="headerlink" href="#understanding-the-development-process" title="Permalink to this headline">¶</a></h3>
<p>The development team follows many practices including:</p>
<ul class="simple">
<li><p>a public roadmap and planning process in which anyone can participate</p></li>
<li><p>time based milestones everyone can work towards and plan around</p></li>
<li><p>extensive code review and feedback to contributors</p></li>
<li><p>complete and rigorous test coverage on any code contributed</p></li>
<li><p>automated validation that all tests still pass before code is merged
into the main code branch.</p></li>
</ul>
<p>The key tools we use to enable these practices are:</p>
<ul class="simple">
<li><p>Launchpad - <a class="reference external" href="https://launchpad.net/">https://launchpad.net/</a></p></li>
<li><p>Breezy - <a class="reference external" href="https://www.breezy-vcs.org/">https://www.breezy-vcs.org/</a></p></li>
<li><p>Patch Queue Manager - <a class="reference external" href="https://launchpad.net/pqm/">https://launchpad.net/pqm/</a></p></li>
</ul>
<p>For further information, see &lt;<a class="reference external" href="https://www.breezy-vcs.org/developers/">https://www.breezy-vcs.org/developers/</a>&gt;.</p>
</div>
<div class="section" id="preparing-a-sandbox-for-making-changes-to-breezy">
<h3>Preparing a Sandbox for Making Changes to Breezy<a class="headerlink" href="#preparing-a-sandbox-for-making-changes-to-breezy" title="Permalink to this headline">¶</a></h3>
<p>Breezy supports many ways of organising your work. See
<a class="reference external" href="http://wiki.bazaar.canonical.com/SharedRepositoryLayouts">http://wiki.bazaar.canonical.com/SharedRepositoryLayouts</a> for a summary of the
popular alternatives.</p>
<p>Of course, the best choice for you will depend on numerous factors:
the number of changes you may be making, the complexity of the changes, etc.
As a starting suggestion though:</p>
<ul>
<li><p>create a local copy of the main development branch (bzr.dev) by using
this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brz</span> <span class="n">branch</span> <span class="n">lp</span><span class="p">:</span><span class="n">brz</span> <span class="n">bzr</span><span class="o">.</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>keep your copy of bzr.dev pristine (by not developing in it) and keep
it up to date (by using brz pull)</p></li>
<li><p>create a new branch off your local bzr.dev copy for each issue
(bug or feature) you are working on.</p></li>
</ul>
<p>This approach makes it easy to go back and make any required changes
after a code review. Resubmitting the change is then simple with no
risk of accidentally including edits related to other issues you may
be working on. After the changes for an issue are accepted and merged,
the associated branch can be deleted or archived as you wish.</p>
</div>
<div class="section" id="navigating-the-code-base">
<h3>Navigating the Code Base<a class="headerlink" href="#navigating-the-code-base" title="Permalink to this headline">¶</a></h3>
<p>Some of the key files in this directory are:</p>
<dl class="simple">
<dt>bzr</dt><dd><p>The command you run to start Breezy itself.  This script is pretty
short and just does some checks then jumps into bzrlib.</p>
</dd>
<dt>README.rst</dt><dd><p>This file covers a brief introduction to Breezy and lists some of its
key features.</p>
</dd>
<dt>setup.py</dt><dd><p>Installs Breezy system-wide or to your home directory.  To perform
development work on Breezy it is not required to run this file - you
can simply run the Breezy command from the top level directory of your
development copy. Note: That if you run setup.py this will create a
‘build’ directory in your development branch. There’s nothing wrong
with this but don’t be confused by it. The build process puts a copy
of the main code base into this build directory, along with some other
files. You don’t need to go in here for anything discussed in this
guide.</p>
</dd>
<dt>bzrlib</dt><dd><p>Possibly the most exciting folder of all, bzrlib holds the main code
base. This is where you will go to edit python files and contribute to
Breezy.</p>
</dd>
<dt>doc</dt><dd><p>Holds documentation on a whole range of things on Breezy from the
origination of ideas within the project to information on Breezy
features and use cases.  Within this directory there is a subdirectory
for each translation into a human language.  All the documentation
is in the ReStructuredText markup language.</p>
</dd>
<dt>doc/developers</dt><dd><p>Documentation specifically targeted at Breezy and plugin developers.
(Including this document.)</p>
</dd>
</dl>
<p>doc/en/release-notes/</p>
<blockquote>
<div><p>Detailed changes in each Breezy release (there is one file by series:
bzr-2.3.txt, bzr-2.4.txt, etc) that can affect users or plugin
developers.</p>
</div></blockquote>
<p>doc/en/whats-new/</p>
<blockquote>
<div><p>High-level summaries of changes in each Breezy release (there is one
file by series: whats-new-in-2.3.txt, whats-new-in-2.4.txt, etc).</p>
</div></blockquote>
<p>Automatically-generated API reference information is available at
&lt;<a class="reference external" href="https://www.breezy-vcs.org/developers/api/">https://www.breezy-vcs.org/developers/api/</a>&gt;.</p>
<p>See also the <a class="reference external" href="https://www.breezy-vcs.org/developers/overview.html">Breezy Architectural Overview</a>.</p>
</div>
</div>
<div class="section" id="core-topics">
<h2>Core Topics<a class="headerlink" href="#core-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="evolving-interfaces">
<h3>Evolving Interfaces<a class="headerlink" href="#evolving-interfaces" title="Permalink to this headline">¶</a></h3>
<p>We don’t change APIs in stable branches: any supported symbol in a stable
release of Breezy must not be altered in any way that would result in
breaking existing code that uses it. That means that method names,
parameter ordering, parameter names, variable and attribute names etc must
not be changed without leaving a ‘deprecated forwarder’ behind. This even
applies to modules and classes.</p>
<p>If you wish to change the behaviour of a supported API in an incompatible
way, you need to change its name as well. For instance, if I add an optional keyword
parameter to branch.commit - that’s fine. On the other hand, if I add a
keyword parameter to branch.commit which is a <em>required</em> transaction
object, I should rename the API - i.e. to ‘branch.commit_transaction’.</p>
<blockquote>
<div><p>(Actually, that may break code that provides a new implementation of
<code class="docutils literal notranslate"><span class="pre">commit</span></code> and doesn’t expect to receive the parameter.)</p>
</div></blockquote>
<p>When renaming such supported API’s, be sure to leave a deprecated_method (or
_function or …) behind which forwards to the new API. See the
bzrlib.symbol_versioning module for decorators that take care of the
details for you - such as updating the docstring, and issuing a warning
when the old API is used.</p>
<p>For unsupported API’s, it does not hurt to follow this discipline, but it’s
not required. Minimally though, please try to rename things so that
callers will at least get an AttributeError rather than weird results.</p>
<div class="section" id="deprecation-decorators">
<h4>Deprecation decorators<a class="headerlink" href="#deprecation-decorators" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">bzrlib.symbol_versioning</span></code> provides decorators that can be attached to
methods, functions, and other interfaces to indicate that they should no
longer be used.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@deprecated_method</span><span class="p">(</span><span class="n">deprecated_in</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_foo</span><span class="p">()</span>
</pre></div>
</div>
<p>To deprecate a static method you must call <code class="docutils literal notranslate"><span class="pre">deprecated_function</span></code>
(<strong>not</strong> method), after the staticmethod call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@staticmethod</span>
<span class="nd">@deprecated_function</span><span class="p">(</span><span class="n">deprecated_in</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="k">def</span> <span class="nf">create_repository</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>When you deprecate an API, you should not just delete its tests, because
then we might introduce bugs in them.  If the API is still present at all,
it should still work.  The basic approach is to use
<code class="docutils literal notranslate"><span class="pre">TestCase.applyDeprecated</span></code> which in one step checks that the API gives
the expected deprecation message, and also returns the real result from
the method, so that tests can keep running.</p>
<p>Deprecation warnings will be suppressed for final releases, but not for
development versions or release candidates, or when running <code class="docutils literal notranslate"><span class="pre">bzr</span>
<span class="pre">selftest</span></code>. This gives developers information about whether their code is
using deprecated functions, but avoids confusing users about things they
can’t fix.</p>
</div>
</div>
<div class="section" id="general-guidelines">
<h3>General Guidelines<a class="headerlink" href="#general-guidelines" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="miscellaneous-topics">
<h2>Miscellaneous Topics<a class="headerlink" href="#miscellaneous-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h3>
<p>Breezy has a few facilities to help debug problems by going into <a class="reference external" href="http://docs.python.org/lib/debugger-commands.html">pdb</a>, the
Python debugger.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">BZR_PDB</span></code> environment variable is set
then brz will go into pdb post-mortem mode when an unhandled exception
occurs.</p>
<p>If you send a SIGQUIT or SIGBREAK signal to brz then it will drop into the
debugger immediately. SIGQUIT can be generated by pressing Ctrl-\ on
Unix.  SIGBREAK is generated with Ctrl-Pause on Windows (some laptops have
this as Fn-Pause).  You can continue execution by typing <code class="docutils literal notranslate"><span class="pre">c</span></code>.  This can
be disabled if necessary by setting the environment variable
<code class="docutils literal notranslate"><span class="pre">BZR_SIGQUIT_PDB=0</span></code>.</p>
<p>All tests inheriting from bzrlib.tests.TestCase can use <code class="docutils literal notranslate"><span class="pre">self.debug()</span></code>
instead of the longer <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pdb;</span> <span class="pre">pdb.set_trace()</span></code>. The former also works
when <code class="docutils literal notranslate"><span class="pre">stdin/stdout</span></code> are redirected (by using the original <code class="docutils literal notranslate"><span class="pre">stdin/stdout</span></code>
file handles at the start of the <code class="docutils literal notranslate"><span class="pre">bzr</span></code> script) while the later doesn’t.
<code class="docutils literal notranslate"><span class="pre">bzrlib.debug.set_trace()</span></code> also uses the original <code class="docutils literal notranslate"><span class="pre">stdin/stdout</span></code> file
handles.</p>
</div>
<div class="section" id="debug-flags">
<h3>Debug Flags<a class="headerlink" href="#debug-flags" title="Permalink to this headline">¶</a></h3>
<p>Breezy accepts some global options starting with <code class="docutils literal notranslate"><span class="pre">-D</span></code> such as
<code class="docutils literal notranslate"><span class="pre">-Dhpss</span></code>.  These set a value in <cite>bzrlib.debug.debug_flags</cite>, and
typically cause more information to be written to the trace file.  Most
<cite>mutter</cite> calls should be guarded by a check of those flags so that we
don’t write out too much information if it’s not needed.</p>
<p>Debug flags may have effects other than just emitting trace messages.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">help</span> <span class="pre">global-options</span></code> to see them all.</p>
<p>These flags may also be set as a comma-separated list in the
<code class="docutils literal notranslate"><span class="pre">debug_flags</span></code> option in e.g.  <code class="docutils literal notranslate"><span class="pre">~/.config/breezy/breezy.conf</span></code>.  (Note
that it must be in this global file, not in the branch or location
configuration, because it’s currently only loaded at startup time.)  For
instance you may want to always record hpss traces and to see full error
tracebacks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">debug_flags</span> <span class="o">=</span> <span class="n">hpss</span><span class="p">,</span> <span class="n">error</span>
</pre></div>
</div>
</div>
<div class="section" id="jargon">
<h3>Jargon<a class="headerlink" href="#jargon" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>revno</dt><dd><p>Integer identifier for a revision on the main line of a branch.
Revision 0 is always the null revision; others are 1-based
indexes into the branch’s revision history.</p>
</dd>
</dl>
</div>
<div class="section" id="unicode-and-encoding-support">
<h3>Unicode and Encoding Support<a class="headerlink" href="#unicode-and-encoding-support" title="Permalink to this headline">¶</a></h3>
<p>This section discusses various techniques that Breezy uses to handle
characters that are outside the ASCII set.</p>
<div class="section" id="command-outf">
<h4><code class="docutils literal notranslate"><span class="pre">Command.outf</span></code><a class="headerlink" href="#command-outf" title="Permalink to this headline">¶</a></h4>
<p>When a <code class="docutils literal notranslate"><span class="pre">Command</span></code> object is created, it is given a member variable
accessible by <code class="docutils literal notranslate"><span class="pre">self.outf</span></code>.  This is a file-like object, which is bound to
<code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code>, and should be used to write information to the screen,
rather than directly writing to <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> or calling <code class="docutils literal notranslate"><span class="pre">print</span></code>.
This file has the ability to translate Unicode objects into the correct
representation, based on the console encoding.  Also, the class attribute
<code class="docutils literal notranslate"><span class="pre">encoding_type</span></code> will effect how unprintable characters will be
handled.  This parameter can take one of 3 values:</p>
<blockquote>
<div><dl class="simple">
<dt>replace</dt><dd><p>Unprintable characters will be represented with a suitable replacement
marker (typically ‘?’), and no exception will be raised. This is for
any command which generates text for the user to review, rather than
for automated processing.
For example: <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">log</span></code> should not fail if one of the entries has text
that cannot be displayed.</p>
</dd>
<dt>strict</dt><dd><p>Attempting to print an unprintable character will cause a UnicodeError.
This is for commands that are intended more as scripting support, rather
than plain user review.
For example: <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">ls</span></code> is designed to be used with shell scripting. One
use would be <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">ls</span> <span class="pre">--null</span> <span class="pre">--unknowns</span> <span class="pre">|</span> <span class="pre">xargs</span> <span class="pre">-0</span> <span class="pre">rm</span></code>.  If <code class="docutils literal notranslate"><span class="pre">bzr</span></code>
printed a filename with a ‘?’, the wrong file could be deleted. (At the
very least, the correct file would not be deleted). An error is used to
indicate that the requested action could not be performed.</p>
</dd>
<dt>exact</dt><dd><p>Do not attempt to automatically convert Unicode strings. This is used
for commands that must handle conversion themselves.
For example: <code class="docutils literal notranslate"><span class="pre">brz</span> <span class="pre">diff</span></code> needs to translate Unicode paths, but should
not change the exact text of the contents of the files.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="bzrlib-urlutils-unescape-for-display">
<h4><code class="docutils literal notranslate"><span class="pre">bzrlib.urlutils.unescape_for_display</span></code><a class="headerlink" href="#bzrlib-urlutils-unescape-for-display" title="Permalink to this headline">¶</a></h4>
<p>Because Transports work in URLs (as defined earlier), printing the raw URL
to the user is usually less than optimal. Characters outside the standard
set are printed as escapes, rather than the real character, and local
paths would be printed as <code class="docutils literal notranslate"><span class="pre">file://</span></code> URLs. The function
<code class="docutils literal notranslate"><span class="pre">unescape_for_display</span></code> attempts to unescape a URL, such that anything
that cannot be printed in the current encoding stays an escaped URL, but
valid characters are generated where possible.</p>
</div>
</div>
<div class="section" id="c-extension-modules">
<h3>C Extension Modules<a class="headerlink" href="#c-extension-modules" title="Permalink to this headline">¶</a></h3>
<p>We write some extensions in C using Cython. We design these to work in
three scenarios:</p>
<blockquote>
<div><ul class="simple">
<li><p>User with no C compiler</p></li>
<li><p>User with C compiler</p></li>
<li><p>Developers</p></li>
</ul>
</div></blockquote>
<p>The recommended way to install Breezy is to have a C compiler so that the
extensions can be built, but if no C compiler is present, the pure python
versions we supply will work, though more slowly.</p>
<p>For developers we recommend that Cython be installed, so that the C
extensions can be changed if needed.</p>
<p>For the C extensions, the extension module should always match the
original python one in all respects (modulo speed). This should be
maintained over time.</p>
<p>To create an extension, add rules to setup.py for building it with Cython ,
and with distutils. Now start with an empty .pyx file. At the top add
“include ‘yourmodule.py’”. This will import the contents of foo.py into this
file at build time - remember that only one module will be loaded at
runtime. Now you can subclass classes, or replace functions, and only your
changes need to be present in the .pyx file.</p>
</div>
<div class="section" id="making-installers-for-os-windows">
<h3>Making Installers for OS Windows<a class="headerlink" href="#making-installers-for-os-windows" title="Permalink to this headline">¶</a></h3>
<p>To build a win32 installer, see the instructions on the wiki page:
<a class="reference external" href="http://wiki.bazaar.canonical.com/BzrWin32Installer">http://wiki.bazaar.canonical.com/BzrWin32Installer</a></p>
</div>
</div>
<div class="section" id="core-developer-tasks">
<h2>Core Developer Tasks<a class="headerlink" href="#core-developer-tasks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-a-core-developer">
<h4>What is a Core Developer?<a class="headerlink" href="#what-is-a-core-developer" title="Permalink to this headline">¶</a></h4>
<p>While everyone in the Breezy community is welcome and encouraged to
propose and submit changes, a smaller team is reponsible for pulling those
changes together into a cohesive whole. In addition to the general developer
stuff covered above, “core” developers have responsibility for:</p>
<ul class="simple">
<li><p>reviewing changes</p></li>
<li><p>planning releases</p></li>
<li><p>managing releases (see <a class="reference external" href="https://www.breezy-vcs.org/developers/releasing.html">Releasing Breezy</a>)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Removing barriers to community participation is a key reason for adopting
distributed VCS technology. While DVCS removes many technical barriers,
a small number of social barriers are often necessary instead.
By documenting how the above things are done, we hope to
encourage more people to participate in these activities, keeping the
differences between core and non-core contributors to a minimum.</p>
</div>
</div>
<div class="section" id="communicating-and-coordinating">
<h4>Communicating and Coordinating<a class="headerlink" href="#communicating-and-coordinating" title="Permalink to this headline">¶</a></h4>
<p>While it has many advantages, one of the challenges of distributed
development is keeping everyone else aware of what you’re working on.
There are numerous ways to do this:</p>
<ol class="arabic simple">
<li><p>Assign bugs to yourself in Launchpad</p></li>
<li><p>Mention it on the mailing list</p></li>
<li><p>Mention it on IRC</p></li>
</ol>
<p>As well as the email notifcations that occur when merge requests are sent
and reviewed, you can keep others informed of where you’re spending your
energy by emailing the <strong>bazaar-commits</strong> list implicitly. To do this,
install and configure the Email plugin. One way to do this is add these
configuration settings to your central configuration file (e.g.
<code class="docutils literal notranslate"><span class="pre">~/.config/breezy/breezy.conf</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">email</span> <span class="o">=</span> <span class="n">Joe</span> <span class="n">Smith</span> <span class="o">&lt;</span><span class="n">joe</span><span class="o">.</span><span class="n">smith</span><span class="nd">@internode</span><span class="o">.</span><span class="n">on</span><span class="o">.</span><span class="n">net</span><span class="o">&gt;</span>
<span class="n">smtp_server</span> <span class="o">=</span> <span class="n">mail</span><span class="o">.</span><span class="n">internode</span><span class="o">.</span><span class="n">on</span><span class="o">.</span><span class="n">net</span><span class="p">:</span><span class="mi">25</span>
</pre></div>
</div>
<p>Then add these lines for the relevant branches in <code class="docutils literal notranslate"><span class="pre">locations.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">post_commit_to</span> <span class="o">=</span> <span class="n">bazaar</span><span class="o">-</span><span class="n">commits</span><span class="nd">@lists</span><span class="o">.</span><span class="n">canonical</span><span class="o">.</span><span class="n">com</span>
<span class="n">post_commit_mailer</span> <span class="o">=</span> <span class="n">smtplib</span>
</pre></div>
</div>
<p>While attending a sprint, RobertCollins’ Dbus plugin is useful for the
same reason. See the documentation within the plugin for information on
how to set it up and configure it.</p>
</div>
</div>
<div class="section" id="planning-releases">
<h3>Planning Releases<a class="headerlink" href="#planning-releases" title="Permalink to this headline">¶</a></h3>
<div class="section" id="bug-triage">
<h4>Bug Triage<a class="headerlink" href="#bug-triage" title="Permalink to this headline">¶</a></h4>
<p>Keeping on top of bugs reported is an important part of ongoing release
planning. Everyone in the community is welcome and encouraged to raise
bugs, confirm bugs raised by others, and nominate a priority. Practically
though, a good percentage of bug triage is often done by the core
developers, partially because of their depth of product knowledge.</p>
<p>With respect to bug triage, core developers are encouraged to play an
active role with particular attention to the following tasks:</p>
<ul class="simple">
<li><p>keeping the number of unconfirmed bugs low</p></li>
<li><p>ensuring the priorities are generally right (everything as critical - or
medium - is meaningless)</p></li>
<li><p>looking out for regressions and turning those around sooner rather than later.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As well as prioritizing bugs and nominating them against a
target milestone, Launchpad lets core developers offer to mentor others in
fixing them.</p>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="contribution-quickstart.html">Contributing to Breezy</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="profiling.html">Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="bug-handling.html">Tracking Bugs in Breezy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Breezy Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Breezy Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-review.html">Reviewing proposed changes to Breezy</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-style.html">Breezy Code Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="documenting-changes.html">Documenting Changes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuring Breezy</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html#breezy-conf">breezy.conf</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html#location-conf">location.conf</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html#branch-conf">branch.conf</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetch.html">Fetching data</a></li>
<li class="toctree-l1"><a class="reference internal" href="transports.html">Developer guide to breezy transports</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui.html">Interacting with the user</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="releasing.html">Releasing Breezy</a></li>
<li class="toctree-l1"><a class="reference internal" href="ppa.html">Managing the Breezy PPA</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec2.html">Breezy Windows EC2 Server</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Breezy Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integrating with Breezy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="principles.html">Breezy Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="specifications.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation-notes.html">Implementation notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous-notes.html">Miscellaneous notes</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="bug-handling.html" title="Tracking Bugs in Breezy"
              >previous</a> |
            <a href="testing.html" title="Breezy Testing Guide"
              >next</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/HACKING.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2011 Canonical Ltd, 2017-2018 Breezy Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>