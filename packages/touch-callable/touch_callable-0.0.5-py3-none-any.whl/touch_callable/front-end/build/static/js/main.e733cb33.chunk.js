(window["webpackJsonprun-callable"]=window["webpackJsonprun-callable"]||[]).push([[0],{217:function(e,t,a){e.exports=a(426)},222:function(e,t,a){},244:function(e,t,a){},426:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(7),o=a.n(r),c=(a(222),a(97)),i=a(38),s=a(39),u=a(41),d=a(40),m=a(42),p=a(157),f=a(63),h=a(61),b=a(66),g=a(429),E=a(437),v=a(436),y=a(64),O=a(8),w=a(438),j=a(440),C=a(443),x=a(442),k=a(435),M=a(215),S=a(439),L=a(434),F=a(431),D=a(444),T=a(13),N=a(432),I=a(433),R=a(65),_=a(99),B=a(49),P=a.n(B),A=a(11),U=a.n(A),Y=a(124),H=a(430),W=a(441);a(243),a(244);function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e}).apply(this,arguments)}function G(e,t){if(null==e)return{};var a,l,n=function(e,t){if(null==e)return{};var a,l,n={},r=Object.keys(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var V=n.a.createElement("title",null,"\u7f16\u7ec4"),z=n.a.createElement("desc",null,"Created with Sketch."),X=n.a.createElement("defs",null,n.a.createElement("path",{d:"M6.48075496,131.95025 L24.9627073,150.431098 C23.6769032,156.417298 23,162.629599 23,169 C23,217.601058 62.398942,257 111,257 C117.370401,257 123.582702,256.323097 129.568902,255.037293 L149.04975,274.519245 C137.316712,278.71484 124.67522,281 111.5,281 C49.9202504,281 1.42108547e-14,231.07975 1.42108547e-14,169.5 C1.42108547e-14,156.32478 2.28516018,143.683288 6.48075496,131.95025 Z M111.5,58 C173.07975,58 223,107.92025 223,169.5 C223,183.225266 220.520053,196.371309 215.983803,208.514485 L196.670284,189.201335 C198.193974,182.714721 199,175.951489 199,169 C199,120.398942 159.601058,81 111,81 C104.048511,81 97.2852792,81.8060255 90.7986652,83.3297162 L72.4855155,65.0161969 C84.628691,60.4799473 97.7747341,58 111.5,58 Z",id:"path-1"}),n.a.createElement("filter",{x:"0.0%",y:"0.0%",width:"100.0%",height:"100.0%",filterUnits:"objectBoundingBox",id:"filter-2"},n.a.createElement("feGaussianBlur",{stdDeviation:0,in:"SourceGraphic"}))),J=n.a.createElement("g",{id:"\\u9875\\u9762-1",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},n.a.createElement("g",{id:"\\u7F16\\u7EC4",transform:"translate(0.270599, -58.000000)"},n.a.createElement("mask",{id:"mask-3",fill:"white"},n.a.createElement("use",{xlinkHref:"#path-1"})),n.a.createElement("use",{id:"\\u5F62\\u72B6\\u7ED3\\u5408",fill:"#000000",filter:"url(#filter-2)",xlinkHref:"#path-1"}),n.a.createElement("text",{id:"t",fontFamily:"STBaoliSC-Regular, Baoli SC",fontSize:201,fontWeight:"normal",fill:"#000000"},n.a.createElement("tspan",{x:71,y:213},"t")))),Z=function(e){var t=e.svgRef,a=e.title,l=G(e,["svgRef","title"]);return n.a.createElement("svg",q({width:"224px",height:"223px",viewBox:"0 0 224 223",ref:t},l),void 0===a?V:n.a.createElement("title",null,a),z,X,J)},$=n.a.forwardRef(function(e,t){return n.a.createElement(Z,q({svgRef:t},e))});a.p;function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e}).apply(this,arguments)}function Q(e,t){if(null==e)return{};var a,l,n=function(e,t){if(null==e)return{};var a,l,n={},r=Object.keys(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var ee=n.a.createElement("title",null,"Touch Callable"),te=n.a.createElement("desc",null,"Created with Sketch."),ae=n.a.createElement("g",{id:"\\u9875\\u9762-1",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",fontFamily:"GoMonoForPowerline, Go Mono for Powerline",fontSize:24,fontWeight:"normal"},n.a.createElement("g",{id:"\\u753B\\u677F",transform:"translate(-640.000000, -73.000000)",fill:"#000000"},n.a.createElement("text",{id:"Touch-Callable"},n.a.createElement("tspan",{x:640,y:92},"Touch Callable")))),le=function(e){var t=e.svgRef,a=e.title,l=Q(e,["svgRef","title"]);return n.a.createElement("svg",K({width:"200px",height:"20px",viewBox:"0 0 200 20",ref:t},l),void 0===a?ee:n.a.createElement("title",null,a),te,ae)},ne=n.a.forwardRef(function(e,t){return n.a.createElement(le,K({svgRef:t},e))});a.p;function re(e){return{type:"updateCallables",callables:e}}function oe(e){return{type:"setLocale",locale:e}}function ce(e){return{type:"changeModuleStatus",hasNew:e}}var ie={callables:[],locale:R.a,hasNewModule:!1};var se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"updateCallables":return Object.assign({},e,{callables:t.callables});case"setLocale":return Object.assign({},e,{locale:t.locale});case"changeModuleStatus":return Object.assign({},e,{hasNewModule:t.hasNew});default:return e}},ue={touch:"Touch",updateCompleted:"Update completed",reloadModule:"Reload module",moduleChanged:"Module changed",parameterList:"Parameter list",noDoc:"No document",callables:"Callables",upload:"Upload",pleaseUploadFile:"Please upload file",executionFailed:"Execution failed",executionSucceed:"Execution succeed",pleaseInput:"Please input {parameterName}"},de={touch:"\u8fd0\u884c",updateCompleted:"\u66f4\u65b0\u6210\u529f",reloadModule:"\u91cd\u52a0\u8f7d\u6a21\u5757",moduleChanged:"\u6a21\u5757\u6709\u66f4\u65b0\uff01",parameterList:"\u53c2\u6570\u5217\u8868",noDoc:"\u6ca1\u6709\u6587\u6863",callables:"\u529f\u80fd\u5217\u8868",upload:"\u4e0a\u4f20",pleaseUploadFile:"\u8bf7\u4e0a\u4f20\u6587\u4ef6",executionFailed:"\u6267\u884c\u5931\u8d25",executionSucceed:"\u6267\u884c\u6210\u529f",pleaseInput:"\u8bf7\u8f93\u5165 {parameterName}"},me=g.a.Header,pe=g.a.Content,fe=g.a.Footer,he=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.setCallables;P.a.get("callable").then(function(t){e(t.data)})}},{key:"render",value:function(){return n.a.createElement(E.a,{itemLayout:"horizontal",dataSource:this.props.callables,renderItem:function(e){return n.a.createElement(E.a.Item,null,n.a.createElement(E.a.Item.Meta,{title:n.a.createElement(p.b,{to:"/callable/".concat(e.callable_name)},e.callable_name),description:e.title}))}})}}]),t}(l.Component),be=function(e){return Object(h.a)({setCallables:re},e)},ge=Object(b.b)(function(e){return{callables:e.callables}},be)(Object(Y.c)(he)),Ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){var t=Object(c.a)(e.fileList);t.length>=1&&a.setState({disabled:!0}),a.setState({fileList:t}),a.props.onChange(t)},a.onRemove=function(e){return a.setState({disabled:!1}),!0},a.state={fileList:[],disabled:!1},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.disabled,t={onChange:this.handleChange,onRemove:this.onRemove};return n.a.createElement(v.a,Object.assign({},t,{beforeUpload:function(e){return!1},fileList:this.state.fileList}),0===this.state.fileList.length?n.a.createElement(y.a,{disabled:e},n.a.createElement(O.a,{type:"upload"})," ",n.a.createElement(H.a,{id:"upload"})):null)}}]),t}(n.a.Component),ve=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){for(var l={},n={},r=0,o=Object.keys(t);r<o.length;r++){var c=o[r],i=t[c];Array.isArray(i)&&0!==i.length&&i[0]instanceof Object&&i[0].originFileObj instanceof File?l[c]=t[c][0].originFileObj:n[c]=t[c]}if(0===Object.keys(l).length)P.a.post("callable/".concat(a.props.match.params.name),t).then(function(e){"success"===e.data.status?a.showSuccessModal(e.data.result):a.showErrorModal(e.data.result)});else{var s=new FormData;s.set("json",JSON.stringify(n));for(var u=0,d=Object.keys(l);u<d.length;u++)c=d[u],s.append(c,l[c]);P()({method:"post",url:"callable/".concat(a.props.match.params.name),data:s,headers:{"Content-Type":"multipart/form-data"}}).then(function(e){"success"===e.data.status?a.showSuccessModal(e.data.result):a.showErrorModal(e.data.result)})}}})},a.setCallable=function(){var e,t=a.props.match.params.name,l=!0,n=!1,r=void 0;try{for(var o,c=a.props.callables[Symbol.iterator]();!(l=(o=c.next()).done);l=!0)if((e=o.value).callable_name===t){a.callable=e;break}}catch(i){n=!0,r=i}finally{try{l||null==c.return||c.return()}finally{if(n)throw r}}},a.normFile=function(e){return Array.isArray(e)?e:e&&e.fileList},a.buildFormItem=function(e,t,l){var r,o=a.props.form.getFieldDecorator,c=e.name;if(["BytesIO","BinaryIO"].includes(e.annotation))return n.a.createElement(w.a.Item,{label:c,key:t},o(c,{valuePropName:"fileList",getValueFromEvent:a.normFile,rules:[{required:e.required,message:n.a.createElement(H.a,{id:"pleaseUploadFile"})}]})(n.a.createElement(Ee,null)));switch(e.annotation){case"str":r=n.a.createElement(j.a,{allowClear:!0});break;case"float":r=n.a.createElement(C.a,{allowClear:!0});break;case"int":r=n.a.createElement(C.a,{parser:function(e){return Math.floor(e)},allowClear:!0});break;case"bool":r=n.a.createElement(x.a.Group,{buttonStyle:"solid"},n.a.createElement(x.a.Button,{value:!0},"True"),n.a.createElement(x.a.Button,{value:!1},"False"));break;case"datetime":r=n.a.createElement(k.a,{showTime:!0});break;case"date":r=n.a.createElement(k.a,null);break;case"time":r=n.a.createElement(M.a,null);break;case"Enum":r=n.a.createElement(x.a.Group,{buttonStyle:"solid"},e.enum_values.map(function(e,t,a){return n.a.createElement(x.a.Button,{value:e,key:t},e)}));break;default:r=n.a.createElement(j.a,null)}return n.a.createElement(w.a.Item,{label:c,key:t},o(c,{initialValue:a.buildDefaultValue(e),rules:[{required:e.required,message:a.props.intl.formatMessage({id:"pleaseInput"},{parameterName:c})}]})(r))},a.buildDefaultValue=function(e){return"time"===e.annotation&&e.default?U()(e.default,"HH:mm:ss"):"date"===e.annotation&&e.default?U()(e.default,'"YYYY-MM-DD"'):"datetime"===e.annotation&&e.default?U()(e.default,'"YYYY-MM-DDTHH:mm:ss"'):e.default};var l=a.props.callables;return a.state={visible:!1,response:null,callables:l},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.setCallables;P.a.get("callable").then(function(t){e(t.data)})}},{key:"showSuccessModal",value:function(e){S.a.success({title:this.props.intl.formatMessage({id:"executionSucceed"}),content:e})}},{key:"showErrorModal",value:function(e){S.a.error({title:this.props.intl.formatMessage({id:"executionFailed"}),content:e})}},{key:"render",value:function(){var e=this;return this.setCallable(),n.a.createElement(L.a,{style:{border:"1px solid rgb(235, 237, 240)"},onBack:function(){return e.props.history.push("/")},title:this.props.intl.formatMessage({id:"callables"})},n.a.createElement(w.a,{layout:"vertical",onSubmit:this.handleSubmit},n.a.createElement(F.a,null,this.callable?this.callable.callable_name:""),n.a.createElement("pre",null,this.callable&&this.callable.doc?this.callable.doc:n.a.createElement(H.a,{id:"noDoc"})),this.callable&&this.callable.parameters.length?n.a.createElement(F.a,null,n.a.createElement(H.a,{id:"parameterList"})):[],this.callable?this.callable.parameters.map(this.buildFormItem):[],n.a.createElement(w.a.Item,{wrapperCol:{span:24}},n.a.createElement(y.a,{type:"primary",htmlType:"submit",block:!0},n.a.createElement(H.a,{id:"touch"})))))}}]),t}(n.a.Component),ye=w.a.create({name:"callablForm"})(Object(Y.c)(ve)),Oe=Object(b.b)(function(e){return{callables:e.callables}},be)(ye),we=function(e){function t(){var e,a;Object(i.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).getLocaleText=function(e){return e===R.a?"English":e===_.a?"\u4e2d\u6587":void 0},a.state={localeText:a.getLocaleText(a.props.locale)},a.onChangeLocale=function(e){var t=a.props,l=t.setLocale,n=t.locale,r=null;n===R.a?r=_.a:n===_.a&&(r=R.a),P.a.post("locale",{locale:r.locale}),l(r),a.setState({localeText:a.getLocaleText(r)}),r===R.a?U.a.locale("en"):U.a.locale("zh-cn")},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.setLocale,a=e.locale;P.a.get("locale").then(function(e){e.data.locale!==a.locale&&("en"===e.data.locale?t(R.a):t(_.a))})}},{key:"render",value:function(){return n.a.createElement(y.a,{onClick:this.onChangeLocale},this.state.localeText)}}]),t}(l.Component),je=function(e){return{locale:e.locale}},Ce=Object(b.b)(je,function(e){return Object(h.a)({setLocale:oe},e)})(we),xe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={loading:!1},a.reloadModule=function(e){var t=a.props.updateCallables;a.setState({loading:!0}),P.a.post("reload-module"),P.a.get("callable").then(function(e){t(e.data)}),a.setState({loading:!1}),window.location.reload(!0),D.a.success(a.props.intl.formatMessage({id:"updateCompleted"}),1)},a.queryNewModule=function(){var e=a.props,t=e.hasNewModule,l=e.changeModuleStatus;P.a.get("module-status").then(function(e){e.data.has_new!==t&&(e.data.has_new&&D.a.info(a.props.intl.formatMessage({id:"moduleChanged"}),1),l(e.data.has_new))})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"tick",value:function(){this.setState(function(e){return{secondsElapsed:e.secondsElapsed+1}})}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return e.queryNewModule()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return n.a.createElement(y.a,{disabled:!this.props.hasNewModule,loading:this.state.loading,style:{display:"inline-block",marginRight:"20px"},onClick:this.reloadModule},n.a.createElement(H.a,{id:"reloadModule"}))}}]),t}(l.Component),ke=Object(b.b)(function(e){return{hasNewModule:e.hasNewModule}},function(e){return Object(h.a)({changeModuleStatus:ce,updateCallables:re},e)})(Object(Y.c)(xe)),Me=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Touch-Callable"}},{key:"render",value:function(){var e=this.props.locale;return n.a.createElement(T.a,{locale:e},n.a.createElement(W.a,{key:e,locale:e.locale,messages:"en"===e.locale?ue:de},n.a.createElement(g.a,{className:"layout",key:e?e.locale:"en"},n.a.createElement(me,{style:{background:"white",boxShadow:"0px 1px 5px #d0cdcd",height:"unset"}},n.a.createElement(N.a,{type:"flex",justify:"center",align:"middle"},n.a.createElement(I.a,{md:8,xs:24},n.a.createElement($,{style:{verticalAlign:"middle",marginRight:"20px",width:"48px",height:"48px"}}),n.a.createElement(ne,{style:{verticalAlign:"middle",width:"150px"}})),n.a.createElement(I.a,{md:8,xs:24}),n.a.createElement(I.a,{md:8,xs:24,style:{textAlign:"right"}},n.a.createElement(ke,{style:{marginRight:"20px"}}),n.a.createElement(Ce,null)))),n.a.createElement(pe,{style:{margin:"10px 10px"}},n.a.createElement(N.a,{span:24},n.a.createElement(I.a,{md:6,xs:24}),n.a.createElement(I.a,{md:12,xs:24},n.a.createElement(p.a,null,n.a.createElement(f.c,null,n.a.createElement(f.a,{exact:!0,path:"/",component:ge}),n.a.createElement(f.a,{path:"/callable/:name",component:Oe})))),n.a.createElement(I.a,{md:6,xs:24}))),n.a.createElement(fe,{style:{textAlign:"center"}},"Touch Callable"))))}}]),t}(l.Component),Se=Object(b.b)(je)(Me);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Le=Object(h.b)(se,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({trace:!0,traceLimit:25}));o.a.render(n.a.createElement(b.a,{store:Le},n.a.createElement(Se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[217,1,2]]]);
//# sourceMappingURL=main.e733cb33.chunk.js.map